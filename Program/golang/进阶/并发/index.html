<!-- build time:Thu Jan 18 2024 13:22:56 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="ä½™æ˜Ÿé…’" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="ä½™æ˜Ÿé…’" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="ä½™æ˜Ÿé…’" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Golang,Golangå…¥é—¨è¿›é˜¶"><link rel="canonical" href="http://example.com/Program/golang/%E8%BF%9B%E9%98%B6/%E5%B9%B6%E5%8F%91/"><title>å¹¶å‘ - è¿›é˜¶ - Golang - ç¼–ç¨‹ | ä½™æ˜Ÿé…’ = ä½™æ˜Ÿé…’ = ç—´çœ‹å¹´å°‘é£é›¨ç–¾ï¼Œä¸€è½¬æœ¬ç”Ÿè¹‰è·æ¸¸</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">å¹¶å‘</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2023-01-23 08:56:49"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2023-01-23T08:56:49+08:00">2023-01-23</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ä½™æ˜Ÿé…’</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclhfehz7j20zk0m8u0x.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclh3brzpj20zk0m8ann.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giciundwu5j20zk0m8n9e.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipexoj0moj20zk0m8kgu.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipetv6p75j20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicitht3xtj20zk0m8k5v.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Program/" itemprop="item" rel="index" title="åˆ†ç±»äº ç¼–ç¨‹"><span itemprop="name">ç¼–ç¨‹</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Program/Golang/" itemprop="item" rel="index" title="åˆ†ç±»äº Golang"><span itemprop="name">Golang</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Program/Golang/%E8%BF%9B%E9%98%B6/" itemprop="item" rel="index" title="åˆ†ç±»äº è¿›é˜¶"><span itemprop="name">è¿›é˜¶</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/Program/golang/%E8%BF%9B%E9%98%B6/%E5%B9%B6%E5%8F%91/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="ä½™æ˜Ÿé…’"><meta itemprop="description" content="ç—´çœ‹å¹´å°‘é£é›¨ç–¾ï¼Œä¸€è½¬æœ¬ç”Ÿè¹‰è·æ¸¸, æ¬¢è¿å‚è§‚æˆ‘çš„ç¬”è®°ç©ºé—´ ~ è¿™é‡Œä¸»è¦ä¼šè®°å½•ä¸€äº›å®‰å…¨ç›¸å…³çš„å­¦ä¹ ç¬”è®° ğŸŒ¸"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ä½™æ˜Ÿé…’"></span><div class="body md" itemprop="articleBody"><h1 id="å¹¶å‘åŸºç¡€"><a href="#å¹¶å‘åŸºç¡€" class="headerlink" title="å¹¶å‘åŸºç¡€"></a>å¹¶å‘åŸºç¡€</h1><p>å¹¶å‘å˜æˆå¼€å‘å°†ä¸€ä¸ªè¿‡ç¨‹æŒ‰ç…§å¹¶è¡Œç®—æ³•æ‹†åˆ†æˆå¤šä¸ªå¯ç‹¬ç«‹æ‰§è¡Œä»£ç å—</p><h2 id="é¡ºåºã€å¹¶å‘ä¸å¹¶è¡Œ"><a href="#é¡ºåºã€å¹¶å‘ä¸å¹¶è¡Œ" class="headerlink" title="é¡ºåºã€å¹¶å‘ä¸å¹¶è¡Œ"></a>é¡ºåºã€å¹¶å‘ä¸å¹¶è¡Œ</h2><ol><li>é¡ºåºæ˜¯æŒ‡å‘èµ·æ‰§è¡Œçš„ç¨‹åºåªèƒ½æœ‰ä¸€ä¸ª</li><li>å¹¶å‘æ˜¯æŒ‡åŒæ—¶å‘èµ·æ‰§è¡Œï¼ˆåŒæ—¶å¤„ç†ï¼‰çš„ç¨‹åºå¯ä»¥æœ‰å¤šä¸ª</li><li>å¹¶è¡Œæ˜¯æŒ‡åŒæ—¶æ‰§è¡Œï¼ˆåŒæ—¶åšï¼‰çš„ç¨‹åºå¯ä»¥æœ‰å¤šä¸ª</li></ol><h1 id="ä¾‹ç¨‹"><a href="#ä¾‹ç¨‹" class="headerlink" title="ä¾‹ç¨‹"></a>ä¾‹ç¨‹</h1><p>åœ¨Goè¯­è¨€ä¸­æ¯ä¸ªå¹¶å‘æ‰§è¡Œçš„å•å…ƒå«Goroutineï¼Œä½¿ç”¨<code>go</code>å…³é”®å­—åæ¥å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªGoroutine</p><h2 id="ä¾‹ç¨‹çš„åˆ›å»º"><a href="#ä¾‹ç¨‹çš„åˆ›å»º" class="headerlink" title="ä¾‹ç¨‹çš„åˆ›å»º"></a>ä¾‹ç¨‹çš„åˆ›å»º</h2><pre><code class="go">package main


func PrintString(str string) &#123;
    for i := 1; i &lt; 10; i++ &#123;
        fmt.Printf(&quot;%s =&gt; %d\n&quot;, str, i)
    &#125;
&#125;

func main() &#123;

    go demo6.PrintString(&quot;goroutine&quot;)

    demo6.PrintString(&quot;main&quot;)

&#125;

/*
main =&gt; 1
main =&gt; 2
main =&gt; 3
main =&gt; 4
main =&gt; 5
main =&gt; 6
main =&gt; 7
main =&gt; 8
main =&gt; 9
goroutine =&gt; 1
*/
</code></pre><blockquote><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸Šè¿°æƒ…å†µï¼Œè¿™æ˜¯å› ä¸º<code>main</code>ä¸­æ˜¯ä¸»ä¾‹ç¨‹ï¼Œå½“ä¸»ä¾‹ç¨‹æ‰§è¡Œå®Œæˆåï¼Œå…¶ä»–ä¾‹ç¨‹ä¹Ÿä¼šè‡ªåŠ¨ç»“æŸï¼Œä¸ç®¡æ˜¯å¦æ­£åœ¨æ‰§è¡Œ</p></blockquote><h3 id="é—­åŒ…é™·é˜±"><a href="#é—­åŒ…é™·é˜±" class="headerlink" title="é—­åŒ…é™·é˜±"></a>é—­åŒ…é™·é˜±</h3><p>å› ä¸ºé—­åŒ…ä½¿ç”¨å‡½æ•°å¤–å˜é‡ï¼Œå½“ä¾‹ç¨‹æ‰§è¡Œæ—¶ï¼Œå¤–éƒ¨å˜é‡å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´æ‰“å°çš„å†…å®¹ä¸æ­£ç¡®ï¼Œå¯ä½¿ç”¨åœ¨åˆ›å»ºä¾‹ç¨‹æ—¶é€šè¿‡å‡½æ•°ä¼ é€’å‚æ•°ï¼ˆå€¼æ‹·è´ï¼‰æ–¹å¼é¿å…</p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    
    for i := 0; i &lt; 10; i++ &#123;
        go func() &#123;
            fmt.Println(i)
        &#125;()
    &#125;

    time.Sleep(time.Second)

&#125;

/*
10
10
10
10
10
6
10
10
8
10
*/
</code></pre><blockquote><p>ä¸ºä»€ä¹ˆä¼šæ‰“å°å‡º10ï¼Œè¿™æ˜¯å› ä¸ºä¾‹ç¨‹è¿˜æ²¡æœ‰å¯åŠ¨æ—¶ï¼Œæœ¬è¯¥æ‰“å°1ï¼Œç»“æœå› ä¸ºå¾ªç¯å˜é‡å˜ä¸º2ï¼Œå½“å˜é‡ä¸º10é€€å‡ºå¾ªç¯æ—¶ï¼Œä¾‹ç¨‹æ°å¥½å¯åŠ¨ï¼Œè¾“å‡º10</p></blockquote><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;

    for i := 0; i &lt; 10; i++ &#123;
        go func(j int) &#123;
            fmt.Println(j)
        &#125;(i)
    &#125;

    time.Sleep(time.Second)

&#125;

/*
6
9
7
8
0
2
4
5
1
3
*/
</code></pre><h2 id="ç­‰å¾…ä¾‹ç¨‹"><a href="#ç­‰å¾…ä¾‹ç¨‹" class="headerlink" title="ç­‰å¾…ä¾‹ç¨‹"></a>ç­‰å¾…ä¾‹ç¨‹</h2><p>mainå‡½æ•°ä¹Ÿæ˜¯ç”±ä¸€ä¸ªä¾‹ç¨‹å¯åŠ¨æ‰§è¡Œï¼Œè¿™ä¸ªä¾‹ç¨‹ç§°ä¸ºä¸»ä¾‹ç¨‹ï¼Œå…¶ä»–çš„ä¾‹ç¨‹ç§°ä¸ºå·¥ä½œä¾‹ç¨‹ï¼Œä¸»ä¾‹ç¨‹ç»“æŸåå·¥ä½œä¾‹ç¨‹ä¹Ÿä¼šéšä¹‹é”€æ¯ï¼Œä½¿ç”¨sync.WaitGroupæ¥ç»´æŠ¤æ‰§è¡Œä¾‹ç¨‹æ‰§è¡ŒçŠ¶æ€</p><h3 id="WaitGroup"><a href="#WaitGroup" class="headerlink" title="WaitGroup"></a>WaitGroup</h3><blockquote><p>WaitGroupå®ç°åŒæ­¥</p><p>var wg sync.WaitGroup</p></blockquote><pre><code class="go">Add(n) // æ·»åŠ nä¿¡å·

Done() // å¤„ç†å®Œæˆä¸€ä¸ªä¿¡å·

Wait() // ç­‰å¾…è®¡æ•°å™¨å½’é›¶ï¼Œå½“æ‰€æœ‰ä¿¡å·å®Œæˆå¤„ç†å°±ç»“æŸ
</code></pre><p>æŸ¥çœ‹æ·»åŠ WaitGroupå’Œä¸æ·»åŠ WaitGroupçš„åŒºåˆ«</p><p><strong>æ²¡æœ‰ä½¿ç”¨WaitGroup</strong></p><pre><code class="go">package main

import &quot;fmt&quot;

func send(i int) &#123;
    fmt.Printf(&quot;i : %d\n&quot;, i)
&#125;

func main() &#123;
    for i := 0; i &lt; 10; i++ &#123;
        go send(i)
    &#125;

    fmt.Println(&quot;end~~~&quot;)
&#125;
</code></pre><pre><code class="go">i : 0
i : 1
end~~~
</code></pre><pre><code class="go">i : 4
end~~~
</code></pre><p><strong>ä½¿ç”¨WaitGroup</strong></p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync&quot;
)

var wp sync.WaitGroup

func send(i int) &#123;
    defer wp.Done() // å®Œæˆä»»åŠ¡å°±-1
    fmt.Println(&quot;Send : &quot;, i)
&#125;

func main() &#123;
    for i := 0; i &lt; 10; i++ &#123;
        go send(i)
        wp.Add(1) // å¼€å¯ä¸€ä¸ªä»»åŠ¡å°±+1
    &#125;
    wp.Wait() // ç­‰å¾…æ‰€æœ‰åæˆ
    fmt.Println(&quot;end~~~&quot;)
&#125;
</code></pre><pre><code class="go">Send :  1
Send :  9
Send :  7
Send :  3
Send :  8
Send :  0
Send :  2
Send :  4
Send :  5
Send :  6
end~~~
</code></pre><h3 id="ç®¡é“å®ç°ç­‰å¾…"><a href="#ç®¡é“å®ç°ç­‰å¾…" class="headerlink" title="ç®¡é“å®ç°ç­‰å¾…"></a>ç®¡é“å®ç°ç­‰å¾…</h3><blockquote><p>ç®¡é“å¦‚æœèƒ½è¯»å–åˆ°æ•°æ®ï¼Œè¯´æ˜ä¾‹ç¨‹å·²ç»æ‰§è¡Œå®Œæˆ</p></blockquote><pre><code class="go">package main

import &quot;fmt&quot;


func main() &#123;

    channel := make(chan int)

    for i := 0; i &lt; 2; i++ &#123;
        go func(index int) &#123;
            for i := 0; i &lt; 4; i++ &#123;
                fmt.Printf(&quot;%dæ¬¡ =&gt; %d\n&quot;, index, i)
            &#125;
            channel &lt;- 0
        &#125;(i)
    &#125;

    for i := 0; i &lt; 2; i++ &#123;
        &lt;-channel
    &#125;

&#125;
/*
1æ¬¡ =&gt; 0
1æ¬¡ =&gt; 1
1æ¬¡ =&gt; 2
1æ¬¡ =&gt; 3
0æ¬¡ =&gt; 0
0æ¬¡ =&gt; 1
0æ¬¡ =&gt; 2
0æ¬¡ =&gt; 3
*/
</code></pre><p>è¿™é‡Œåˆ›å»ºäº†3ä¸ªä¾‹ç¨‹ï¼Œå…¶ä¸­æ¯ä¸ªä¾‹ç¨‹éƒ½æ´»é€šè¿‡ç®¡é“ä¼ é€’æ•°æ®ï¼Œæ­¤æ—¶åœ¨åˆ›å»º3ä¸ªç®¡é“è¯»å–ï¼Œå³å¯å®ç°ç­‰å¾…ä¾‹ç¨‹æ‰§è¡Œå®Œçš„æ•ˆæœ</p><h2 id="ä¾‹ç¨‹é—´é€šä¿¡"><a href="#ä¾‹ç¨‹é—´é€šä¿¡" class="headerlink" title="ä¾‹ç¨‹é—´é€šä¿¡"></a>ä¾‹ç¨‹é—´é€šä¿¡</h2><p>åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯å…±äº«æ•°æ®ã€åŒæ­¥ã€‘ï¼ˆäº’æ–¥é”ã€åŸå­æ“ä½œï¼‰ï¼Œä¸€ç§æ˜¯é€šé“ã€å¼‚æ­¥ã€‘ï¼ˆchannelï¼‰</p><h3 id="Mutextäº’æ–¥é”å®ç°åŒæ­¥"><a href="#Mutextäº’æ–¥é”å®ç°åŒæ­¥" class="headerlink" title="Mutextäº’æ–¥é”å®ç°åŒæ­¥"></a>Mutextäº’æ–¥é”å®ç°åŒæ­¥</h3><blockquote><p>var lock sync.Mutex</p><p>å¯ä»¥ä½¿ç”¨Mutextäº’æ–¥é”çš„æ–¹å¼å®ç°åŒæ­¥</p></blockquote><p><strong>æ¡ˆä¾‹</strong> : å¤šä¸ªåç¨‹å»è®¿é—®å…±äº«èµ„æº</p><ol><li>ä½¿ç”¨sync.WaitGroup</li></ol><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync&quot;
    &quot;time&quot;
)

var i int = 100
var wg sync.WaitGroup

func add() &#123;
    wg.Done()
    i += 1
    fmt.Println(&quot;i++ : &quot;, i)
    time.Sleep(time.Millisecond * 10)
&#125;
func sub() &#123;
    wg.Done()
    i -= 1
    fmt.Println(&quot;i-- : &quot;, i)
    time.Sleep(time.Millisecond * 20)
&#125;
func main() &#123;
    for i := 0; i &lt; 100; i++ &#123;
        wg.Add(1)
        go add()
        wg.Add(1)
        go sub()
    &#125;
    wg.Wait()
    fmt.Println(&quot;i : &quot;, i)
&#125;
</code></pre><pre><code>i-- :  99
i++ :  101
i-- :  100
i++ :  101
i-- :  100
i :  101 // æœ€ç»ˆç»“æœå¯èƒ½ä¼šå‘ç”Ÿå¼‚å¸¸
</code></pre><ol start="2"><li>ä½¿ç”¨sync.WaitGroup + sync.Mutex</li></ol><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync&quot;
    &quot;time&quot;
)

var i int = 100
var wg sync.WaitGroup
var lock sync.Mutex

func add() &#123;
    lock.Lock()
    wg.Done()
    i += 1
    fmt.Println(&quot;i++ : &quot;, i)
    time.Sleep(time.Millisecond * 10)
    lock.Unlock()
&#125;
func sub() &#123;
    lock.Lock()
    wg.Done()
    i -= 1
    fmt.Println(&quot;i-- : &quot;, i)
    time.Sleep(time.Millisecond * 20)
    lock.Unlock()
&#125;
func main() &#123;
    for i := 0; i &lt; 100; i++ &#123;
        wg.Add(1)
        go add()
        wg.Add(1)
        go sub()
    &#125;
    wg.Wait()
    fmt.Println(&quot;i : &quot;, i)
&#125;
</code></pre><pre><code>i-- :  100
i++ :  101
i-- :  100
i++ :  101
i-- :  100
i :  100
</code></pre><p>å¦‚æœåœ¨åŠ é”å’Œè§£é”ä¸­é—´çš„ä»£ç å‘ç”Ÿäº†é”™è¯¯ï¼Œå¯¼è‡´æ— æ³•åŠæ—¶è§£é”ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨<code>defer</code>ï¼Œè¿˜æ˜¯ä¸è¡Œï¼Œå› ä¸ºdeferæ‰§è¡Œçš„åŸåˆ™æ˜¯å‡½æ•°ç»“æŸåæ‰ä¼šè°ƒç”¨deferï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨åŒ¿åå‡½æ•°</p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync&quot;
    &quot;time&quot;
)

var i int = 100
var wg sync.WaitGroup
var lock sync.Mutex

func add() &#123;

    func() &#123;
        lock.Lock()
        i += 1
        fmt.Println(&quot;i++ : &quot;, i)
        time.Sleep(time.Millisecond * 10)
        wg.Done()
        defer lock.Unlock() // è¿™æ ·å°±å¯ä»¥åœ¨å‡½æ•°æ‰§è¡Œå®Œæˆåï¼Œè‡ªåŠ¨è°ƒç”¨defer
    &#125;()

&#125;
func sub() &#123;
    func() &#123;
        lock.Lock()
        i -= 1
        fmt.Println(&quot;i-- : &quot;, i)
        time.Sleep(time.Millisecond * 10)
        wg.Done()
        defer lock.Unlock()
    &#125;()
&#125;

func main() &#123;
    wg.Add(200)
    for i := 0; i &lt; 100; i++ &#123;
        go add()
        go sub()
    &#125;
    wg.Wait()
    fmt.Println(&quot;i : &quot;, i)
&#125;
</code></pre><h3 id="åŸå­æ“ä½œ"><a href="#åŸå­æ“ä½œ" class="headerlink" title="åŸå­æ“ä½œ"></a>åŸå­æ“ä½œ</h3><p>åŸºæœ¬çš„åŸå­æ“ä½œ</p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync/atomic&quot;
    &quot;time&quot;
)

var num int32 = 100

func add() &#123;
    atomic.AddInt32(&amp;num, 1)
&#125;
func sub() &#123;
    atomic.AddInt32(&amp;num, -2)
&#125;

func main() &#123;
    for i := 0; i &lt; 100; i++ &#123;
        go add()
        go sub()
    &#125;
    time.Sleep(time.Second)
    fmt.Println(num)
&#125;
</code></pre><p>atomicæä¾›çš„åŸå­æ“ä½œèƒ½å¤Ÿç¡®ä¿ä»»ä¸€æ—¶åˆ»åªæœ‰goroutineå¯¹å˜é‡è¿›è¡Œæ“ä½œï¼Œå–„ç”¨atomicèƒ½å¤Ÿé¿å…ç¨‹åºä¸­å‡ºç°å¤§é‡çš„é”æ“ä½œ</p><p>atomicå¸¸è§æ“ä½œæœ‰</p><ol><li>å¢å‡</li><li>è½½å…¥</li><li>æ¯”è¾ƒå¹¶äº¤æ¢ cas</li><li>äº¤æ¢</li><li>å­˜å‚¨</li></ol><h4 id="å¢å‡æ“ä½œ"><a href="#å¢å‡æ“ä½œ" class="headerlink" title="å¢å‡æ“ä½œ"></a>å¢å‡æ“ä½œ</h4><p>atomicåŒ…ä¸­æä¾›äº†å¦‚ä¸‹ä»¥Addä¸ºå‰ç¼€çš„å¢å‡æ“ä½œ</p><blockquote><p>AddInt32()</p><p>AddInt64()</p><p>AddUint32()</p><p>AddUint64()</p><p>AddUintptr()</p></blockquote><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync/atomic&quot;
)

var num int32 = 100

func add() &#123;
    atomic.AddInt32(&amp;num, 1)
    fmt.Println(&quot;num++ : &quot;, num)
&#125;
func sub() &#123;
    atomic.AddInt32(&amp;num, -1)
    fmt.Println(&quot;num-- : &quot;, num)
&#125;

func main() &#123;
    add()
    fmt.Println(&quot;num : &quot;, num)
    sub()
    fmt.Println(&quot;num : &quot;, num)
&#125;

/*
num++ :  101
num :  101
num-- :  100
num :  100
*/
</code></pre><h4 id="è½½å…¥æ“ä½œ"><a href="#è½½å…¥æ“ä½œ" class="headerlink" title="è½½å…¥æ“ä½œ"></a>è½½å…¥æ“ä½œ</h4><blockquote><p>atomic.LoadInt32()</p><p>atomic.LoadInt64()</p><p>atomic.LoadUint32()</p><p>atomic.LoadUint64()</p><p>atomic.LoadPointer()</p><p>atomic.LoadUpointer()</p></blockquote><blockquote><p>atomic.StoreInt32()</p><p>atomic.StoreInt64()</p><p>atomic.StoreUint32()</p><p>atomic.StoreUint64()</p><p>atomic.StorePointer()</p><p>atomic.storeUintptr()</p></blockquote><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync/atomic&quot;
)

var atomicLSNum int32 = 100

func main() &#123;
    atomic.LoadInt32(&amp;atomicLSNum)
    fmt.Println(&quot;atomicLSNum : &quot;, atomicLSNum)
    atomic.StoreInt32(&amp;atomicLSNum, 250)
    fmt.Println(&quot;atomicLSNum : &quot;, atomicLSNum)
&#125;

/*
atomicLSNum :  100
atomicLSNum :  250
*/
</code></pre><h4 id="æ¯”è¾ƒå¹¶äº¤æ¢-cas"><a href="#æ¯”è¾ƒå¹¶äº¤æ¢-cas" class="headerlink" title="æ¯”è¾ƒå¹¶äº¤æ¢ cas"></a>æ¯”è¾ƒå¹¶äº¤æ¢ cas</h4><p>è¯¥æ“ä½œåœ¨è¿›è¡Œäº¤æ¢å‰é¦–å…ˆç¡®ä¿å˜é‡çš„å€¼æœªè¢«æ›´æ”¹ï¼Œå³ä»ç„¶ä¿æŒå‚æ•°oldæ‰€è®°å½•çš„å€¼ï¼Œæ»¡è¶³æ­¤å‰æä¸‹æ‰è¿›è¡Œäº¤æ¢æ“ä½œï¼ŒCASçš„åšæ³•ç±»ä¼¼æ“ä½œæ•°æ®åº“æ—¶å¸¸è§çš„ä¹è§‚é”æœºåˆ¶</p><blockquote><p>atomic.CompareAndSwapInt32()</p><p>atomic.CompareAndSwapInt64()</p><p>atomic.CompareAndSwapUint32()</p><p>atomic.CompareAndSwapUint64()</p><p>atomic.CompareAndSwapPointer()</p></blockquote><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;sync/atomic&quot;
)

func main() &#123;
    var i int64 = 123
    ok := atomic.CompareAndSwapInt64(&amp;i, 123, 321)
    fmt.Println(&quot;bool : &quot;, ok)
    fmt.Println(&quot;values : &quot;, i)
&#125;
/*
bool :  true
values :  321
*/
</code></pre><h4 id="äº¤æ¢"><a href="#äº¤æ¢" class="headerlink" title="äº¤æ¢"></a>äº¤æ¢</h4><blockquote><p>atomic.SwapInt32()</p><p>atomic.SwapInt54()</p><p>atomic.SwapUint32()</p><p>atomic.SwapUint64()</p><p>atomic.SwapPointer()</p><p>atomic.SwapUintptr()</p></blockquote><p>ç›¸å¯¹äºCASï¼Œæ˜æ˜¾æ­¤ç±»æ“ä½œæ›´ä¸ºæš´åŠ›ç›´æ¥ï¼Œå¹¶ä¸ç®¡å˜é‡çš„æ—§å€¼æ˜¯å¦è¢«æ”¹å˜ï¼Œç›´æ¥èµ‹äºˆæ–°å€¼ç„¶åè¿”å›è¢«æ›¿æ¢çš„å€¼</p><h4 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h4><p>ç¡®ä¿äº†å˜é‡çš„åŸå­æ€§ï¼Œé¿å…å…¶ä»–æ“ä½œè¯»åˆ°äº†ä¿®æ”¹å˜é‡è¿‡ç¨‹ä¸­çš„è„æ•°æ®</p><blockquote><p>atomic.StoreInte32()</p><p>atomic.StoreInte64()</p><p>atomic.StoreUinte32()</p><p>atomic.StoreUinte64()</p><p>atomic.StorePointer()</p><p>atomic.StoreUintptr()</p></blockquote><h1 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h1><ol><li><p>Goæä¾›äº†ä¸€ç§ç§°ä¸ºé€šé“çš„æœºåˆ¶ï¼Œç”¨äºåœ¨gorountineä¹‹é—´å…±äº«æ•°æ®ï¼Œå½“ä½œä¸ºgoroutineæ‰§è¡Œå¹¶å‘æ´»åŠ¨æ—¶ï¼Œéœ€è¦åœ¨goroutineä¹‹é—´å…±äº«èµ„æºæˆ–æ•°æ®ï¼Œé€šé“å……å½“goroutineä¹‹é—´çš„ç®¡é“å¹¶æä¾›ä¸€ç§æœºåˆ¶æ¥ä¿è¯åŒæ­¥äº¤æ¢</p></li><li><p>éœ€è¦åœ¨å£°æ˜é€šé“æ—¶æŒ‡å®šæ•°æ®ç±»å‹ï¼Œå¯ä»¥å…±äº«å†…ç½®ã€å‘½åã€ç»“æ„å’Œå¼•ç”¨ç±»å‹çš„å€¼å’ŒæŒ‡é’ˆï¼Œæ•°æ®åœ¨é€šé“ä¸Šä¼ é€’ ï¼ˆåœ¨ä»»ä½•ç»™å®šæ—¶é—´åªæœ‰ä¸€ä¸ªgoroutineå¯ä»¥è®¿é—®æ•°æ®é¡¹ï¼Œå› æ­¤æŒ‰ç…§è®¾è®¡ä¸ä¼šå‘ç”Ÿæ•°æ®ç«äº‰ï¼‰</p></li><li><p>æ ¹æ®æ•°æ®äº¤æ¢çš„è¡Œä¸ºï¼Œæœ‰ä¸¤ç§ç±»å‹çš„é€šé“ : <code>æ— ç¼“å†²é€šé“</code>å’Œ<code>ç¼“å†²é€šé“</code></p><ol><li>æ— ç¼“å†²é€šé“ç”¨äºæ‰§è¡Œgoroutineä¹‹é—´çš„åŒæ­¥é€šä¿¡ï¼Œæ— ç¼“å†²é€šé“ä¿è¯åœ¨å‘é€å’Œæ¥æ”¶å‘ç”Ÿçš„ç¬é—´æ‰§è¡Œä¸¤ä¸ªgoroutineä¹‹é—´çš„äº¤æ¢</li><li>ç¼“å†²é€šé“ç”¨äºæ‰§è¡Œå¼‚æ­¥é€šä¿¡ï¼Œç¼“å†²é€šé“æ²¡æœ‰è¿™æ ·çš„ä¿è¯</li></ol></li></ol><h2 id="channelåˆ›å»º"><a href="#channelåˆ›å»º" class="headerlink" title="channelåˆ›å»º"></a>channelåˆ›å»º</h2><blockquote><p>ä¸å¸¦ç¼“å†²åŒº</p><p>å†™å…¥æ—¶ï¼Œæ²¡æœ‰å…¶ä»–ä¾‹ç¨‹è¯»ï¼Œä¼šé˜»å¡ï¼Œè¯»å–æ—¶ï¼Œæ²¡æœ‰å…¶ä»–ä¾‹ç¨‹å†™ï¼Œä¼šé˜»å¡</p><p>å¸¦ç¼“å†²åŒº</p><p>å†™å…¥æ—¶ï¼Œç¼“å†²åŒºå·²æ»¡æ—¶ï¼Œæ²¡æœ‰å…¶ä»–ä¾‹ç¨‹è¯»ï¼Œä¼šé˜»å¡ï¼Œè¯»å–æ—¶ï¼Œæ²¡æœ‰æ•°æ®ï¼Œæ²¡æœ‰å…¶ä»–ä¾‹ç¨‹å†™ï¼Œä¼šé˜»å¡</p></blockquote><p>é€šé“ç”± make å‡½æ•°åˆ›å»ºï¼Œè¯¥å‡½æ•°æŒ‡å®š chan å…³é”®å­—å’Œé€šé“å…ƒç´ ç±»å‹</p><h3 id="æ— ç¼“å†²é€šé“"><a href="#æ— ç¼“å†²é€šé“" class="headerlink" title="æ— ç¼“å†²é€šé“"></a>æ— ç¼“å†²é€šé“</h3><p>åœ¨æ— ç¼“å†²é€šé“ä¸­ï¼Œåœ¨æ¥æ”¶åˆ°ä»»ä½•å€¼ä¹‹å‰æ²¡æœ‰èƒ½åŠ›ä¿å­˜å®ƒï¼Œåœ¨è¿™ç§ç±»å‹çš„é€šé“ä¸­ï¼Œå‘é€å’Œæ¥æ”¶goroutineåœ¨ä»»ä½•å‘é€æˆ–æ¥æ”¶æ“ä½œå®Œæˆä¹‹å‰çš„åŒä¸€æ—¶åˆ»éƒ½å‡†å¤‡å°±ä¼‘ï¼Œå¦‚æœä¸¤ä¸ªgoroutineæ²¡æœ‰åœ¨åŒä¸€æ—¶åˆ»å‡†å¤‡å¥½ï¼Œåˆ™é€šé“ä¼šè®©æ‰§è¡Œå…¶å„è‡ªå‘é€æˆ–æ¥æ”¶æ“ä½œçš„goroutineé¦–å…ˆç­‰å¾…ï¼ŒåŒæ­¥æ˜¯é€šé“ä¸Šå‘é€å’Œæ¥æ”¶ä¹‹é—´äº¤äº’çš„åŸºç¡€ï¼Œæ²¡æœ‰å¦ä¸€ä¸ªå°±ä¸å¯èƒ½å‘ç”Ÿ</p><p>åˆ›å»ºä¸€ä¸ªæ— ç¼“å†²é€šé“</p><pre><code class="go">Unbuffered := make(chan int)
</code></pre><h3 id="ç¼“å†²é€šé“"><a href="#ç¼“å†²é€šé“" class="headerlink" title="ç¼“å†²é€šé“"></a>ç¼“å†²é€šé“</h3><p>åœ¨ç¼“å†²é€šé“ä¸­ï¼Œæœ‰èƒ½åŠ›åœ¨æ¥æ”¶åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ä¹‹å‰ä¿å­˜å®ƒä»¬ï¼Œåœ¨è¿™ç§ç±»å‹çš„é€šé“ä¸­ï¼Œä¸å¼ºåˆ¶goroutineåœ¨åŒä¸€æ—¶åˆ»å‡†å¤‡å¥½æ‰§è¡Œå‘é€å’Œæ¥æ”¶ï¼Œå½“å‘é€æˆ–æ¥æ”¶é˜»å¡æ—¶ä¹Ÿæœ‰ä¸åŒçš„æ¡ä»¶ï¼Œåªæœ‰å½“é€šé“ä¸­æ²¡æœ‰è¦æ¥æ”¶çš„å€¼æ—¶ï¼Œæ¥æ”¶æ‰ä¼šé˜»å¡ï¼Œä»…å½“æ²¡æœ‰å¯ç”¨ç¼“å†²åŒºæ¥é˜²æ­¢æ­£åœ¨å‘é€çš„å€¼æ—¶ï¼Œå‘é€æ‰ä¼šé˜»å¡</p><p>åˆ›å»ºä¸€ä¸ªæœ‰ç¼“å­˜é€šé“</p><pre><code class="go">buffered := make(chan int, 10)
</code></pre><p>ä½¿ç”¨å†…ç½®å‡½æ•° <code>make</code> åˆ›å»ºæ— ç¼“å†²é€šé“ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å…³é”®å­— <code>chan</code>ï¼Œ ç„¶åæ˜¯<code>é€šé“å…è®¸äº¤æ¢çš„æ•°æ®ç±»å‹</code>ï¼ˆç¬¬ä¸‰ä¸ª<code>æ•°æ®å¤§å°</code>ï¼‰</p><h3 id="è¯»å†™ç®¡é“"><a href="#è¯»å†™ç®¡é“" class="headerlink" title="è¯»å†™ç®¡é“"></a>è¯»å†™ç®¡é“</h3><p>é€šè¿‡å¦ä¸€ä¸ªç®¡é“å¯¹å…¶è¿›è¡Œèµ‹å€¼</p><pre><code class="go">channel  := make(chan int, 10)
var readonly &lt;-chan int  // åªè¯»
var writeonly chan&lt;- int // åªå†™

readonly = channel
writeonly = channel
</code></pre><pre><code class="go">package main

import &quot;fmt&quot;

func main() &#123;

    channel := make(chan int, 4)

    channel &lt;- 2

    w := func(channel chan&lt;- int, num int) &#123;
        channel &lt;- num
    &#125;

    r := func(channel &lt;-chan int) &#123;
        fmt.Println(&lt;-channel)
    &#125;

    r(channel) // 2
    w(channel, 12)
    r(channel) // 12

&#125;
</code></pre><h2 id="channelè¿ç®—ç¬¦"><a href="#channelè¿ç®—ç¬¦" class="headerlink" title="channelè¿ç®—ç¬¦"></a>channelè¿ç®—ç¬¦</h2><ol><li>å°†å€¼å‘é€åˆ°é€šé“çš„ä»£ç å—è¿ç®—ç¬¦ <code>é€šé“å˜é‡ &lt;- å€¼</code></li></ol><pre><code>goroutine1 := make(chan string, 5) // åˆ›å»ºå­—ç¬¦ä¸²ç¼“å­˜é€šé“
goroutine1 &lt;- &quot;Hello&quot; // é€šè¿‡é€šé“å‘é€å­—ç¬¦ä¸²
</code></pre><ol start="2"><li>ä»é€šé“è·å–æ•°æ®çš„è¿ç®—ç¬¦ <code>æ¥æ”¶è€…å˜é‡ &lt;- é€šé“å˜é‡</code></li></ol><pre><code>data := &lt;- goroutine1 // ä»é€šé“è·å–å­—ç¬¦ä¸²
</code></pre><ol start="3"><li>å…³é—­ç®¡é“</li></ol><pre><code class="go">close(goroutinel)
</code></pre><h2 id="é€šé“çš„å‘é€å’Œæ¥æ”¶ç‰¹æ€§"><a href="#é€šé“çš„å‘é€å’Œæ¥æ”¶ç‰¹æ€§" class="headerlink" title="é€šé“çš„å‘é€å’Œæ¥æ”¶ç‰¹æ€§"></a>é€šé“çš„å‘é€å’Œæ¥æ”¶ç‰¹æ€§</h2><ol><li>å¯¹äºåŒä¸€ä¸ªé€šé“ï¼Œå‘é€æ“ä½œä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œæ¥æ”¶æ“ä½œä¹‹é—´ä¹Ÿæ˜¯äº’æ–¥çš„</li><li>å‘é€æ“ä½œå’Œæ¥æ”¶æ“ä½œä¸­å¯¹å…ƒç´ å€¼çš„å¤„ç†éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„</li><li>å‘é€æ“ä½œåœ¨å®Œå…¨å®Œæˆä¹‹å‰ä¼šè¢«é˜»å¡ï¼Œæ¥æ”¶æ“ä½œä¹Ÿæ˜¯å¦‚æ­¤</li></ol><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;math/rand&quot;
    &quot;time&quot;
)

var values = make(chan int)

func showMsg() &#123;
    rand.Seed(time.Now().UnixNano())
    value := rand.Intn(10)
    fmt.Println(&quot;Send : &quot;, value)
    time.Sleep(time.Millisecond * 2000)
    values &lt;- value

&#125;
func main() &#123;
    go showMsg()
    value := &lt;-values
    fmt.Println(&quot;Receive : &quot;, value)
    defer close(values)
&#125;
</code></pre><pre><code class="go">Send :  9
Receive :  9
</code></pre><p>ç®¡é“å…³é—­åï¼Œè¯»å–ç®¡é“è¿”å›æ•°æ®ï¼Œä¸åœ¨è¿›è¡Œé˜»å¡</p><p>åœ¨è¯»å–ç®¡é“çš„æ—¶å€™ï¼Œåˆ©ç”¨ç¬¬äºŒä¸ªå‚æ•°æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯å› ä¸ºç®¡é“å…³é—­å¯¼è‡´çš„è¿”å›ï¼Œç®¡é“å…³é—­è¿”å›false</p><pre><code class="go">_, ok := &lt;-channel
</code></pre><h2 id="channeléå†"><a href="#channeléå†" class="headerlink" title="channeléå†"></a>channeléå†</h2><h3 id="if-for"><a href="#if-for" class="headerlink" title="if+for"></a>if+for</h3><pre><code class="go">package main

import &quot;fmt&quot;

var c = make(chan int)

func main() &#123;

    go func() &#123;
        for i := 0; i &lt; 10; i++ &#123;
            c &lt;- i
        &#125;
        close(c)
    &#125;()
    for &#123;
        value, ok := &lt;-c
        if ok &#123;
            fmt.Println(value)
        &#125; else &#123;
            break
        &#125;
    &#125;
&#125;
</code></pre><pre><code>0
1
2
3
4
5
6
7
8
9
</code></pre><h3 id="range"><a href="#range" class="headerlink" title="range"></a>range</h3><pre><code class="go">package main

import (
    &quot;fmt&quot;
)

var c = make(chan int)

func main() &#123;

    go func() &#123;
        for i := 0; i &lt; 10; i++ &#123;
            c &lt;- i
        &#125;
        close(c)
    &#125;()
    for value := range c &#123;
        fmt.Println(value)
    &#125;
&#125;
</code></pre><pre><code>0
1
2
3
4
5
6
7
8
9
</code></pre><h1 id="select-switch"><a href="#select-switch" class="headerlink" title="select&amp;switch"></a>select&amp;switch</h1><ol><li>selectæ˜¯Goä¸­çš„ä¸€ä¸ªæ§åˆ¶ç»“æ„ï¼Œç±»ä¼¼Switchè¯­å¥ï¼Œç”¨äºå¤„ç†å¼‚æ­¥IOæ“ä½œï¼Œselectä¼šç›‘å¬caseè¯­å¥ä¸­çš„channelçš„è¯»å†™æ“ä½œï¼Œå½“caseä¸­channelè¯»å†™æ“ä½œä¸ºéé˜»å¡çŠ¶æ€ï¼ˆå³èƒ½è¯»å†™ï¼‰æ—¶ï¼Œå°†ä¼šè§¦å‘ç›¸åº”çš„åŠ¨ä½œ</li></ol><blockquote><p>selectä¸­çš„caseè¯­å¥å¿…é¡»æ˜¯ä¸€ä¸ªchannelæ“ä½œ</p><p>selectä¸­çš„defaultå­å¥æ€»æ˜¯å¯è¿è¡Œçš„</p></blockquote><ol start="2"><li><p>å¦‚æœæœ‰å¤šä¸ªcaseéƒ½å¯ä»¥è¿è¡Œï¼Œselectä¼šéšæœºå…¬å¹³åœ°é€‰å‡ºä¸€ä¸ªæ‰§è¡Œï¼Œå…¶ä»–ä¸ä¼šæ‰§è¡Œ</p></li><li><p>å¦‚æœæ²¡æœ‰å¯è¿è¡Œçš„caseè¯­å¥ï¼Œä¸”æœ‰defaultè¯­å¥ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œdefaultçš„åŠ¨ä½œ</p></li><li><p>å¦‚æœæ²¡æœ‰å¯è¿è¡Œçš„caseè¯­å¥ï¼Œä¸”æ²¡æœ‰defaultè¯­å¥ï¼Œselectå°†é˜»å¡ï¼Œç›´åˆ°æŸä¸ªcaseé€šä¿¡å¯ä»¥è¿è¡Œ</p></li></ol><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;runtime&quot;
    &quot;time&quot;
)

var (
    chanInt    = make(chan int)
    chanString = make(chan string)
)

var num = 0

func main() &#123;

    runtime.GOMAXPROCS(3) // ä½¿ç”¨3æ ¸CPU
    go func() &#123;
        chanInt &lt;- 123
        chanString &lt;- &quot;Hello&quot;
        close(chanInt)
        close(chanString)
    &#125;()
    for &#123;
        select &#123;
        case r := &lt;-chanInt:
            fmt.Printf(&quot;chanInt : %d\n&quot;, r)
        case r := &lt;-chanString:
            fmt.Printf(&quot;chanString : %s\n&quot;, r)
            num++
        default:
            fmt.Println(&quot;defaultâ€¦â€¦â€¦â€¦&quot;)
        &#125;
        time.Sleep(time.Millisecond * 20)
        if num == 5 &#123;
            break
        &#125;
    &#125;

&#125;
</code></pre><pre><code>defaultâ€¦â€¦â€¦â€¦
chanInt : 123
chanString : Hello
chanString : 
chanString : 
chanString : 
chanInt : 0
chanString : 
</code></pre><h1 id="time"><a href="#time" class="headerlink" title="time"></a>time</h1><p><code>time.After()</code> å’Œ <code>time.Tick()</code> è¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šè¿”å›ä¸€ä¸ªåªè¯»ç®¡é“ <code>&lt;-chan Time</code></p><h2 id="time-After"><a href="#time-After" class="headerlink" title="time.After()"></a>time.After()</h2><blockquote><p>é—´éš” n ç§’åç»“æŸ</p></blockquote><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    fmt.Println(time.Now())
    &lt;-time.After(time.Second * 2)
    fmt.Println(time.Now())
&#125;

/*
2022-12-01 13:48:56.1661171 +0800 CST m=+0.002714901
2022-12-01 13:48:58.1781814 +0800 CST m=+2.014779201
*/
</code></pre><p><strong>æ¨¡æ‹Ÿè§„å®šæ—¶é—´å†…åœæ­¢</strong></p><ol><li>ä½¿ç”¨ä¸€ä¸ªä¾‹ç¨‹ç›‘è§†å¦å¤–ä¸€ä¸ª</li></ol><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;math/rand&quot;
    &quot;time&quot;
)

func main() &#123;
    result := make(chan interface&#123;&#125;)
    timeout := make(chan struct&#123;&#125;)

    go func() &#123;
        time.Sleep(time.Second * 5)
        timeout &lt;- struct&#123;&#125;&#123;&#125;
    &#125;()

    go func() &#123;
        r := rand.Intn(10)
        fmt.Println(r)
        time.Sleep(time.Second * time.Duration(r))
        result &lt;- r
    &#125;()

    select &#123;
        case v := &lt;-result :
            fmt.Println(v)
        case v:= &lt;-timeout:
            fmt.Printf(&quot;å·²ç»è¶…æ—¶ %#v\n&quot;, v)
    &#125;
&#125;
</code></pre><ol start="2"><li>ä½¿ç”¨time.After()å®ç°æ­¤åŠŸèƒ½</li></ol><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;math/rand&quot;
    &quot;time&quot;
)

func main() &#123;
    result := make(chan interface&#123;&#125;)

    go func() &#123;
        r := rand.Intn(10)
        fmt.Println(r)
        time.Sleep(time.Second * time.Duration(r))
        result &lt;- r
    &#125;()

    select &#123;
    case v := &lt;-time.After(time.Second * 5):
        fmt.Printf(&quot;å·²ç»è¶…æ—¶ %#v\n&quot;, v)
    case v := &lt;-result:
        fmt.Println(v)
    &#125;
&#125;
</code></pre><h2 id="time-Tick"><a href="#time-Tick" class="headerlink" title="time.Tick()"></a>time.Tick()</h2><blockquote><p>å®šæ—¶ n ç§’æ‰§è¡Œ</p></blockquote><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func timeTicker(interval time.Duration) &lt;-chan time.Time &#123;
    channel := make(chan time.Time)
    go func() &#123;
        for &#123; // å®šæ—¶ interval ç§’åå¾€ç®¡é“å†™å…¥æ•°æ®     
            time.Sleep(interval)
            channel &lt;- time.Now()
        &#125;
    &#125;()
    return channel

&#125;

func main() &#123;
    for t := range timeTicker(time.Second * 1) &#123; // å¾ªç¯è¯»å–è·å–é€šé“ä¸­çš„æ•°æ®
        fmt.Println(t)
    &#125;
&#125;
/*
2023-09-03 21:25:10.4093187 +0800 CST m=+1.007206901
2023-09-03 21:25:11.4185214 +0800 CST m=+2.016409601
2023-09-03 21:25:12.4324947 +0800 CST m=+3.030382901
2023-09-03 21:25:13.4425494 +0800 CST m=+4.040437601
â€¦â€¦â€¦â€¦â€¦â€¦
*/
</code></pre><h2 id="time-Ticker"><a href="#time-Ticker" class="headerlink" title="time.Ticker"></a>time.Ticker</h2><p><code>time.Ticker</code>æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œ<code>time.NewTicker()</code>åˆ›å»ºä¸€ä¸ªTickerï¼Œä¹Ÿæ˜¯æ¯é—´éš” n ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœæƒ³è¦éå†å°±å¿…é¡»å¾—æ‹¿åˆ°å…¶å¯¹åº”çš„ç®¡é“ <code>Ticker.C</code>ï¼Œå¦‚æœæƒ³è¦åœ¨æŸä¸€æ—¶åˆ»å…³é—­ï¼Œå¯ä»¥ä½¿ç”¨<code>Ticker.Stop()</code></p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    conster := 1
    timer := time.NewTicker(time.Second * 1) // æ¯å»¶è¿Ÿ1ç§’æ‰§è¡Œ
    for _ = range timer.C &#123;

        if conster &lt;= 5 &#123;
            fmt.Println(conster)
        &#125; else &#123;
            timer.Stop() // å…³é—­Ticker
            break
        &#125;
        conster++
    &#125;
&#125;
/*
1
2
3
4
5
*/
</code></pre><p>å®ç°ä¸€ä¸ªéšæœºå‘é€æ•°æ®</p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

var values = make(chan int)

func main() &#123;
    timer := time.NewTicker(time.Second)
    go func() &#123;
        for _ = range timer.C &#123;
            select &#123;
            case values &lt;- 1:
            case values &lt;- 2:
            case values &lt;- 3:
            &#125;
        &#125;
    &#125;()

    num := 0
    for v := range values &#123;
        fmt.Println(&quot;v : &quot;, v)
        num += v
        if num &gt;= 12 &#123;
            fmt.Println(num)
            break
        &#125;
    &#125;
&#125;
/*
v :  3
v :  1
v :  2
v :  2
v :  2
v :  2
12
*/
</code></pre><h2 id="time-Timer"><a href="#time-Timer" class="headerlink" title="time.Timer"></a>time.Timer</h2><p>Timeré¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å®šæ—¶å™¨çš„æ„æ€ï¼Œå¯ä»¥å®ç°ä¸€äº›å®šæ—¶æ“ä½œï¼Œå†…éƒ¨ä¹Ÿæ˜¯é€šè¿‡channelæ¥å®ç°çš„</p><ol><li>ç›´æ¥å»¶æ—¶</li></ol><blockquote><p>ä½¿ç”¨time.Sleep()</p></blockquote><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    fmt.Println(time.Now())
    time.Sleep(time.Second * 2)
    fmt.Println(time.Now())
&#125;
</code></pre><pre><code class="go">2022-12-01 13:41:20.9241654 +0800 CST m=+0.002567701
2022-12-01 13:41:22.9509834 +0800 CST m=+2.029385701
</code></pre><p><code>&lt;-time.NewTimer().C</code></p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    fmt.Println(time.Now())
    timer := time.NewTimer(time.Second * 2)
    &lt;-timer.C
    fmt.Println(time.Now())
&#125;
</code></pre><pre><code class="go">2022-12-01 13:45:09.1506624 +0800 CST m=+0.002645601
2022-12-01 13:45:11.1736947 +0800 CST m=+2.025677901
</code></pre><ol start="2"><li>åœæ­¢å®šæ—¶å™¨</li></ol><p>ä¸æ·»åŠ åœæ­¢å®šæ—¶å™¨</p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    timer := time.NewTimer(time.Second * 2)
    go func() &#123;
        &lt;-timer.C
        fmt.Println(&quot;func end...&quot;)
    &#125;()
    time.Sleep(time.Second * 3)
    fmt.Println(&quot;main end...&quot;)
&#125;
</code></pre><pre><code class="go">func end...
main end...
</code></pre><p>æ·»åŠ åœæ­¢å®šæ—¶å™¨</p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    timer := time.NewTimer(time.Second * 2)
    go func() &#123;
        &lt;-timer.C
        fmt.Println(&quot;func end...&quot;)
    &#125;()
    stop := timer.Stop()
    if stop &#123;
        fmt.Println(&quot;timer stop...&quot;)
    &#125;
    time.Sleep(time.Second * 3)
    fmt.Println(&quot;main end...&quot;)

&#125;
</code></pre><pre><code class="go">timer stop...
main end...
</code></pre><p>é‡æ–°è®¾ç½®å®šæ—¶å™¨</p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    fmt.Println(time.Now())
    timer := time.NewTimer(time.Second * 5) // è®¾ç½®å»¶æ—¶ä¸º5ç§’
    timer.Reset(time.Second * 3)            // é‡æ–°è®¾ç½®å»¶æ—¶ä¸º3ç§’
    &lt;-timer.C
    fmt.Println(time.Now())
&#125;
</code></pre><pre><code class="go">2022-12-01 13:57:26.8418402 +0800 CST m=+0.002787201
2022-12-01 13:57:29.863725 +0800 CST m=+3.024672001
</code></pre><h1 id="å¯¹è±¡æ± "><a href="#å¯¹è±¡æ± " class="headerlink" title="å¯¹è±¡æ± "></a>å¯¹è±¡æ± </h1><h2 id="sync-Pool"><a href="#sync-Pool" class="headerlink" title="sync.Pool"></a>sync.Pool</h2><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;strconv&quot;
    &quot;sync&quot;
)

type proxy struct &#123;
    index int
    addr  string
&#125;

func getAddr(url string) []string &#123;
    urls := make([]string, 0, 100)
    str := &quot;192.168.1.&quot;
    for i := 1; i &lt;= 10; i++ &#123;
        urls = append(urls, str+strconv.Itoa(i))
    &#125;
    return urls
&#125;

func main() &#123;
    urls := getAddr(&quot;http://www.baidu.com&quot;)
    i := 0
    pool := sync.Pool&#123;
        New: func() interface&#123;&#125; &#123;
            i++
            fmt.Println(&quot;new : &quot;, i)
            return &amp;proxy&#123;
                i,
                urls[i-1],
            &#125;
        &#125;,
    &#125;
    proxy_test := pool.Get() // è·å–å¯¹è±¡æ± ä¸­çš„å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰ä¼šnewä¸€ä¸ª
    fmt.Println(proxy_test)
    pool.Put(proxy_test) // å°†è·å–çš„å¯¹è±¡è¿”å›åˆ›å»ºçš„å¯¹è±¡æ± 

    proxy_test = pool.Get()
    fmt.Println(proxy_test) // å†æ¬¡è·å–å¯¹è±¡æ—¶ï¼Œä¼šå»å¯¹è±¡æ± æ‰¾ï¼Œé‡Œé¢å­˜åœ¨ä¸€ä¸ªåˆšåˆšæ”¾å›å»çš„å°±ä¸ä¼šå†newä¸€ä¸ª

    proxy_test = pool.Get() // å–å‡ºåå†æ¬¡Get,æ²¡æœ‰æ‰¾åˆ°å°±ä¼šå†æ¬¡new
    fmt.Println(proxy_test)

&#125;
/*
new :  1
&amp;&#123;1 192.168.1.1&#125;
&amp;&#123;1 192.168.1.1&#125;
new :  2        
&amp;&#123;2 192.168.1.2&#125;
*/
</code></pre><h1 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h1><h2 id="ä½¿ç”¨WaitGroupå®ç°ç»Ÿè®¡è¡Œæ•°"><a href="#ä½¿ç”¨WaitGroupå®ç°ç»Ÿè®¡è¡Œæ•°" class="headerlink" title="ä½¿ç”¨WaitGroupå®ç°ç»Ÿè®¡è¡Œæ•°"></a>ä½¿ç”¨WaitGroupå®ç°ç»Ÿè®¡è¡Œæ•°</h2><pre><code class="go">package main

import (
    &quot;bufio&quot;
    &quot;fmt&quot;
    &quot;io/fs&quot;
    &quot;os&quot;
    &quot;path/filepath&quot;
    &quot;strings&quot;
    &quot;sync&quot;
    &quot;sync/atomic&quot;
)

func readLine(path string) int &#123;

    ctx := 0
    f, err := os.Open(path)
    if err != nil &#123;
        fmt.Println(err)
    &#125;
    defer f.Close()

    scanner := bufio.NewScanner(f)
    for scanner.Scan() &#123;
        s := scanner.Text()
        s = strings.TrimSpace(s)
        if s == &quot;&quot; || strings.HasPrefix(s, &quot;//&quot;) &#123; // åˆ¤æ–­è¡Œä¸ä¸ºç©ºï¼Œä¸”ä¸åŒ…å« //æ³¨é‡Š
            continue
        &#125;
        ctx += 1
    &#125;
    return ctx
&#125;

func main() &#123;

    p, _ := filepath.Abs(&quot;.&quot;)
    dir := &quot;.&quot;
    var tools int64 = 0
    fmt.Printf(&quot;%T\n&quot;, tools)
    var wg sync.WaitGroup

    filepath.Walk(dir, func(path string, info fs.FileInfo, err error) error &#123;
        path = filepath.Join(p, path) // æ‹¼æ¥è·¯å¾„

        if filepath.Ext(path) == &quot;.go&quot; &amp;&amp; !info.IsDir() &#123; // åˆ¤æ–­æ˜¯å¦ä¸ºgoæ–‡ä»¶ï¼Œä¸”ä¸æ˜¯ç›®å½•
            wg.Add(1) // æ·»åŠ ä¿¡å·
            go func() &#123;
                atomic.AddInt64(&amp;tools, int64(readLine(path))) // åŸå­æ“ä½œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŠ é”è§£é”æ¥ä¿è¯å‡†ç¡®
                wg.Done() // åˆ é™¤ä¿¡å·
            &#125;()
        &#125;
        return nil
    &#125;)

    wg.Wait()

    fmt.Println(tools)
&#125;
</code></pre><h2 id="ä½¿ç”¨ç®¡é“å®ç°ç»Ÿè®¡è¡Œæ•°"><a href="#ä½¿ç”¨ç®¡é“å®ç°ç»Ÿè®¡è¡Œæ•°" class="headerlink" title="ä½¿ç”¨ç®¡é“å®ç°ç»Ÿè®¡è¡Œæ•°"></a>ä½¿ç”¨ç®¡é“å®ç°ç»Ÿè®¡è¡Œæ•°</h2><pre><code class="go">package main

import (
    &quot;bufio&quot;
    &quot;fmt&quot;
    &quot;io/fs&quot;
    &quot;os&quot;
    &quot;path/filepath&quot;
    &quot;strings&quot;
    &quot;sync&quot;
    &quot;sync/atomic&quot;
)

// æµ‹è¯•æ³¨é‡Š
func readLine(path string) int &#123;

    ctx := 0
    f, err := os.Open(path)
    if err != nil &#123;
        fmt.Println(err)
    &#125;
    defer f.Close()

    scanner := bufio.NewScanner(f)
    for scanner.Scan() &#123;
        s := scanner.Text()
        s = strings.TrimSpace(s)
        if s == &quot;&quot; || strings.HasPrefix(s, &quot;//&quot;) &#123;
            continue
        &#125;
        ctx += 1
    &#125;
    return ctx
&#125;


func main() &#123;

    p, _ := filepath.Abs(&quot;.&quot;)
    dir := &quot;.&quot;
    tools := 0
    var wg sync.WaitGroup

    fmt.Printf(&quot;%T\n&quot;, tools)

    channel := make(chan int, 5)
    exit := make(chan bool)

    filepath.Walk(dir, func(path string, info fs.FileInfo, err error) error &#123;
        path = filepath.Join(p, path)

        if filepath.Ext(path) == &quot;.go&quot; &amp;&amp; !info.IsDir() &#123;
            wg.Add(1)
            go func() &#123;
                c := readLine(path)
                channel &lt;- c // å°†è¿”å›ç»“æœä¼ é€’åˆ°é€šé“ä¸­
                wg.Done()
            &#125;()
        &#125;
        return nil
    &#125;)

    go func() &#123;
        for e := range channel &#123;
            tools += e
        &#125;
        exit &lt;- false // é€šè¿‡å°†æ•°æ®ä¼ å…¥ç®¡é“ï¼Œæ¥è¾¾åˆ°æ— æ³•è®©ä¸»ä¾‹ç¨‹ç»“æŸ
    &#125;()

    wg.Wait()
    close(channel) // åœ¨wg.Wait()ä¹‹åå…³é—­channelé€šé“ï¼Œç¡®ä¿åœ¨filepath.Walkæ‰§è¡Œå®Œæˆåå…³é—­é€šé“

    &lt;-exit // ç¡®ä¿éä¾‹ç¨‹èƒ½å¤Ÿåœ¨ä¸»ä¾‹ç¨‹ç»“æŸä¹‹å‰å®Œæˆï¼Œ&lt;-exitä¼šä¸€ç›´å µå¡ï¼Œç›´åˆ°æ²¡æœ‰æ•°æ®å†™å…¥

    fmt.Println(tools)
&#125;
</code></pre><h2 id="å®ç°å®šæ—¶å™¨"><a href="#å®ç°å®šæ—¶å™¨" class="headerlink" title="å®ç°å®šæ—¶å™¨"></a>å®ç°å®šæ—¶å™¨</h2><blockquote><p>å®šæ—¶ 10 ç§’åç»“æŸ</p></blockquote><ul><li>time.After()</li></ul><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func timeAfter(interval time.Duration) &lt;-chan time.Time &#123;
    channel := make(chan time.Time)

    go func() &#123;
        for &#123;
            time.Sleep(interval)
            channel &lt;- time.Now()

        &#125;
    &#125;()
    return channel
&#125;

func main() &#123;
    endTime := time.Now().Add(time.Second * 10)
    for tAfter := range timeAfter(time.Second * 2) &#123;
        fmt.Println(tAfter)
        if tAfter.After(endTime) &#123;
            break // è·³å‡ºå¾ªç¯åï¼Œä¸»ä¾‹ç¨‹å®Œæˆæ‰§è¡Œï¼Œå·¥ä½œä¾‹ç¨‹ç»“æŸ
        &#125;
    &#125;
&#125;
</code></pre><ul><li>close(channel) ä»…é™å†™é€šé“ï¼Œè¯»é€šé“æ— æ„ä¹‰</li></ul><pre><code class="go">func main() &#123;
    endTime := time.Now().Add(time.Second * 10)
    for tAfter := range timeTicker(time.Second * 2) &#123;
        fmt.Println(tAfter)
        if tAfter.After(endTime) &#123;
            close(tAfter) // ä»…é™å†™é€šé“ï¼Œè¯»é€šé“æ— æ„ä¹‰
        &#125;
    &#125;
&#125;
</code></pre><ul><li>time.Ticker.Stop()</li></ul><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;time&quot;
)

func main() &#123;
    endTime := time.Now().Add(time.Second * 10)
    ticker := time.NewTicker(time.Second * 2)

    defer ticker.Stop()
    for now := range ticker.C &#123;
        fmt.Println(now)
        if now.After(endTime) &#123;
            break
        &#125;
    &#125;
&#125;
</code></pre><h2 id="å¯¹è±¡æ± -1"><a href="#å¯¹è±¡æ± -1" class="headerlink" title="å¯¹è±¡æ± "></a>å¯¹è±¡æ± </h2><blockquote><p>å®šä¹‰ä¸€ä¸ªworkeræ± ï¼Œç”±æ± è¿›è¡Œæ‰§è¡Œï¼Œå½“ä»»åŠ¡æ‰§è¡Œå®Œæˆåå¯ä»¥è·å¾—ä»»åŠ¡ç»“æœï¼Œå†workerä¸­å¯ä»¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶å‘æ•°é‡å¯ä»¥æŒ‡å®š</p></blockquote><p><code>worker.go</code></p><pre><code class="go">package pool

import (
    &quot;log&quot;
    &quot;math&quot;
    &quot;sync&quot;
)

type Task func() interface&#123;&#125;

// å®šä¹‰workeræ± 

type Pool struct &#123;
    worker  int              // å®šä¹‰å¹¶å‘æ•°é‡
    tasks   *Queue           // ä»»åŠ¡é˜Ÿåˆ—
    events  chan struct&#123;&#125;    // ä»»åŠ¡é€šçŸ¥ç®¡é“
    Results chan interface&#123;&#125; // æ•°æ®ç®¡é“
    wg      sync.WaitGroup   // ç­‰å¾…ç»„
&#125;

// åˆ›å»ºworkeræ± 

func NewPool(worker int) *Pool &#123;
    return &amp;Pool&#123;
        worker:  worker,
        tasks:   NewQueue(-1),
        events:  make(chan struct&#123;&#125;, math.MaxInt32),
        Results: make(chan interface&#123;&#125;, worker*3),
    &#125;
&#125;

func (p *Pool) AddTask(task Task) &#123;
    p.tasks.Add(task)      // å‘ä»»åŠ¡æ± æ·»åŠ ä»»åŠ¡
    p.events &lt;- struct&#123;&#125;&#123;&#125; // é€šçŸ¥æ‰§è¡Œè¿›ç¨‹
&#125;

func (p *Pool) Start() &#123;
    for i := 0; i &lt; p.worker; i++ &#123;
        p.wg.Add(1)
        go func(i int) &#123; // å¼€å§‹æ‰§è¡Œå¹¶å‘

            for range p.events &#123; // ç”±äºeventsæ˜¯ä¸€ä¸ªç©ºç»“æ„ä½“ï¼Œæ‰€ä»¥æ— éœ€ä¼ å…¥å‚æ•°æ¥æ”¶ï¼Œåªéœ€è¦éå†ï¼ˆå¿½ç•¥ä»ç®¡é“ä¸­è¯»å–çš„æ•°æ®ï¼‰
                task, err := p.tasks.Take()
                if err != nil &#123;
                    continue
                &#125;
                log.Printf(&quot;ç¬¬ %d ä¸ªä¾‹ç¨‹æ‰§è¡Œ : &quot;, i)

                if e, ok := task.(Task); ok &#123; // é€šè¿‡æ–­è¨€å°†ç©ºæ¥å£ç±»å‹è½¬ä¸ºTaskç±»å‹

                    p.Results &lt;- e() // æ‰§è¡Œçš„ç»“æœæ”¾å…¥Resultsç®¡é“
                &#125;
            &#125;
            p.wg.Done()
        &#125;(i)
    &#125;
&#125;
func (p *Pool) Wait() &#123;
    close(p.events)
    p.wg.Wait()
    close(p.Results)
&#125;
</code></pre><p><code>queue.go</code></p><pre><code class="go">package pool

import (
    &quot;fmt&quot;
    &quot;sync&quot;
)

const (
    defaultCap = 1024
)

// å®šä¹‰é˜Ÿåˆ—
type Queue struct &#123;
    elements []interface&#123;&#125; //é˜Ÿåˆ—ä¸­çš„å…ƒç´ 
    locker   sync.Mutex    //å®šä¹‰å¹¶å‘å®‰å…¨é”
    limit    int           // å®šä¹‰é˜Ÿåˆ—ä¸­å…ƒç´ ä¸Šé™
&#125;

func NewQueue(limit int) *Queue &#123; // åˆ›å»ºé˜Ÿåˆ—
    return &amp;Queue&#123;
        elements: make([]interface&#123;&#125;, 0, defaultCap),
        limit:    limit,
    &#125;
&#125;

func (q *Queue) Add(e interface&#123;&#125;) error &#123; // é˜Ÿåˆ—æ·»åŠ å…ƒç´ 
    if q.limit != -1 &amp;&amp; len(q.elements) &gt; q.limit &#123;
        return fmt.Errorf(&quot;è¶…å‡ºèŒƒå›´&quot;)
    &#125;
    q.locker.Lock()
    defer q.locker.Unlock()
    q.elements = append(q.elements, e)
    return nil
&#125;

func (q *Queue) Take() (interface&#123;&#125;, error) &#123; // å–å‡ºé˜Ÿåˆ—å…ƒç´ 
    if len(q.elements) &lt;= 0 &#123;
        return nil, fmt.Errorf(&quot;å†…å®¹ä¸ºç©º&quot;)
    &#125;
    e := q.elements[0]
    q.elements = q.elements[1:]
    return e, nil
&#125;

func (q *Queue) Len() int &#123; // æŸ¥çœ‹é˜Ÿåˆ—å…ƒç´ é•¿åº¦
    return len(q.elements)
&#125;
</code></pre><p><code>main.go</code></p><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;liangc.com/demo/demo9/pool&quot;
    &quot;sync&quot;
)

func main() &#123;

    var wg sync.WaitGroup

    pool := pool.NewPool(2)
    createTask := func(i int) func() interface&#123;&#125; &#123;
        return func() interface&#123;&#125; &#123;
            return i
        &#125;
    &#125;
    for i := 0; i &lt; 10; i++ &#123;
        pool.AddTask(createTask(i))
    &#125;
    pool.Start()
    wg.Add(1)
    go func() &#123;
        for result := range pool.Results &#123;
            fmt.Println(result)
        &#125;
        wg.Done()
    &#125;()

    pool.Wait()
    wg.Wait()
&#125;
</code></pre><h2 id="å¤šçº¿ç¨‹å®ç°ç»Ÿè®¡è¡Œæ•°"><a href="#å¤šçº¿ç¨‹å®ç°ç»Ÿè®¡è¡Œæ•°" class="headerlink" title="å¤šçº¿ç¨‹å®ç°ç»Ÿè®¡è¡Œæ•°"></a>å¤šçº¿ç¨‹å®ç°ç»Ÿè®¡è¡Œæ•°</h2><pre><code class="go">package pool

import (
    &quot;bufio&quot;
    &quot;fmt&quot;
    &quot;os&quot;
    &quot;strings&quot;
    &quot;sync&quot;
)

const (
    defaultCap = 1024
)

type Queue struct &#123;
    elements []int
    locker   sync.Mutex
&#125;

func NewQueue() *Queue &#123;
    return &amp;Queue&#123;
        elements: make([]int, 0, defaultCap),
    &#125;
&#125;
func (q *Queue) ReadLine(path string) error &#123;
    i := 0
    file, err := os.Open(path)
    if err != nil &#123;
        return fmt.Errorf(&quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;)
    &#125;
    scanner := bufio.NewScanner(file)
    for scanner.Scan() &#123;
        s := scanner.Text()
        s = strings.TrimSpace(s)
        if s == &quot;&quot; || strings.HasPrefix(s, &quot;//&quot;) &#123;
            continue
        &#125;
        i++
    &#125;
    q.locker.Lock()
    defer q.locker.Unlock()
    q.elements = append(q.elements, i)
    return nil
&#125;

func (q *Queue) Take() (int, error) &#123;
    if len(q.elements) &lt;= 0 &#123;
        return 0, fmt.Errorf(&quot;å†…å®¹ä¸ºç©º&quot;)
    &#125;
    e := q.elements[0]
    q.elements = q.elements[1:]
    return e, nil
&#125;
</code></pre><pre><code class="go">package pool

import (
    &quot;math&quot;
    &quot;sync&quot;
)

type Pool struct &#123;
    worker  int
    tasks   *Queue
    Results chan int
    events  chan struct&#123;&#125;
    wg      sync.WaitGroup
&#125;

func NewPool(i int) *Pool &#123;
    return &amp;Pool&#123;
        worker:  i,
        tasks:   NewQueue(),
        Results: make(chan int, i*3),
        events:  make(chan struct&#123;&#125;, math.MaxInt32),
    &#125;
&#125;
func (p *Pool) AddTask(path string) &#123;
    err := p.tasks.ReadLine(path)
    if err != nil &#123;
        return
    &#125; // å‘ä»»åŠ¡æ± æ·»åŠ ä»»åŠ¡
    p.events &lt;- struct&#123;&#125;&#123;&#125; // é€šçŸ¥æ‰§è¡Œè¿›ç¨‹
&#125;

func (p *Pool) Start() &#123;
    for i := 0; i &lt; p.worker; i++ &#123;
        p.wg.Add(1)
        go func(i int) &#123; // å¼€å§‹æ‰§è¡Œå¹¶å‘
            for range p.events &#123;
                task, err := p.tasks.Take()
                if err != nil &#123;
                    continue
                &#125;
                p.Results &lt;- task
            &#125;
            p.wg.Done()
        &#125;(i)
    &#125;
&#125;
func (p *Pool) Wait() &#123;
    close(p.events)
    p.wg.Wait()
    close(p.Results)
&#125;
</code></pre><pre><code class="go">package main

import (
    &quot;fmt&quot;
    &quot;io/fs&quot;
    &quot;liangc.com/object/object4/pool&quot;
    &quot;path/filepath&quot;
    &quot;sync&quot;
)

func main() &#123;
    pool := pool.NewPool(5)

    var (
        maxLine int
        wg      sync.WaitGroup
    )
    file, err := filepath.Abs(&quot;H:\\Object\\GoObject&quot;)
    if err != nil &#123;
        fmt.Println(err)
    &#125;
    filepath.Walk(file, func(path string, info fs.FileInfo, err error) error &#123;
        if filepath.Ext(path) == &quot;.go&quot; &amp;&amp; !info.IsDir() &#123;
            pool.AddTask(path)
        &#125;
        return nil
    &#125;)

    pool.Start()
    wg.Add(1)
    go func() &#123;
        for result := range pool.Results &#123;
            maxLine += result
        &#125;
        wg.Done()
    &#125;()

    pool.Wait()

    wg.Wait()

    fmt.Println(maxLine)

&#125;
</code></pre><div class="tags"><a href="/tags/Golang/" rel="tag"><i class="ic i-tag"></i> Golang</a> <a href="/tags/Golang%E5%85%A5%E9%97%A8%E8%BF%9B%E9%98%B6/" rel="tag"><i class="ic i-tag"></i> Golangå…¥é—¨è¿›é˜¶</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-12-26 19:44:05" itemprop="dateModified" datetime="2023-12-26T19:44:05+08:00">2023-12-26</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="ä½™æ˜Ÿé…’ å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="ä½™æ˜Ÿé…’ æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div><div><img data-src="/images/paypal.png" alt="ä½™æ˜Ÿé…’ è´å®"><p>è´å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ä½™æ˜Ÿé…’ <i class="ic i-at"><em>@</em></i>ä½™æ˜Ÿé…’</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="http://example.com/Program/golang/%E8%BF%9B%E9%98%B6/%E5%B9%B6%E5%8F%91/" title="å¹¶å‘">http://example.com/Program/golang/è¿›é˜¶/å¹¶å‘/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/Program/golang/%E8%BF%9B%E9%98%B6/web%E5%BC%80%E5%8F%91/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giph47e9vtj20zk0m8x6l.jpg" title="webå¼€å‘"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> è¿›é˜¶</span><h3>webå¼€å‘</h3></a></div><div class="item right"><a href="/APT/web%E6%B8%97%E9%80%8F/CSRF/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipew8gmvyj20zk0m87wh.jpg" title="CSRF"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> webæ¸—é€</span><h3>CSRF</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">å¹¶å‘åŸºç¡€</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F%E3%80%81%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C"><span class="toc-number">1.1.</span> <span class="toc-text">é¡ºåºã€å¹¶å‘ä¸å¹¶è¡Œ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BE%8B%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">ä¾‹ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">2.1.</span> <span class="toc-text">ä¾‹ç¨‹çš„åˆ›å»º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AD%E5%8C%85%E9%99%B7%E9%98%B1"><span class="toc-number">2.1.1.</span> <span class="toc-text">é—­åŒ…é™·é˜±</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%89%E5%BE%85%E4%BE%8B%E7%A8%8B"><span class="toc-number">2.2.</span> <span class="toc-text">ç­‰å¾…ä¾‹ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WaitGroup"><span class="toc-number">2.2.1.</span> <span class="toc-text">WaitGroup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E9%81%93%E5%AE%9E%E7%8E%B0%E7%AD%89%E5%BE%85"><span class="toc-number">2.2.2.</span> <span class="toc-text">ç®¡é“å®ç°ç­‰å¾…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-number">2.3.</span> <span class="toc-text">ä¾‹ç¨‹é—´é€šä¿¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mutext%E4%BA%92%E6%96%A5%E9%94%81%E5%AE%9E%E7%8E%B0%E5%90%8C%E6%AD%A5"><span class="toc-number">2.3.1.</span> <span class="toc-text">Mutextäº’æ–¥é”å®ç°åŒæ­¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.2.</span> <span class="toc-text">åŸå­æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%87%8F%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">å¢å‡æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%BD%E5%85%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">è½½å…¥æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E5%B9%B6%E4%BA%A4%E6%8D%A2-cas"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">æ¯”è¾ƒå¹¶äº¤æ¢ cas</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2"><span class="toc-number">2.3.2.4.</span> <span class="toc-text">äº¤æ¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8"><span class="toc-number">2.3.2.5.</span> <span class="toc-text">å­˜å‚¨</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#channel"><span class="toc-number">3.</span> <span class="toc-text">channel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#channel%E5%88%9B%E5%BB%BA"><span class="toc-number">3.1.</span> <span class="toc-text">channelåˆ›å»º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E7%BC%93%E5%86%B2%E9%80%9A%E9%81%93"><span class="toc-number">3.1.1.</span> <span class="toc-text">æ— ç¼“å†²é€šé“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E9%80%9A%E9%81%93"><span class="toc-number">3.1.2.</span> <span class="toc-text">ç¼“å†²é€šé“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E7%AE%A1%E9%81%93"><span class="toc-number">3.1.3.</span> <span class="toc-text">è¯»å†™ç®¡é“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#channel%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">3.2.</span> <span class="toc-text">channelè¿ç®—ç¬¦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E9%81%93%E7%9A%84%E5%8F%91%E9%80%81%E5%92%8C%E6%8E%A5%E6%94%B6%E7%89%B9%E6%80%A7"><span class="toc-number">3.3.</span> <span class="toc-text">é€šé“çš„å‘é€å’Œæ¥æ”¶ç‰¹æ€§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#channel%E9%81%8D%E5%8E%86"><span class="toc-number">3.4.</span> <span class="toc-text">channeléå†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#if-for"><span class="toc-number">3.4.1.</span> <span class="toc-text">if+for</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#range"><span class="toc-number">3.4.2.</span> <span class="toc-text">range</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#select-switch"><span class="toc-number">4.</span> <span class="toc-text">select&amp;switch</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#time"><span class="toc-number">5.</span> <span class="toc-text">time</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#time-After"><span class="toc-number">5.1.</span> <span class="toc-text">time.After()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#time-Tick"><span class="toc-number">5.2.</span> <span class="toc-text">time.Tick()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#time-Ticker"><span class="toc-number">5.3.</span> <span class="toc-text">time.Ticker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#time-Timer"><span class="toc-number">5.4.</span> <span class="toc-text">time.Timer</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%B1%A0"><span class="toc-number">6.</span> <span class="toc-text">å¯¹è±¡æ± </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sync-Pool"><span class="toc-number">6.1.</span> <span class="toc-text">sync.Pool</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">7.</span> <span class="toc-text">æ¡ˆä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8WaitGroup%E5%AE%9E%E7%8E%B0%E7%BB%9F%E8%AE%A1%E8%A1%8C%E6%95%B0"><span class="toc-number">7.1.</span> <span class="toc-text">ä½¿ç”¨WaitGroupå®ç°ç»Ÿè®¡è¡Œæ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AE%A1%E9%81%93%E5%AE%9E%E7%8E%B0%E7%BB%9F%E8%AE%A1%E8%A1%8C%E6%95%B0"><span class="toc-number">7.2.</span> <span class="toc-text">ä½¿ç”¨ç®¡é“å®ç°ç»Ÿè®¡è¡Œæ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="toc-number">7.3.</span> <span class="toc-text">å®ç°å®šæ—¶å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%B1%A0-1"><span class="toc-number">7.4.</span> <span class="toc-text">å¯¹è±¡æ± </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AE%9E%E7%8E%B0%E7%BB%9F%E8%AE%A1%E8%A1%8C%E6%95%B0"><span class="toc-number">7.5.</span> <span class="toc-text">å¤šçº¿ç¨‹å®ç°ç»Ÿè®¡è¡Œæ•°</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/Program/golang/%E8%BF%9B%E9%98%B6/%E6%8E%A5%E5%8F%A3%E4%B8%8E%E5%8F%8D%E5%B0%84/" rel="bookmark" title="æ¥å£ä¸åå°„">æ¥å£ä¸åå°„</a></li><li><a href="/Program/golang/%E8%BF%9B%E9%98%B6/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" rel="bookmark" title="æ–‡ä»¶æ“ä½œ">æ–‡ä»¶æ“ä½œ</a></li><li><a href="/Program/golang/%E8%BF%9B%E9%98%B6/IO%E6%B5%81/" rel="bookmark" title="IOæµ">IOæµ</a></li><li><a href="/Program/golang/%E8%BF%9B%E9%98%B6/web%E5%BC%80%E5%8F%91/" rel="bookmark" title="webå¼€å‘">webå¼€å‘</a></li><li class="active"><a href="/Program/golang/%E8%BF%9B%E9%98%B6/%E5%B9%B6%E5%8F%91/" rel="bookmark" title="å¹¶å‘">å¹¶å‘</a></li><li><a href="/Program/golang/%E8%BF%9B%E9%98%B6/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" rel="bookmark" title="ç½‘ç»œç¼–ç¨‹">ç½‘ç»œç¼–ç¨‹</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="ä½™æ˜Ÿé…’" data-src="/images/avatar.jpg"><p class="name" itemprop="name">ä½™æ˜Ÿé…’</p><div class="description" itemprop="description">æ¬¢è¿å‚è§‚æˆ‘çš„ç¬”è®°ç©ºé—´ ~ è¿™é‡Œä¸»è¦ä¼šè®°å½•ä¸€äº›å®‰å…¨ç›¸å…³çš„å­¦ä¹ ç¬”è®° ğŸŒ¸</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">253</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">43</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">36</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/Program/golang/%E8%BF%9B%E9%98%B6/web%E5%BC%80%E5%8F%91/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/APT/web%E6%B8%97%E9%80%8F/CSRF/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Program/" title="åˆ†ç±»äº ç¼–ç¨‹">ç¼–ç¨‹</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/" title="åˆ†ç±»äº Golang">Golang</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/%E5%9F%BA%E7%A1%80/" title="åˆ†ç±»äº åŸºç¡€">åŸºç¡€</a></div><span><a href="/Program/golang/%E5%85%A5%E9%97%A8/%E5%85%B3%E9%94%AE%E5%AD%97%E5%92%8C%E6%A0%87%E8%AF%86%E7%AC%A6/" title="å…³é”®å­—å’Œæ ‡è¯†ç¬¦">å…³é”®å­—å’Œæ ‡è¯†ç¬¦</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/" title="åˆ†ç±»äº åä¸ºé˜²ç«å¢™">åä¸ºé˜²ç«å¢™</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/" title="åˆ†ç±»äº å®éªŒ">å®éªŒ</a></div><span><a href="/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/%E9%98%B2%E7%81%AB%E5%A2%99%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87/" title="é˜²ç«å¢™åŒæœºçƒ­å¤‡">é˜²ç«å¢™åŒæœºçƒ­å¤‡</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PDCERF/" title="åˆ†ç±»äº åº”æ€¥å“åº”">åº”æ€¥å“åº”</a> <i class="ic i-angle-right"></i> <a href="/categories/PDCERF/Windows%E5%BA%94%E6%80%A5%E7%AC%94%E8%AE%B0/" title="åˆ†ç±»äº Windowsåº”æ€¥ç¬”è®°">Windowsåº”æ€¥ç¬”è®°</a></div><span><a href="/PDCERF/Windows%E5%AE%9E%E6%88%98%E7%AF%87/%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92/" title="å‹’ç´¢ç—…æ¯’">å‹’ç´¢ç—…æ¯’</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Program/" title="åˆ†ç±»äº ç¼–ç¨‹">ç¼–ç¨‹</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/" title="åˆ†ç±»äº Golang">Golang</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/%E9%A1%B9%E7%9B%AE/" title="åˆ†ç±»äº é¡¹ç›®">é¡¹ç›®</a></div><span><a href="/Program/golang/%E9%A1%B9%E7%9B%AE/TCP%E6%89%AB%E6%8F%8F%E5%99%A8%E5%92%8C%E4%BB%A3%E7%90%86/" title="TCPæ‰«æå™¨å’Œä»£ç†">TCPæ‰«æå™¨å’Œä»£ç†</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" title="åˆ†ç±»äº ç½‘ç»œåŸºç¡€">ç½‘ç»œåŸºç¡€</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C/" title="åˆ†ç±»äº å®éªŒ">å®éªŒ</a></div><span><a href="/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C/%E4%BA%A4%E6%8D%A2%E6%9C%BA%E6%8E%A5%E5%8F%A3%E5%AE%9E%E9%AA%8C/" title="äº¤æ¢æœºæ¥å£å®éªŒ">äº¤æ¢æœºæ¥å£å®éªŒ</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/" title="åˆ†ç±»äº åä¸ºé˜²ç«å¢™">åä¸ºé˜²ç«å¢™</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/" title="åˆ†ç±»äº å®éªŒ">å®éªŒ</a></div><span><a href="/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/%E9%98%B2%E7%81%AB%E5%A2%99%E7%AD%96%E7%95%A5%E9%85%8D%E7%BD%AE/" title="é˜²ç«å¢™ç­–ç•¥é…ç½®">é˜²ç«å¢™ç­–ç•¥é…ç½®</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/APT/" title="åˆ†ç±»äº æ¸—é€æµ‹è¯•">æ¸—é€æµ‹è¯•</a> <i class="ic i-angle-right"></i> <a href="/categories/APT/%E5%B7%A5%E5%85%B7/" title="åˆ†ç±»äº å·¥å…·">å·¥å…·</a></div><span><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/john/" title="john">john</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PDCERF/" title="åˆ†ç±»äº åº”æ€¥å“åº”">åº”æ€¥å“åº”</a> <i class="ic i-angle-right"></i> <a href="/categories/PDCERF/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/" title="åˆ†ç±»äº æ—¥å¿—åˆ†æ">æ—¥å¿—åˆ†æ</a></div><span><a href="/PDCERF/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/" title="Webæ—¥å¿—åˆ†æ">Webæ—¥å¿—åˆ†æ</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Program/" title="åˆ†ç±»äº ç¼–ç¨‹">ç¼–ç¨‹</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/" title="åˆ†ç±»äº Golang">Golang</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/%E5%B8%B8%E7%94%A8%E5%BA%93/" title="åˆ†ç±»äº å¸¸ç”¨åº“">å¸¸ç”¨åº“</a></div><span><a href="/Program/golang/%E5%B8%B8%E7%94%A8%E5%BA%93/time/" title="time">time</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/APT/" title="åˆ†ç±»äº æ¸—é€æµ‹è¯•">æ¸—é€æµ‹è¯•</a> <i class="ic i-angle-right"></i> <a href="/categories/APT/%E9%9D%B6%E5%9C%BA/" title="åˆ†ç±»äº é¶åœº">é¶åœº</a></div><span><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Empire-Lupin-One-1/" title="Empire Lupin One-1">Empire Lupin One-1</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">ä½™æ˜Ÿé…’ @ ä½™æ˜Ÿé…’</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"Program/golang/è¿›é˜¶/å¹¶å‘/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->